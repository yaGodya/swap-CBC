!function(e,t,c){function r(e){}function o(e,t,o){for(this.callback=o||r,this.errors=[],this.fields={},this.form=this._formByNameOrNode(e)||{},this.messages={},this.handlers={},e=0,o=t.length;e<o;e++){var i=t[e];if((i.name||i.names)&&i.rules)if(i.names)for(var n=0;n<i.names.length;n++)this._addField(i,i.names[n]);else this._addField(i,i.name)}var a,s=this.form.onsubmit;this.form.onsubmit=(a=this,function(e){try{return a._validateForm(e)&&(s===c||s())}catch(e){}})}function i(e,t){var o;if(!(0<e.length)||"radio"!==e[0].type&&"checkbox"!==e[0].type)return e[t];for(o=0;o<e.length;o++)if(e[o].checked)return e[o][t]}var p={required:"The %s field is required.",valid_phoneno:"The %s field is not valid.",matches:"The %s field does not match the %s field.",default:"The %s field is still set to default, please change.",valid_email:"The %s field must contain a valid email address.",valid_emails:"The %s field must contain all valid email addresses.",min_length:"The %s field must be at least %s characters in length.",max_length:"The %s field must not exceed %s characters in length.",exact_length:"The %s field must be exactly %s characters in length.",greater_than:"The %s field must contain a number greater than %s.",less_than:"The %s field must contain a number less than %s.",alpha:"The %s field must only contain alphabetical characters.",alpha_numeric:"The %s field must only contain alpha-numeric characters.",alpha_dash:"The %s field must only contain alpha-numeric characters, underscores, and dashes.",alpha_numeric_dash_combo:"The %s field must contain only combination of alpha-numeric characters and dashes.",alphanumeric_combo:"The %s field must contain only combination of alpha-numeric characters.",numeric:"The %s field must contain only numbers.",integer:"The %s field must contain an integer.",decimal:"The %s field must contain a decimal number.",is_natural:"The %s field must contain only positive numbers.",is_natural_no_zero:"The %s field must contain a number greater than zero.",valid_ip:"The %s field must contain a valid IP.",valid_base64:"The %s field must contain a base64 string.",valid_credit_card:"The %s field must contain a valid credit card number.",is_file_type:"The %s field must contain only %s files.",valid_url:"The %s field must contain a valid URL.",valid_ca_zip:"The %s field must contain a valid Postal Code."},n=/^[ABCEGHJKLMNPRSTVXY]{1}\d{1}[A-Z]{1} *\d{1}[A-Z]{1}\d{1}$/,a=/^(\\+)|(9[976]\d|8[987530]\d|6[987]\d|5[90]\d|42\d|3[875]\d|2[98654321]\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)\d{1,14}$/,d=/^(.+?)\[(.+)\]$/,s=/^[0-9]+$/,l=/^(?=.*[a-zA-Z])(?=.*\d)(?=.*[-])[A-Za-z\d][A-Za-z\d-]+$/i,u=/^(?=.*[0-9])(?=.*[a-zA-Z])([a-zA-Z0-9]+)$/,m=/^\-?[0-9]+$/,g=/^\-?[0-9]*\.?[0-9]+$/,f=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,h=/^[a-z]+$/i,y=/^[a-z0-9]+$/i,C=/^[a-z0-9_\-]+$/i,v=/^[0-9]+$/i,w=/^[1-9][0-9]*$/i,T=/^((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){3}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})$/i,S=/[^a-zA-Z0-9\/\+=]/i,k=/^[\d\-\s]+$/,L=/^((http|https):\/\/(\w+:{0,1}\w*@)?(\S+)|)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/;o.prototype.setMessage=function(e,t){return this.messages[e]=t,this},o.prototype.registerCallback=function(e,t){return e&&"string"==typeof e&&t&&"function"==typeof t&&(this.handlers[e]=t),this},o.prototype._formByNameOrNode=function(e){return"object"==typeof e?e:t.forms[e]},o.prototype._addField=function(e,t){this.fields[t]={name:t,display:e.display||t,rules:e.rules,id:null,type:null,value:null,checked:null}},o.prototype._validateForm=function(e){for(var t in this.errors=[],this.fields){var o;this.fields.hasOwnProperty(t)&&(t=this.fields[t]||{},o=this.form[t.name])&&o!==c&&(t.id=i(o,"id"),t.type=(0<o.length?o[0]:o).type,t.value=i(o,"value"),t.checked=i(o,"checked"),this._validateField(t))}return"function"==typeof this.callback&&this.callback(this.errors,e),0<this.errors.length&&(e&&e.preventDefault?e.preventDefault():event&&(event.returnValue=!1)),!0},o.prototype._validateField=function(e){for(var t=e.rules.split("|"),o=e.rules.indexOf("required"),i=!e.value||""===e.value||e.value===c,n=0,a=t.length;n<a;n++){var s=t[n],r=null,l=!1,u=d.exec(s);if((-1!==o||-1!==s.indexOf("!callback_")||!i)&&(u&&(s=u[1],r=u[2]),"!"===s.charAt(0)&&(s=s.substring(1,s.length)),"function"==typeof this._hooks[s]?this._hooks[s].apply(this,[e,r])||(l=!0):"callback_"===s.substring(0,9)&&(s=s.substring(9,s.length),"function"==typeof this.handlers[s])&&!1===this.handlers[s].apply(this,[e.value,r])&&(l=!0),l)){t=this.messages[s+"#"+e.name]||this.messages[s]||p[s],o="An error has occurred with the "+e.display+" field.",t&&(o=t.replace("%s",e.display),r)&&((cu=0<=r.indexOf("###")&&r.split("###"))?cu[1]&&(o=cu[1]):o=o.replace("%s",this.fields[r]?this.fields[r].display:r)),this.errors.push({Id:e.id,Name:e.name,Message:o,Rule:s});break}}},o.prototype._hooks={required:function(e){var t=e.value.trim();return"checkbox"===e.type||"radio"===e.type?!0===e.checked:null!==t&&""!==t},default:function(e,t){return e.value!==t},matches:function(e,t){return!!(t=this.form[t])&&e.value===t.value},valid_ca_zip:function(e){return n.test(e.value)},valid_email:function(e){return f.test(e.value)},valid_emails:function(e){e=e.value.split(",");for(var t=0;t<e.length;t++)if(!f.test(e[t]))return!1;return!0},min_length:function(e,t){return!!s.test(t)&&e.value.length>=parseInt(t,10)},max_length:function(e,t){return!!s.test(t)&&e.value.length<=parseInt(t,10)},exact_length:function(e,t){return!!s.test(t)&&e.value.length===parseInt(t,10)},greater_than:function(e,t){return!!g.test(e.value)&&parseFloat(e.value)>parseFloat(t)},less_than:function(e,t){return!!g.test(e.value)&&parseFloat(e.value)<parseFloat(t)},alpha:function(e){return h.test(e.value)},alpha_numeric:function(e){return y.test(e.value)},alpha_dash:function(e){return C.test(e.value)},alpha_numeric_dash_combo:function(e){return l.test(e.value)},alphanumeric_combo:function(e){return u.test(e.value)},numeric:function(e){return s.test(e.value)},integer:function(e){return m.test(e.value)},decimal:function(e){return g.test(e.value)},is_natural:function(e){return v.test(e.value)},is_natural_no_zero:function(e){return w.test(e.value)},valid_ip:function(e){return T.test(e.value)},valid_phoneno:function(e){return a.test(e.value)},valid_base64:function(e){return S.test(e.value)},valid_url:function(e){return L.test(e.value)},valid_credit_card:function(e){if(!k.test(e.value))return!1;for(var t=0,o=0,i=!1,n=(e=e.value.replace(/\D/g,"")).length-1;0<=n;n--)o=e.charAt(n),o=parseInt(o,10),i&&9<(o*=2)&&(o-=9),t+=o,i=!i;return 0==t%10},is_file_type:function(e,t){if("file"!==e.type)return!0;for(var o=e.value.substr(e.value.lastIndexOf(".")+1),i=t.split(","),n=!1,a=0,s=i.length;a<s;a++)o==i[a]&&(n=!0);return n}},e.FormValidator=o}(window,document);var LRNameSpace={},LoginRadiusDefaults=(function(h){h.LRAnonymous=function(){var t=new h.Storage,e="__aasauid",o="__aasurl",i="_aasuid",n=!1,u=document.title||null,c=window.navigator.userLanguage||window.navigator.language,p=document.characterSet||document.charset,a=new Date,s=new Date(a.getYear()+1,a.getMonth()+1,a.getDay()+1),d="",m="",g="",f="";function r(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function l(e,t,o,i){var n,a,s,r="",i=(i&&(n=i,r=Object.keys(n).map(function(e){if(n[e])return encodeURIComponent(e)+"="+encodeURIComponent(n[e])}).join("&")),f=o||f,m=t||m,0),l=(window.screen&&(a=window.screen.height,s=window.screen.width,i=window.screen.colorDepth),new Image);l.style.position="fixed",l.onload=function(){document.body&&document.body.appendChild(l)},l.src="//gaugeapp.lrcontent.com/image.gif?aassite="+g+"&aasauid="+d+"&aasuid="+m+"&aasurl="+window.location.href+"&aassh="+a+"&aassw="+s+"&aasscd="+i+"&aashn="+window.location.hostname+"&aaspt="+u+"&aasln="+c+"&aasenc="+p+"&aasev="+e+"&aasidprov="+f+"&"+r}return t.getBrowserStorage(i)?m=t.getBrowserStorage(i):t.getBrowserStorage("lr-user-uid")&&(n=!0,a=t.getBrowserStorage("lr-user-uid"),m=a,t.setBrowserStorage(i,a,s)),t.getBrowserStorage(e)?d=t.getBrowserStorage(e):(d=r()+r()+"-"+r()+"-"+r()+"-"+r()+"-"+r()+r()+r(),t.setBrowserStorage(e,d,s)),{track:function(e,t,o,i){this.setUid(t),l(e,t,o,i)},setUid:function(e){m=e,t.setBrowserStorage(i,m,s)},init:function(e){m=(e=e||{}).uid||m,g=e.appName||e.appname,m&&t.setBrowserStorage(i,m,s),t.getBrowserStorage(o)&&t.getBrowserStorage(o)===md5(window.location.href)&&!n||(l("pageView"),t.setBrowserStorage(o,md5(window.location.href),s))}}}}(LRNameSpace),LRNameSpace.cookies={intToString:function(e){return e.toString()},stringToInt:function(e){return parseInt(e,10)||0},isSameSiteNoneCompatible:function(e){return!this.isSameSiteNoneIncompatible(e.toString())},isSameSiteNoneIncompatible:function(e){return this.hasWebKitSameSiteBug(e)||this.dropsUnrecognizedSameSiteCookies(e)},hasWebKitSameSiteBug:function(e){return this.isIosVersion(12,e)||this.isMacosxVersion(10,14,e)&&(this.isSafari(e)||this.isMacEmbeddedBrowser(e))},dropsUnrecognizedSameSiteCookies:function(e){return this.isChromiumBased(e)&&this.isChromiumVersionAtLeast(51,e)&&!this.isChromiumVersionAtLeast(67,e)||this.isUcBrowser(e)&&!this.isUcBrowserVersionAtLeast(12,13,2,e)},regexContains:function(e,t){return null!==e.match(t)},extractRegexMatch:function(e,t,o){return null!==(e=e.match(t))&&void 0!==e[o]?e[o]:null},isIosVersion:function(e,t){return this.extractRegexMatch(t,/\(iP.+; CPU .*OS (\d+)[_\d]*.*\) AppleWebKit\//,1)===this.intToString(e)},isMacosxVersion:function(e,t,o){var i=/\(Macintosh;.*Mac OS X (\d+)_(\d+)[_\d]*.*\) AppleWebKit\//;return this.extractRegexMatch(o,i,1)===this.intToString(e)&&this.extractRegexMatch(o,i,2)===this.intToString(t)},isSafari:function(e){return null!==e.match(/Version\/.* Safari\//)&&!this.isChromiumBased(e)},isMacEmbeddedBrowser:function(e){return this.regexContains(e,/^Mozilla\/[.\d]+ \(Macintosh;.*Mac OS X [_\d]+\) AppleWebKit\/[.\d]+ \(KHTML, like Gecko\)$/)},isChromiumBased:function(e){return this.regexContains(e,/Chrom(e|ium)/)},isChromiumVersionAtLeast:function(e,t){return e<=this.stringToInt(this.extractRegexMatch(t,/Chrom[^ /]+\/(\d+)[.\d]* /,1))},isUcBrowser:function(e){return this.regexContains(e,/UCBrowser\//)},isUcBrowserVersionAtLeast:function(e,t,o,i){var n=/UCBrowser\/(\d+)\.(\d+)\.(\d+)[.\d]* /,a=this.stringToInt(this.extractRegexMatch(i,n,1)),s=this.stringToInt(this.extractRegexMatch(i,n,2)),i=this.stringToInt(this.extractRegexMatch(i,n,3));return a!==e?e<a:s!==t?t<s:o<=i},getItem:function(e){return e&&decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},setItem:function(e,t,o,i,n,a){if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var s,r,l="";if(o)switch(o.constructor){case Number:l="; expires="+((s=o)===1/0?"Fri, 31 Dec 9999 23:59:59 GMT":((r=new Date).setTime(r.getTime()+1e3*s),r.toGMTString()))+o===1/0?"":"; max-age="+o;break;case String:l="; expires="+o;break;case Date:l="; expires="+o.toUTCString()}"lr-user--token"===e&&(a=!0);var u=navigator.userAgent;return"lr-session-token"===e&&this.isSameSiteNoneCompatible(u)?document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+l+(n?"; domain="+n:"")+(i?"; path="+i:"")+";secure;SameSite=None":document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+l+(n?"; domain="+n:"")+(i?"; path="+i:"")+(a?"; secure":""),!0},removeItem:function(e,t,o){return!!this.hasItem(e)&&(document.cookie=encodeURIComponent(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(o?"; domain="+o:"")+(t?"; path="+t:""),!0)},hasItem:function(e){return!!e&&new RegExp("(?:^|;\\s*)"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},keys:function(){for(var e=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),t=e.length,o=0;o<t;o++)e[o]=decodeURIComponent(e[o]);return e}},LRNameSpace.ProgressiveProfiling=function(m,g,f,h){return{fetchSchema:function(e){m.util.ajaxCall("get",h.configApiDomain+"progressiveProfilingSchema?apikey="+m.options.apiKey+"&appName="+m.options.appName,"",e)},execStep:function(s,e){var r,l,u,c,p,d;m.progressiveProfilingSchema&&(r=e.onSuccess||function(){},l=e.onError||function(){},u=e.container||"",c=e.classPrefix||"",p=e.templateName||"",d=m.storage.getBrowserStorage(h.storedTokenName))&&m.util.ajaxCall("get",h.apiDomain+"/auth/account?apiKey="+m.options.apiKey+"&access_token="+d,"",function(e){var t,o,i,n,a=m.util.findInSchema(m.progressiveProfilingSchema.ProfilingSteps,"Step",s);a?((t={}).Profile=e,t.access_token=d,"email"===(o=e.Provider.toLowerCase())||"raas"===o||m.options.progressiveProfilingTraditional?(m.options.progressiveProfilingTraditional&&"email"!==o&&"raas"!==o&&(e=m.LoggedinSocialProvderProfile),n=a.Schema,i=g.mapSchema(n,e,null,!0),t.Profile=e,0<i.length?g.createForm(i,"progressiveProfiling",u,function(e){f.updateData(t,u,e,r,l,c,i,"progressiveProfiling")},function(e){l(e)},c):g.loginHandleToken(t,"",r,l)):(n=a.Scopes,(e=m.util.findInSchema(n,"Provider",o,!0))?(a="https://"+(m.options.customDomain||m.options.appName+"."+h.hubDomain)+"/RequestHandlor.aspx?apikey="+m.options.apiKey+"&provider="+o+"&scope="+e.Scopes,(n=[]).push({Name:o,Endpoint:a}),g.renderCustomInterface(u,"",p,"","",n),g.socialLogin(u,r,l)):g.loginHandleToken(t,"",r,l))):m.log("Step Schema not found.")})}}},function(n){n.Storage=function(i,o){return{isLocalStorageNameSupported:function(e){try{if(!window[e])return!1;var t=window[e];try{return t.setItem("test","1"),t.removeItem("test"),!0}catch(e){return!1}}catch(e){return!1}},setBrowserStorage:function(e,t){var o=!0;this.isLocalStorageNameSupported("localStorage")&&(localStorage.setItem(e,t),o=!1),this.isLocalStorageNameSupported("sessionStorage")&&(sessionStorage.setItem(e,t),o=!1),o&&i&&i.options&&n.cookies.setItem(e,t,"",i.options.appPath)},getBrowserStorage:function(e){if(o&&e===o.storedTokenName){var t=this.getBrowserStorage("lr-session-token");if(t)return t=t.replace(/"/g,""),this.setBrowserStorage(o.storedTokenName,t),t}return(this.isLocalStorageNameSupported("localStorage")&&null!==localStorage.getItem(e)&&void 0!==localStorage.getItem(e)&&""!==localStorage.getItem(e)?localStorage:this.isLocalStorageNameSupported("sessionStorage")&&null!==sessionStorage.getItem(e)&&void 0!==sessionStorage.getItem(e)&&""!==sessionStorage.getItem(e)?sessionStorage:n.cookies).getItem(e)},removeBrowserStorage:function(e){var t=!0;this.isLocalStorageNameSupported("localStorage")&&(localStorage.removeItem(e),t=!1),this.isLocalStorageNameSupported("sessionStorage")&&(sessionStorage.removeItem(e),t=!1),t&&i&&i.options&&n.cookies.removeItem(e,i.options.appPath)}}}}(LRNameSpace),LRNameSpace.Utilities=function(){var e=navigator.userAgent.toLowerCase(),l={version:(e.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[])[1],safari:/webkit/.test(e),opera:/opera/.test(e),msie:(/msie/.test(e)||/trident/.test(e))&&!/opera/.test(e),mozilla:/mozilla/.test(e)&&!/(compatible|webkit)/.test(e)},u=!1,c=!1,p=[];function d(){if(!c&&(c=!0,p)){for(var e=0;e<p.length;e++)p[e].call(window,[]);p=[]}}return{browser:l,getHashParam:function(e){var t=window.location.hash.match(new RegExp(e+"=([^&]*)"));return window.location.hash&&null!=t?t[1]:this.getQueryParameterByName(e)},keysToLowerCase:function(e){for(var t,o=Object.keys(e),i=o.length,n={};i--;)n[(t=o[i]).toLowerCase()]=e[t],"object"==typeof n[t.toLowerCase()]&&null!=n[t.toLowerCase()]&&(n[t.toLowerCase()]=this.keysToLowerCase(n[t.toLowerCase()]));return n},elementsByClass:function(e,t){if(""!==e){t=t||document.body;for(var o=[],i=new RegExp("(^| )"+e+"( |$)"),n=t.getElementsByTagName("*"),a=0,s=n.length;a<s;a++)i.test(n[a].className)&&o.push(n[a]);return o}},isValidUrl:function(e){return!!/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!10(?:\.\d{1,3}){3})(?!127(?:\.\d{1,3}){3})(?!169\.254(?:\.\d{1,3}){2})(?!192\.168(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/i.test(e)},hasClass:function(e,t){return e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},addclass:function(e,t){return!this.hasClass(e,t)&&(e.className+=" "+t,!0)},isSubstring:function(e,t){for(var o in t)if(-1!==t[o].indexOf(e))return o;return!1},isJWT:function(e){try{var[t]=e.split(".");return"object"==typeof JSON.parse(atob(t))}catch(e){return!1}},isJsonString:function(e){try{return JSON.parse(e)}catch(e){return!1}},addEvent:function(e,t,o){var i=[];t instanceof Array?i=t:i.push(t);for(var n=0;n<i.length;n++)i[n]["on"+e]=o},getQueryParameterByName:function(e,t){return t="&"+(t||location.search),e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),null==(e=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t))?null:decodeURIComponent(e[1].replace(/\+/g," "))},getParameterByName:function(e){return e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),null===(e=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search))?"":decodeURIComponent(e[1].replace(/\+/g," "))},getQueryStringValue:function(e,t){return e=e||window.location.href,(t=new RegExp("[?&]"+t+"=([^&#]*)","i").exec(e))?t[1]:null},extend:function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])},ready:function(e,t){if(!u){var o,i;if(u=!0,document.addEventListener&&!l.opera&&document.addEventListener("DOMContentLoaded",d,!1),l.msie&&window===top&&function(){if(!c){try{document.documentElement.doScroll("left")}catch(e){return}d()}}(),l.opera&&document.addEventListener("DOMContentLoaded",function(){if(!c){for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].disabled)return;d()}},!1),l.safari&&!c&&("loaded"===document.readyState||"complete"===document.readyState)){if(void 0===r){for(var n=document.getElementsByTagName("link"),a=0;a<n.length;a++)"stylesheet"===n[a].getAttribute("rel")&&r++;var s=document.getElementsByTagName("style"),r=void 0===r?s.length:r+s.length}document.styleSheets.length===r&&d()}o=d,i=window.onload,"function"!=typeof window.onload?window.onload=o:window.onload=function(){i&&i(),o()}}c?e.call(window,[]):p.push(function(){return e.call(window,[])})},parseQueryString:function(e){var t={};if((e||""!==e)&&"string"==typeof e)for(var o=e.split("&"),i=0;i<o.length;i++){var n=o[i].split("=");t[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}return t},encodedString:function(e){return-1===e.indexOf("%2B")?e.replace(/\+/g,"%2B"):e},mergeOptions:function(e,t){var o,i,n={};for(o in e)n[o]=e[o];for(i in t)n[i]=t[i];return n},mergeObjects:function(e,t,o){var i,n,a=[];for(n in e){for(var s in t)i=o?t[s]===e[n]:t[s].name===e[n].name;if(i)break;a.push(e[n])}return a.concat(t)},isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},randomString:function(e){for(var t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".split(""),o=(e=e||Math.floor(Math.random()*t.length),""),i=0;i<e;i++)o+=t[Math.floor(Math.random()*t.length)];return o},findInSchema:function(e,t,o,i){for(var n=0;n<e.length;n++)if((i?e[n]&&e[n][t].toLowerCase():e[n]&&e[n][t])===o)return e[n];return null},jsonToQueryString:function(t){return Object.keys(t).map(function(e){return t[e]?encodeURIComponent(e)+"="+encodeURIComponent(t[e]):""}).join("&")},insertBefore:function(e,t){t.parentNode.insertBefore(e,t)},isEmpty:function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},keyslowerToUpperCamelCase:function(e){for(var t,o=Object.keys(e),i=o.length,n={};i--;)n[(t=o[i]).charAt(0).toUpperCase()+t.substr(1)]=e[t];return n},findElementByRegex:function(e,t,o){for(var i=o?document.querySelectorAll(o):document.querySelectorAll("*"),n=[],a=0;a<i.length;a++)t.test(i[a][e])&&n.push(i[a]);return n},isObject:function(e){return e instanceof Object&&e.constructor===Object},parseString:function(e){return void 0!==e&&JSON.parse(e)},containsObject:function(e,t,o){if(o){for(var i=0;i<e.length;i++)if(e[i][o]===t[o])return!0;return!1}},base64UrlDecode:function(e){var t=(e=e.replace(/-/g,"+").replace(/_/g,"/")).length%4;if(t){if(1==t)throw new Error("InvalidLengthError: Input base64url string is the wrong length to determine padding");e+=new Array(5-t).join("=")}return new Uint8Array(atob(e).split("").map(function(e){return e.charCodeAt(0)}))},base64UrlEncode:function(e){return btoa(String.fromCharCode.apply(null,new Uint8Array(e))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}}},"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var t=this.length>>>0,o=Number(arguments[1])||0;for((o=o<0?Math.ceil(o):Math.floor(o))<0&&(o+=t);o<t;o++)if(o in this&&this[o]===e)return o;return-1}),Array.prototype.filter||(Array.prototype.filter=function(e){if(null==this)throw new TypeError;var t=Object(this),o=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var i,n=[],a=arguments[1],s=0;s<o;s++)s in t&&(i=t[s],e.call(a,i,s,t))&&n.push(i);return n}),function(n){function i(){for(var e=n.location.hash?n.location.hash.substr(1).split("&"):[],t={},o=0;o<e.length;o++){var i=e[o].split("=");t[i[0]]=decodeURIComponent(i[1])}return t}function a(e){var t,o=[];for(t in e)o.push(t+"="+encodeURIComponent(e[t]));n.location.hash=o.join("&")}n.hash={get:function(e){var t=i();return e?t[e]:t},add:function(e){var t,o=i();for(t in e)o[t]=e[t];a(o)},remove:function(e){e="string"==typeof e?[e]:e;for(var t=i(),o=0;o<e.length;o++)delete t[e[o]];a(t)},clear:function(){a({})}}}(window),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(e),i=1;i<arguments.length;i++){var n=arguments[i];if(null!=n)for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(o[a]=n[a])}return o},writable:!0,configurable:!0}),{idPrefix:"loginradius-",classPrefix:"loginradius-",apiDomain:"https://api.loginradius.com/identity/v2",hubDomain:"hub.loginradius.com",cloudApiDomain:"https://cloud-api.loginradius.com/",configApiDomain:"https://config.lrcontent.com/ciam/",socialApiDomain:"https://api.loginradius.com/api/v2/",externalLibrary:"https://auth.lrcontent.com/v2/external-libs/",isRegFormSchemaLock:!1,isSecurityFormSchemaLock:!1,innerHTML:!1,autoFilledFieldforPasswordLesLogin:!1,socialRegFormId:"",lrResponseCounter:0,LRPhoneNo:"",lrCounterJwtResponse:"",lrCounterTokenResponse:"",storedTokenName:"LRTokenKey",storedTwoFAToken:"lr2fatok",storedSessionTokenData:"lrSessionTokenObj",storedOTPAuth:"lrotpauthver",storedGAAuth:"lrgaauthver",storedEmailOTPAuth:"lremailotpauthver",storedPushNotificationAuth:"lrpushnotificationauthver",storedSQAuth:"lrsqauthver",storedUidName:"lr-user-uid",storedDuoAuth:"lrduoauthver",storedPasskeyAuth:"lrpasskeyauthver",tokenCookie:"lr-user--token",fedSessCookie:"lr_fed_sess",storedOrganization:"lrorganization",isSSOInitFired:!1,pingCount:1,messages:{tokenValid:{Message:"Access token is not valid",Description:"LoginRadius Access Token is invalid, please verify the authentication response",ErrorCode:905},twofaTokenValid:{Message:"Token is not valid",Description:"Your session is not valid."},twofaGAAuthDisable:{Message:"Already Disabled",Description:"Authenticator App is already disabled."},twofaOTPAuthDisable:{Message:"Already Disabled",Description:"SMS authenticator is already disabled."},twofaAuthRequired:{Message:"Cannot Disable",Description:"Two factor authentication is required, So atleast one authenticator should be required."},invalidEmail:{Message:"Invalid Email",Description:"The email entered is not a valid email."},invalidPhone:{Message:"Invalid Phone",Description:"The mobile number entered is not valid."},disabledAccountLinking:"Account Linking disabled in your account",noSecurityQuestions:"There are no security questions for this application",invalidSott:"Something went wrong, please try again.",notValidMessage:"Error Message element not valid",passwordStrengthMessage:"Password strength meter configuration is not valid.",otpSent:"Verification Code Sent Successfully",vTokenError:{Message:"Verification token not found in query string."},notFound:"Data not found.",emailNotVerified:{Message:"The email is not verified, please verify the link in your email",Description:"The email is not verified, please verify the link in your email",ErrorCode:970},phoneNotVerified:{Message:"Phone number is not verified",Description:"The provided phone number is not verified, please use a verified phone number for login.",ErrorCode:1066},blockedUser:{Message:"User is blocked",Description:"This user is blocked by site admin",ErrorCode:991},unverifiedUser:{Message:"This Uid have only traditional unverified account",Description:"This Uid have only traditional unverified account",ErrorCode:1028},captchaError:{Message:"The Captcha is required.",Description:"The Captcha is required."}},buttonNames:{login:"Login",socialregistration:"Login",loginrequiredfieldsupdate:"Login",registration:"Register",passkeyregister:"Register with Passkey",registerwithpwd:"Continue with Password",passkeylogin:"Sign In with Passkey",verifyemail:"Verify",resetpassword:"Reset Password",resetpin:"Reset PIN",sociallogin:"Login",otp:"Verify",twofaotp:"Verify",twofaemailotp:"Verify",showqrcode:"Verify",updatephone:"Update",changephone:"Update",forgotpassword:"Send",forgotpin:"Send",forgotpasskey:"Send",securityquestions:"Get",changepassword:"Submit",changepin:"Change PIN",resendemailverification:"Send",addemail:"Send",removeemail:"Send",changeusername:"Submit",profileeditor:"Update Profile",otplogin:"Verification Code",passwordlessloginbuttonlabel:"Email me a link to Sign In",passwordlessloginotpbuttonlabel:"Send Verification Code to Sign In",createtwofactorauthentication:"2-Step Verification",createPasskey:"Add a Passkey",sendotp:"Send Verification Code",resendotp:"Resend via SMS",resendemailotp:"Resend via Email",resendvoiceotp:"Resend via Voice call",changenumber:"Change Number",backupcode:"Login",backupcodebutton:"Try another way to Sign In",backupcodebackbutton:"Back",generatebackupcodebutton:"Generate Backup Codes",disablegoogleauthenticator:"Disable Authenticator App",disablesqauthenticator:"Disable Security Questions",disableemailotpauthenticator:"Disable Email Verification",disableduoauthenticator:"Disable Duo Security",disableotpauthenticator:"Disable SMS Verification",updatesecurityquestion:"Update Security Question",resetpwdbysecq:"Reset Password By SecurityQ",resetpinbysecq:"Reset PIN By SecurityQ",smartlogin:"Smart Login",validatecode:"Validate",onetouchlogin:"Login",progressiveprofiling:"Progressive Profiling",privacypolicyupdate:"Accept",updatephone2fa:"Update",pinsetup:"Set Pin",pinlogin:"Login",pinreauthentication:"Verify",pinloginbackbtn:"Back",consentlogin:"Submit Consent",customeventconsent:"Submit Consent",consenteditor:"Submit Consent",resetBackupCode:"Reset Backup Code",emailotp:"Verify Identity via Email ",duomfa:"Verify Identity via Duo Security",googleauthenticator:"Verify Identity via Authenticator App",securityquestionsauthenticator:"Verify Identity via Security Questions",mfasecurityquestion:"Submit",otpauthenticator:"Verify Identity via SMS",mfaselectemails:"Submit",organization:"Continue",lookupdomain:"Login",sendverificationemail:"Send Verification Email",pushnotification:"Verify Identity via Push Notification",disablepushnotification:"Disable Push Notification",passkeyauthenticator:"Verify Identity via Passkey",disablepasskeyauthenticator:"Disable Passkey Verification"},templates:{consentMainTemplate:"loginradius_consent_custom_tmpl",consentGroupTemplate:"loginradius_consent_group_tmpl",consentOptionTemplate:"loginradius_consent_option_tmpl"},options:{passwordlessLoginEmailTemplate:"",callbackUrl:window.location,callbackInsideSameWindow:"",callbackType:"",scope:"",loginUrl:"",deleteUrl:"",emailTemplate:"",verificationUrl:"",verificationEmailTemplate:"",resetPasswordEmailTemplate:"",resetPassKeyEmailTemplate:"",resetPINEmailTemplate:"",resetPasswordConfirmationEmailTemplate:"",resetPINConfirmationEmailTemplate:"",smartLoginRedirectUrl:"",autoLoginRedirectUrl:"",smartLoginEmailTemplate:"",autoLoginEmailTemplate:"",smsTemplate2FA:"",smsTemplateForgot:"",smsTemplateWelcome:"",smsTemplateOneTouchLoginWelcome:"",smsTemplateOneTouchLogin:"",passwordlessLoginSMSTemplate:"",smsTemplate2FAWelcome:"",smsTemplatePhoneVerification:"",smsTemplateUpdatePhone:"",welcomeEmailTemplate:"",onetouchLoginEmailTemplate:"",deleteUserEmailTemplate:"",onetouchLoginRedirectUrl:"",resetPasswordUrl:"",resetPassKeyUrl:"",resetPINUrl:"",templateName:"",debugMode:!1,tokenType:"lrtoken",integrationName:"",smartLoginPingCount:100,smartLoginPingInterval:5,crossDeviceSSOPingCount:100,crossDeviceSSOPingInterval:5,maskSensitiveInput:!1,enableHeaderSott:!0,accessTokenResponse:!0,rbaOneclickEmailTemplate:"",rbaOTPSmsTemplate:"",rbaCityEmailTemplate:"",rbaCountryEmailTemplate:"",rbaBrowserEmailTemplate:"",rbaIpEmailTemplate:"",rbaDeviceEmailTemplate:"",rbaCitySmsTemplate:"",rbaCountrySmsTemplate:"",rbaBrowserSmsTemplate:"",rbaIpSmsTemplate:"",rbaDeviceSmsTemplate:"",setLRSession:!1,askOptionalFieldsOnProgressiveSteps:!0,disableResendOTPButton:!1,disableResendOTPButtonDelay:5,EmailTemplate2FA:"",authenticatorOptionsOrder:["emailotp","securityquestion","auth","sms","pushnotification","duomfa","passkey"]},regexExpression:{emailRegex:/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,phoneRegex:/^(\\+)|(9[976]\d|8[987530]\d|6[987]\d|5[90]\d|42\d|3[875]\d|2[98654321]\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)\d{8,14}$/},_uuidFormat:/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,loginURLs:["/auth/login","/auth/email","/auth/onetouchlogin","/auth/password"],captchaActions:["login","passwordlesslogin","onetouchlogin","verifyotp","verifyemail","resetpassword","forgotpassword","changepassword","login##otp","otp","twofaotp","twofaemailotp"]});function LoginRadiusUtility(T,e){var l=LoginRadiusDefaults.buttonNames,S=new LRNameSpace.Utilities,u=this,i=(u.elementById=function(e,t){var o=document.getElementById(e);if(o)return o;t||T.log("Unable to find id: "+e)},u.getThisObjectName=function(){for(var e in T.global)if("frameElement"!==e&&"webkitStorageInfo"!==e&&"webkitIndexedDB"!==e&&"localStorage"!==e&&"sessionStorage"!==e&&T.global[e]===T)return e},u.serialize=function(e,t){if(e&&"FORM"===e.nodeName){for(var o,i=[],n=e.elements.length-1;0<=n;--n)if(""!==e.elements[n].name&&(t||""!==e.elements[n].value.trim()))switch("emailid"!==e.elements[n].name||T.options.usernameLogin||T.options.duplicateEmailWithUniqueUsername||(e.elements[n].value=e.elements[n].value.toLowerCase()),e.elements[n].nodeName){case"INPUT":switch(e.elements[n].type){case"text":case"hidden":case"button":case"reset":case"submit":case"email":var a=e.elements[n].name;"emailid"===a&&(a="email"),(!e.elements[n].disabled||"emailid"===e.elements[n].name&&T.util.getQueryParameterByName("email"))&&i.push(a+"="+encodeURIComponent(e.elements[n].value.trim()));break;case"password":i.push(e.elements[n].name+"="+encodeURIComponent(e.elements[n].value));break;case"checkbox":i.push(e.elements[n].name+"="+encodeURIComponent(e.elements[n].checked));break;case"radio":e.elements[n].checked&&i.push(e.elements[n].name+"="+encodeURIComponent(e.elements[n].value))}break;case"TEXTAREA":i.push(e.elements[n].name+"="+encodeURIComponent(e.elements[n].value.trim()));break;case"SELECT":switch(e.elements[n].type){case"select-one":i.push(e.elements[n].name+"="+encodeURIComponent(e.elements[n].value.trim()));break;case"select-multiple":for(o=e.elements[n].options.length-1;0<=o;--o)e.elements[n].options[o].selected&&i.push(e.elements[n].name+"="+encodeURIComponent(e.elements[n].options[o].value.trim()))}break;case"BUTTON":switch(e.elements[n].type){case"reset":case"submit":case"button":i.push(e.elements[n].name+"="+encodeURIComponent(e.elements[n].value.trim()))}}return i.join("&")}},u.addJs=function(e,t){var o=(t=t||document).getElementsByTagName("head")[0];return(t=t.createElement("script")).src=e,t.type="text/javascript",o.appendChild(t),t},u.hashTmpl=function e(t,o){return"function"==typeof(t=/\W/.test(t)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+t.replace(/[\r\t\n]/g," ").split("<#").join("\t").replace(/((^|#>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)#>/g,"',$1,'").split("\t").join("');").split("#>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):i[t]=i[t]||(u.elementById(t)?e(u.elementById(t).innerHTML):""))?o?t(o):t:""},{});u.tmpl=function e(t,o){return"function"==typeof(t=/\W/.test(t)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+t.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):i[t]=i[t]||(u.elementById(t)?e(u.elementById(t).innerHTML):""))?o?t(o):t:""},u.jsonpCall=function(e,t,o,i){T.$hooks.call("startProcess",i),o=o||"Loginradius"+Math.floor(1e18*Math.random()+1),window[o]=function(e){t(e),T.$hooks.call("endProcess",i)},e=-1!==e.indexOf("?")?e+"&callback="+o:e+"?callback="+o,u.addJs(e)},u.getButtonAttribute=function(e,t,o,i,n){var a,t=t||LoginRadiusDefaults.idPrefix,o=(T.buttonElements[e]?a=(a=T.buttonElements[e]).cloneNode(!0):((a=document.createElement("input")).type="button",a.value=T.buttonsName[e]||l[e]||i),o&&(a.onclick=o),i&&(a.datavalue=i.trim()),a.id=t+"button-"+e,"");return(o=document.createElement("div")).setAttribute("class",t+"-form-element-content content-"+t+e),o.appendChild(a),o},u.ajaxCall=function(e,o,n,a,s,r){var l=this,u=s;s&&-1!==s.indexOf("##")&&(u=s.split("##")[1]),"pingForPushNotification"!==s&&T.$hooks.call("startProcess",s,n);try{var i,c=new XMLHttpRequest;if(T.options.projectionFields&&s){var p=Object.keys(T.options.projectionFields),d=["verifyOTP","updateData"],m=!1,g=s;if(T.LRCheckRegistration?(m=-1!==d.indexOf(s),g="registration"):T.LRCheckLogin&&(m=-1!==d.indexOf(s),g="login"),-1!==p.indexOf(s)||m){var f=T.options.projectionFields[g];if(f&&0<f.length){for(var h=["ErrorCode","Profile/Uid","Profile/IsDeleted","access_token","Profile/EmailVerified","Profile/PhoneIdVerified","Profile/PhoneId","PhoneId","PhoneIdVerified","EmailVerified","Uid","IsDeleted"],y=((T.options.twoFactorAuthentication||T.options.optionalTwoFactorAuthentication)&&h.push("SecondFactorAuthentication/SecondFactorAuthenticationToken","SecondFactorAuthentication/IsOTPAuthenticatorVerified","SecondFactorAuthentication/IsAuthenticatorVerified","SecondFactorAuthentication/OTPPhoneNo","SecondFactorAuthentication/ManualEntryCode"),f=S.mergeObjects(f,h,!0),"&fields="),C=0;C<f.length;C++)C===f.length-1?y+=f[C]:y=y+f[C]+",";o+=y}}}T.options.clientId&&T.options.clientId.length&&((i=new URL(o)).searchParams.delete("apikey"),i.searchParams.delete("apiKey"),i.searchParams.append("client_id",T.options.clientId),o=i.toString());var v,w=T.util.getQueryParameterByName("access_token",o);T.options.passAccessTokenInHeader&&w&&-1<o.indexOf(LoginRadiusDefaults.apiDomain)||-1!==["setCustomToken","setToken"].indexOf(s)?(o=o.replace("&access_token="+w,"").replace("?access_token="+w+"&","?").replace("?access_token="+w,"?"),c.open(e,o,!0),c.setRequestHeader("Authorization","Bearer "+w)):c.open(e,o,!0),(-1<o.indexOf("/ssologin/")||"setToken"===s)&&(c.withCredentials=!0),-1===o.indexOf("cdn")&&-1===o.indexOf(".json")&&c.setRequestHeader("X-Requested-With","XMLHttpRequest");let t=!1;for(let e=0;e<LoginRadiusDefaults.loginURLs.length;e++)if(-1!==o.indexOf(LoginRadiusDefaults.loginURLs[e])){t=!0;break}t&&void 0!==(v=LRNameSpace.cookies.getItem(LoginRadiusDefaults.fedSessCookie))&&null!=v&&c.setRequestHeader("X-Params",v),n.sottcheck&&(c.setRequestHeader("X-LoginRadius-Sott",T.options.sott),delete n.sottcheck),T.$hooks.call("modifyXhrRequest",s,c,o),n?(n="string"==typeof n||n instanceof String?JSON.stringify(S.parseQueryString(n)):JSON.stringify(n),c.setRequestHeader("Content-Type","application/json"),c.send(n)):c.send(null),c.onreadystatechange=function(){try{var e,t,o,i;4===c.readyState&&((e=c.response)&&(t=JSON.parse(e),-1<Object.keys(t).map(function(e){return e.toLowerCase()}).indexOf("errorcode")?T.$hooks.call("xhrEndWithError",s):T.$hooks.call("xhrEndWithSuccess",s)),"500"==c.status&&((o=JSON.parse(e)).ErrorCode="500",e=JSON.stringify(o),T.$hooks.call("xhrEndWithError",s)),(i=l.isJsonString(e))&&(T.$hooks.call("successCallback",u,i,n),r?a(r,i):a(i)),T.$hooks.call("endProcess",s))}catch(e){T.log(e)}},c.onerror=function(){T.$hooks.call("xhrEndWithError",s)}}catch(e){T.log(e)}},u.openWindow=function(e){var o,t,i,n;if(e=e||u.href,!T.options.isMobile)return(t=document.createElement("a")).href=e,t=S.getQueryParameterByName("provider",t.search),i="",T.options.noCallbackForSocialLogin&&(e+="&nocallback=true&callbackguid="+(i=T.util.randomString(16))),n=t&&"facebook"===t.toLowerCase()?"650":"450",n=T.options.customizeSocialPopup||"menubar=1,resizable=1,width="+n+",height=450,scrollbars=1",window.open(e,"lrpopupchildwindow",n),T.$hooks.call("socialCalls",t,i),!1;n="no",T.options.debugMode&&(n="yes"),(o=window.open(e,"_blank","location="+n)).addEventListener("loadstop",function(e){t="token";var t,e=null===(t=new RegExp("[\\?&]token=([^&#]*)").exec(e.url))?"":decodeURIComponent(t[1].replace(/\+/g," "));null!=e&&""!==e&&(o.close(),html5passToken(e))})},u.addHTMLContent=function(e,t,o,i,n){o=o||!1;var a=u.elementById(e);if(a||i)o||(a.innerHTML=""),i?(i=l[i.toLowerCase()],n=n||LoginRadiusDefaults.idPrefix,n=u.elementById(n+"submit-"+i.toLowerCase().replace(/ /g,"-")),S.insertBefore(t,n)):a.appendChild(t);else{var s=S.elementsByClass(e);if(s&&0<s.length)for(var r=0;r<s.length;r++)o||(s[r].innerHTML=""),s[r].appendChild(t)}},u.addRecaptchaJS=function(t){if(!window.hcaptcha&&T.options.hCaptchaSiteKey){let e="https://js.hcaptcha.com/1/api.js";T.options.invisibleRecaptcha||(e+="?render=explicit",T.options.v2RecaptchaLanguage&&(e+="&hl="+T.options.v2RecaptchaLanguage)),u.addJs(e)}else if(!window.grecaptcha){let e="https://www.google.com/recaptcha/api.js";T.options.v2Recaptcha||t?(e+="?render=explicit",T.options.v2RecaptchaLanguage&&(e+="&hl="+T.options.v2RecaptchaLanguage),u.addJs(e)):T.options.invisibleRecaptcha&&u.addJs(e)}(T.options.tencentCaptcha||T.options.tencentCaptchaAsFallback)&&u.addJs("https://ssl.captcha.qq.com/TCaptcha.js")},u.passkeyautofill=function(o){if(T.options.isPassKeysEnabled&&T.options.isPasskeyAutofill){let t={};T.util.isPasskeyAvailable().then(function(e){e?(e=T.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName))?T.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account?apiKey="+T.options.apiKey+"&access_token="+e,"",function(e){e.ErrorCode&&906===e.ErrorCode&&T.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/login/passkey/autofill/begin?apiKey="+T.options.apiKey,"",function(e){e.ErrorCode||T.util.getPassKeyCredentials(e.LoginBeginCredential,!0).then(e=>{t.assertion=e,o(t)}).catch(function(e){t.error=e,o(t)})})}):T.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/login/passkey/autofill/begin?apiKey="+T.options.apiKey,"",function(e){e.ErrorCode?(t.error=e,o(t)):T.util.getPassKeyCredentials(e.LoginBeginCredential,!0).then(e=>{t.assertion=e,o(t)}).catch(function(e){t.error=e,o(t)})}):T.log("Auto fill not supported")}).catch(function(e){t.error=e,o(t)})}},u.renderV2Recaptcha=function(o,e,i){var n,t,a=u.elementById(o);(T.options.isCaptchaEnabled||T.options.v2Recaptcha||T.options.invisibleRecaptcha||e||T.options.tencentCaptcha||T.options.tencentCaptchaAsFallback)&&(a&&a.innerHTML&&(window.hcaptcha&&T.options.hCaptchaSiteKey?window.hcaptcha.reset(window[o+"lr_recaptcha_widgets_idprefix"]):window.grecaptcha&&grecaptcha.reset(window[o+"lr_recaptcha_widgets_idprefix"])),t=setInterval(function(){try{n||(n=setInterval(function(){try{var e,t;window.grecaptcha&&grecaptcha.render||window.hcaptcha?a&&""===a.innerHTML&&(e={sitekey:T.options.hCaptchaSiteKey||T.options.v2RecaptchaSiteKey||"6LeAiwITAAAAADlqb06JIGepBs8ZRo3OZ7C0W7U3",theme:T.options.captchaTheme||"light",callback:function(e){a.style.display="block",i&&i(e)}},T.options.invisibleRecaptcha&&(e.size="invisible",e.callback="onCaptchaSubmit"),window.hcaptcha&&T.options.hCaptchaSiteKey?window[o+"lr_recaptcha_widgets_idprefix"]=window.hcaptcha.render(o,e):window[o+"lr_recaptcha_widgets_idprefix"]=grecaptcha.render(o,e),clearInterval(n)):(o+="_tencent",(t=document.getElementById(o))&&(t.style.display="block"),"undefined"!=typeof TencentCaptcha&&new TencentCaptcha(document.getElementById(o)),clearInterval(n))}catch(e){clearInterval(n),T.log(e)}},1e3),clearInterval(t))}catch(e){clearInterval(t),T.log(e)}},1e3))},u.captchaSchema=function(e,t,o,i){var n;T.options.hCaptchaSiteKey&&!u.elementById(e)?(n=T.options.invisibleRecaptcha?{type:"captcha",name:"h-captcha-response",html:'<div id="'+e+'" class="h-captcha" data-sitekey="'+T.options.hCaptchaSiteKey+'" data-size="invisible" data-callback="onCaptchaSubmit"></div>',display:"Captcha",rules:""}:{type:"captcha",name:"h-captcha-response",html:'<div id="'+e+'" class="h-captcha" data-sitekey="'+T.options.hCaptchaSiteKey+'"></div>',display:"Captcha",rules:"required"},t.push(n)):!T.options.v2Recaptcha&&!o||u.elementById(e)?T.options.invisibleRecaptcha&&!u.elementById(e)&&(n={type:"captcha",name:"g-recaptcha-response",html:'<div id="'+e+'" style="'+("hide"===o?"display:none":"")+'" class="g-recaptcha" data-sitekey="'+(n=T.options.v2RecaptchaSiteKey||"6LeAiwITAAAAADlqb06JIGepBs8ZRo3OZ7C0W7U3")+'" data-size="invisible" data-callback="onCaptchaSubmit"></div>',display:"Captcha",rules:""},t.push(n)):t.push({type:"captcha",name:"g-recaptcha-response",html:'<div id="'+e+'" class="recaptcha_widget"></div>',display:"Captcha",rules:"required"}),u.elementById(e)||!T.options.tencentCaptcha&&!T.options.tencentCaptchaAsFallback||(window.onTencentCaptchaSubmit=function(e){0==e.ret&&(i?i(e):window.onTencentCaptchaSubmitCallback(e))},n={type:"captcha",name:"TencentCaptcha",html:"<div "+(o?"style=display:none; ":"")+' id= "'+e+'_tencent"  class="TencentCaptcha"  data-appid="'+T.options.tencentCaptchaAppid+'" data-cbfn="onTencentCaptchaSubmit"></div>',display:"Captcha",rules:""},t.push(n))},u.checkPhoneOrEmailLogin=function(e){var t=S.parseQueryString(e);return(t.emailid||t.email)&&(T.options.duplicateEmailWithUniqueUsername&&!t.username?e=e.replace("emailid","username").replace("email","username"):(t=t.emailid||t.email,LoginRadiusDefaults.regexExpression.emailRegex.test(t)?e=e.replace("emailid","email"):T.options.phoneLogin&&LoginRadiusDefaults.regexExpression.phoneRegex.test(t)?(e=e.replace("emailid","phone").replace("email","phone"),e+="&phoneApi=1"):T.options.usernameLogin&&(e=e.replace("emailid","username").replace("email","username")))),e},u.disableResendOTPButton=function(e){var t=T.options.disableResendOTPButtonDelay,o=e.target;o&&(o.disabled=!0,setTimeout(function(){o.disabled=!1},1e3*t))},u.getPassKeyCredentials=function(i,n){return new Promise((t,o)=>{i.publicKey.challenge=T.util.base64UrlDecode(i.publicKey.challenge),i.publicKey.allowCredentials=i.publicKey.allowCredentials||[],i.publicKey.allowCredentials.forEach(function(e){e.id=T.util.base64UrlDecode(e.id)});var e={publicKey:i.publicKey,mediation:n?"conditional":"optional"};navigator.credentials.get(e).then(e=>t(e)).catch(e=>o(e))})},u.createPassKeyCredentials=function(i){return new Promise((t,o)=>{if(i.publicKey.challenge=T.util.base64UrlDecode(i.publicKey.challenge),i.publicKey.user.id=T.util.base64UrlDecode(i.publicKey.user.id),i.publicKey.excludeCredentials)for(var e=0;e<i.publicKey.excludeCredentials.length;e++)i.publicKey.excludeCredentials[e].id=T.util.base64UrlDecode(i.publicKey.excludeCredentials[e].id);navigator.credentials.create({publicKey:i.publicKey}).then(e=>t(e)).catch(e=>o(e))})},u.isPasskeyAvailable=function(){return new Promise((t,o)=>{window.PublicKeyCredential&&window.PublicKeyCredential.isConditionalMediationAvailable?window.PublicKeyCredential.isConditionalMediationAvailable().then(e=>{t(!!e)}).catch(e=>{o(e)}):t(!1)})}}function LoginRadiusApiFramework(c,p){var e=this;e.init=function(){c.lrApiFramework=!0},e.login=function(e,t,o){c.getAppConfiguration(function(){p.loginController(c.util.jsonToQueryString(e),null,t,o)})},e.otpLogin=function(e,t,o){c.getAppConfiguration(function(){p.loginOTPController(c.util.jsonToQueryString(e),null,t,o)})},e.twoFALogin=function(e,t,o,i,n,a,s,r){i=i||function(){},s=s||function(){},r=r||function(){},n=n||function(){},a=a||function(){},c.getAppConfiguration(function(){p.login2FAController(c.util.jsonToQueryString(e),null,t,o,"",s,r,i,n,a)})},e.registration=function(e,t,o,i,n,a){n=n||function(){},a=a||function(){},c.getAppConfiguration(function(){p.registrationController(t,null,o,i,"",e,n,a)})},e.forgotPassword=function(e,t,o){c.getAppConfiguration(function(){p.forgotPasswordController(c.util.jsonToQueryString(e),"",t,o)})},e.forgotPIN=function(e,t,o){c.getAppConfiguration(function(){p.forgotPINController(c.util.jsonToQueryString(e),"",t,o)})},e.resetPassword=function(e,t,o){c.getAppConfiguration(function(){p.resetPasswordController(c.util.jsonToQueryString(e),t,o)})},e.duoVerify=function(e,t,o){c.getAppConfiguration(function(){p.duoVerifyController(c.util.jsonToQueryString(e),t,o)})},e.duoVerifyByAccessToken=function(e,t,o){c.getAppConfiguration(function(){p.duoVerifyByAccessTokenController(c.util.jsonToQueryString(e),t,o)})},e.resetPIN=function(e,t,o){c.getAppConfiguration(function(){p.resetPINController(c.util.jsonToQueryString(e),t,o)})},e.emailVerification=function(e,t,o){c.getAppConfiguration(function(){p.emailVerificationController(e.vtoken,t,o)})},e.socialLogin=function(e,t,o,i,n,a){c.getAppConfiguration(function(){c.LoginRadiusHostedPage&&c.SSOinitFired||(i=i||function(){},n=n||function(){},p.socialLoginReceiveToken(e.token,a,t,o,null,i,n))})},e.resendEmailVerification=function(e,t,o){c.getAppConfiguration(function(){p.resendEmailVerificationController(c.util.jsonToQueryString(e),t,o)})},e.twoFAResendOTP=function(e,t,o){c.getAppConfiguration(function(){p.resendOTP2FAController(c.util.jsonToQueryString(e),t,o)})},e.twoFAVerifyOTP=function(e,t,o){c.getAppConfiguration(function(){p.verify2FAOTPController(c.util.jsonToQueryString(e),t,o)})},e.twoFAUpdatePhone=function(e,t,o,i,n,a,s){i=i||function(){},n=n||function(){},a=a||function(){},s=s||function(){},c.getAppConfiguration(function(){p.update2FAPhoneNumberController(e,null,t,o,null,i,n,a,s)})},e.updatePhone=function(e,t,o,i,n,a,s){a=a||function(){},s=s||function(){},i=i||function(){},n=n||function(){},c.getAppConfiguration(function(){p.updatePhoneNumberController(c.util.jsonToQueryString(e),null,t,o,null,a,s,i,n)})},e.verifyOTP=function(e,t,o,i){c.getAppConfiguration(function(){p.verifyOTPController(e,t,o,i)})},e.resendOTP=function(e,t,o){c.getAppConfiguration(function(){p.resendOTPController(c.util.jsonToQueryString(e),t,o)})},e.addEmail=function(e,t,o){c.getAppConfiguration(function(){p.addEmailController(c.util.jsonToQueryString(e),t,o)})},e.removeEmail=function(e,t,o){c.getAppConfiguration(function(){p.removeEmailController(c.util.jsonToQueryString(e),t,o)})},e.changeUsername=function(e,t,o){c.getAppConfiguration(function(){p.changeUsernameController(c.util.jsonToQueryString(e),t,o)})},e.changePassword=function(e,t,o){c.getAppConfiguration(function(){p.changePasswordController(c.util.jsonToQueryString(e),t,o)})},e.changePIN=function(e,t,o){c.getAppConfiguration(function(){p.changePINController(c.util.jsonToQueryString(e),t,o)})},e.checkPhoneNumberAvailability=function(e,t,o){c.getAppConfiguration(function(){p.checkPhoneNumberAvailabilityController(c.util.jsonToQueryString(e),t,o)})},e.resetPasswordByPhone=function(e,t,o){c.getAppConfiguration(function(){p.resetPasswordByPhoneController(c.util.jsonToQueryString(e),t,o)})},e.resetPINByPhone=function(e,t,o){c.getAppConfiguration(function(){p.resetPINByPhoneController(c.util.jsonToQueryString(e),t,o)})},e.forgotPasswordbyPhone=function(e,t,o){c.getAppConfiguration(function(){p.forgotPasswordbyPhoneController(c.util.jsonToQueryString(e),null,t,o)})},e.forgotPINbyPhone=function(e,t,o){c.getAppConfiguration(function(){p.forgotPINbyPhoneController(c.util.jsonToQueryString(e),null,t,o)})},e.updateData=function(e,t,o,i,n,a){var s=i,r=n,l={},u=("object"==typeof i&&(l=i,s=n,r=a),{});u.Profile=l,u.access_token=o,c.getAppConfiguration(function(){p.updateData(u,null,t,s,r,"",e)})},e.checkEmailAvailability=function(e,t,o){c.getAppConfiguration(function(){p.checkEmailAvailabilityController(c.util.jsonToQueryString(e),t,o)})},e.checkUserNameAvailability=function(e,t,o){c.getAppConfiguration(function(){p.checkUserNameAvailabilityController(c.util.jsonToQueryString(e),t,o)})},e.resetPasswordBySecurityQuestion=function(e,t,o){c.getAppConfiguration(function(){p.resetPasswordBySecurityQuestionController(c.util.jsonToQueryString(e),t,o)})},e.resetPINBySecurityQuestion=function(e,t,o){c.getAppConfiguration(function(){p.resetPINBySecurityQuestionController(c.util.jsonToQueryString(e),t,o)})},e.updateSecurityQuestion=function(e,t,o){c.getAppConfiguration(function(){p.updateSecurityQuestionController(c.util.jsonToQueryString(e),t,o)})},e.resetTwoFactor=function(e,t,o){c.getAppConfiguration(function(){p.resetTwoFactorAuthenticationController(e,t,o)})},e.invalidateToken=function(e,t,o){c.getAppConfiguration(function(){p.invalidateToken(e,t,o)})},e.validateToken=function(e,t,o){c.getAppConfiguration(function(){p.validateToken(e,t,o)})},e.getSocialData=function(e,t,o,i,n){c.getAppConfiguration(function(){p.getSocialDataController(e,t,o,i,n)})},e.postSocialData=function(e,t,o,i,n,a){c.getAppConfiguration(function(){p.postSocialDataController(e,t,o,i,n,a)})},e.getCustomObjects=function(e,t,o){c.getAppConfiguration(function(){p.getCustomObjectsController(e,t,o)})},e.createCustomObject=function(e,t,o,i){c.getAppConfiguration(function(){p.createCustomObjectController(e,t,o,i)})},e.getCustomObjectById=function(e,t,o,i){c.getAppConfiguration(function(){p.getCustomObjectByIdController(e,t,o,i)})},e.deleteCustomObjectById=function(e,t,o,i){c.getAppConfiguration(function(){p.deleteCustomObjectController(e,t,o,i)})},e.updateCustomObjectById=function(e,t,o,i,n,a){c.getAppConfiguration(function(){p.updateCustomObjectController(e,t,o,a,i,n)})},e.getBackupCode=function(e,t,o){c.getAppConfiguration(function(){p.getBackupCodeController(e,t,o)})},e.resetBackupCode=function(e,t,o){c.getAppConfiguration(function(){p.resetBackupCodeController(e,t,o)})},e.autoLogin=e.smartLogin=function(e,t,o){c.getAppConfiguration(function(){p.smartLoginController(c.util.jsonToQueryString(e),t,o)})},e.verifyConsent=function(e,t,o){c.getAppConfiguration(function(){p.verifyConsentController(e,t,o)})},e.fetchConsentLogs=function(e,t){c.getAppConfiguration(function(){p.consentLogsController(e,t)})},e.updateConsents=function(e,t,o){c.getAppConfiguration(function(){p.updateConsentController(e,t,o)})},e.submitConsentbyConsentToken=function(e,t,o){var i=e.consentToken||"";i?c.getAppConfiguration(function(){p.submitConsentController(i,e,t,o)}):(o({response:"consentToken is required parameter"}),c.log("consentToken is required parameter"))},e.submitConsentbyAccesToken=function(e,t,o){c.getAppConfiguration(function(){p.customEventConsentController(e,t,o)})},e.oneTouchLogin=function(e,t,o,i,n){c.getAppConfiguration(function(){i=i||function(){},n=n||function(){},p.oneTouchLoginController(e,null,t,o,"",!0,i,n)})},e.oneTouchLoginVerify=function(e,t,o){c.getAppConfiguration(function(){e.verificationtoken&&e.email?p.oneTouchLoginEmailVerification(e.verificationtoken,t,o,e.email):e.verificationtoken?p.oneTouchLoginEmailVerification(e.verificationtoken,t,o):e.otp&&e.phone&&p.verifyOTPController({otp:e.otp,onetouchloginflag:!0},{phone:e.phone},t,o)})},e.getInvitationData=function(e,t,o){c.getAppConfiguration(function(){p.getInvitationDataController(e,t,o)})}}function setLoginRadiusDefaultSchema(e){e.organizationFormSchema=[{type:"string",name:"organizationname",display:"Organization Name",rules:"required",permission:"r"}],e.lookupFormSchema=[{type:"string",name:"emailid",display:"Email Id",rules:"required|valid_email",permission:"r"}],e.loginFormSchema=[{type:"string",name:"emailid",display:"Email Id",rules:"required|valid_email",permission:"r"},{type:"password",name:"password",display:"Password",rules:"required|min_length[6]|max_length[32]",permission:"w"}],e.backupCodeFormSchema=[{type:"string",name:"backupcode",display:"Backup Code",rules:"required",permission:"r"}],e.resetPasswordByPhoneSchema=[{type:"string",name:"otp",display:"Verification Code",rules:"required",permission:"r"},{type:"password",name:"password",display:"Password",rules:"required|min_length[6]|max_length[32]",permission:"w"}],e.resetPINByPhoneSchema=[{type:"string",name:"otp",display:"Verification Code",rules:"required",permission:"r"},{type:"password",name:"pin",display:"PIN",rules:"required|min_length[4]|max_length[32]",permission:"w"}],e.checkPhoneNumberSchema=[{type:"string",name:"phone",display:"Phone Number",rules:"required|valid_phoneno",permission:"r"}],e.QRCodeSchema=[{type:"string",name:"AuthenticatorCode",display:"Authenticator Code",rules:"required",permission:"r"}],e.getSecQSchema=[{type:"string",name:"emailid",display:"Email Id",rules:"required|valid_email",permission:"r"}],e.otpSchema=[{type:"string",name:"otp",display:"Verification Code",rules:"required",permission:"r"}],e.forgotPasswordFormSchema=[{type:"string",name:"emailid",display:"Email",rules:"required",permission:"r"}],e.forgotPINFormSchema=[{type:"string",name:"emailid",display:"Email",rules:"required",permission:"r"}],e.forgotPassKeyFormSchema=[{type:"string",name:"emailid",display:"Email",rules:"required",permission:"r"}],e.smartLoginSchema=[{type:"string",name:"emailid",display:"Email Id",rules:"required",permission:"r"}],e.passwordLessLoginSchema=[{type:"string",name:"emailid",display:"Email",rules:"required",permission:"r"},{type:"string",name:"name",display:"Name",rules:"",permission:"r"}],e.changePasswordFormSchema=[{type:"password",name:"oldpassword",display:"Old Password",rules:"required",permission:"w"},{type:"password",name:"newpassword",display:"Password",rules:"required|min_length[6]|max_length[32]",permission:"w"},{type:"password",name:"confirmnewpassword",display:"Confirm Password",rules:"required|min_length[6]|max_length[32]|matches[newpassword]",permission:"w"}],e.emailSchema=e.forgotPasswordFormSchema,e.addEmailSchema=[{type:"string",name:"emailid",display:"Email",rules:"required|valid_email",permission:"r"},{type:"string",name:"type",display:"Type",rules:"required",permission:"r"}],e.changeUsernameFormSchema=[{type:"string",name:"username",display:"Username",rules:"required",permission:"r"}],e.changePINFormSchema=[{type:"password",name:"oldpin",display:"Old PIN",rules:"required",permission:"w"},{type:"password",name:"newpin",display:"PIN",rules:"required",permission:"w"},{type:"password",name:"confirmnewpin",display:"Confirm PIN",rules:"required|matches[newpin]",permission:"w"}],e.resetPasswordFormSchema=[{type:"password",name:"password",display:"Password",rules:"required|min_length[6]|max_length[32]",permission:"w"},{type:"password",name:"confirmpassword",display:"Confirm Password",rules:"required|matches[password]|min_length[6]|max_length[32]",permission:"w"},{type:"hidden",name:"resettoken",display:"",rules:"required",permission:"w",value:""}],e.resetPINFormSchema=[{type:"password",name:"pin",display:"PIN",rules:"required|min_length[4]|max_length[32]",permission:"w"},{type:"password",name:"confirmpin",display:"Confirm PIN",rules:"required|matches[pin]|min_length[4]|max_length[32]",permission:"w"},{type:"hidden",name:"resettoken",display:"",rules:"required",permission:"w",value:""}],e.pinLoginFormSchema=[{type:"password",name:"pin",display:"PIN",rules:"required",permission:"r"}],e.privacyPolicySchema=[{type:"multi",name:"acceptprivacypolicy",display:"I agree to the terms of service",rules:"",permission:"r"}],e.btnOTPSchema={type:"button",name:"click",display:"click",rules:"",permission:"r",event:"click",eventCallback:function(){}},e.defaultBtnSchema={type:"button",name:"default",display:"default",rules:"",permission:"r",event:"click",eventCallback:function(){}}}function setLoginRadiusModuleFunctions(c,p){var d=LoginRadiusDefaults.options,m=new SetLoginRadiusCommonFunctions(c),e=new LoginRadiusControllers(c,m),g=c.util,f=(c.version="3.28.4",c.LRCheckRegistration=!1,c.passwordlessLoginFlag=!1,c.duoLoginFlag=!1,c.socialLoginFlag=!1,c.LRCheckLogin=!1,c.LRCheck2FA=!1,c.loginAction=!1,c.options={},c.consentOptions="",c.lookupOptions="",c.sessionData={getUid:function(){return c.storage.getBrowserStorage(LoginRadiusDefaults.storedUidName)},getToken:function(){return c.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName)}},c.errorMessages=[],c.validationMessages=[],c.formCustomLabel={},c.formElementsTitle={},c.defaultOptionField={},c.formValidations={},c.formPlaceholder={},c.formElementAttributes={},c.buttonElements={},c.passwordMeterConfiguration=[],c.buttonsName={},c.eventsName={},c.log=function(e){c.options.debugMode&&"undefined"!=typeof console&&console.error(e)},c.customInterface=function(e,t){var o=t.templateName||"";h(function(){m.renderCustomInterface(e,"",o)})},c.clearSession=function(){c.storage.removeBrowserStorage(LoginRadiusDefaults.storedTokenName),c.storage.removeBrowserStorage(LoginRadiusDefaults.storedUidName),c.storage.removeBrowserStorage(LoginRadiusDefaults.storedTwoFAToken),c.storage.removeBrowserStorage(LoginRadiusDefaults.storedOrganization)},c.setSessionToken=function(e){e={session_token:e.session_token,session_expires_in:e.session_expires_in},c.storage.setBrowserStorage(LoginRadiusDefaults.storedSessionTokenData,JSON.stringify(e))},c.getSessionToken=function(){var e=JSON.parse(c.storage.getBrowserStorage(LoginRadiusDefaults.storedSessionTokenData));return e&&e.session_expires_in&&new Date<new Date(e.session_expires_in)?e.session_token:(c.removeSessionToken(),!1)},c.removeSessionToken=function(){c.storage.removeBrowserStorage(LoginRadiusDefaults.storedSessionTokenData)},c.documentCookies=Object.assign({},LRNameSpace.cookies),[]);function h(e){try{c.options=g.mergeOptions(c.options,p),c.options.apiCustomDomain&&(t=LoginRadiusDefaults.apiDomain,LoginRadiusDefaults.apiDomain=t.replace(/https:.*\/identity/,"https://"+c.options.apiCustomDomain+"/identity"),o=LoginRadiusDefaults.socialApiDomain,LoginRadiusDefaults.socialApiDomain=o.replace(/https:.*\/api/,"https://"+c.options.apiCustomDomain+"/api")),c.options.cloudApiCustomDomain&&(i=LoginRadiusDefaults.cloudApiDomain,LoginRadiusDefaults.cloudApiDomain=i.replace(/https:.*\.com/,"https://"+c.options.cloudApiCustomDomain));var t,o,i,n,a,s,r=!c.options.isB2BEnabled||!c.options.promptOrganization||c.options.organization;c.isApiCallingStarted||r?!c.isApiCallingStarted&&r?(c.isApiCallingStarted=!0,f.push(e),n=c.storage.getBrowserStorage(LoginRadiusDefaults.storedOrganization),a=c.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),c.LoginRadiusHostedPage&&(a=c.storage.getBrowserStorage("lr-session-token")),s=LoginRadiusDefaults.configApiDomain+"appInfo?apikey="+p.apiKey,c.options.isB2BEnabled&&(c.options.organization?s+="&org_name="+c.options.organization:n&&a&&(s+="&org_name="+n)),a&&(s+="&autolookupproviders=true"),g.ajaxCall("get",s,"",function(o){function i(e){var t,o,i,n,a,s;e.ErrorCode?c.isApiCallingStarted=!1:(c.storage.removeBrowserStorage(LoginRadiusDefaults.storedOrganization),e.Organization&&e.Organization.Name&&c.storage.setBrowserStorage(LoginRadiusDefaults.storedOrganization,e.Organization.Name),n={},p.organizationObj=(t=e).Organization,p.securityQuestionEnabled=t.IsSecurityQuestion,p.appName=p.appName||t.AppName,p.RegistrationFormSchema=t.RegistrationFormSchema,p.loginLockedType=t.LoginLockedConfiguration&&t.LoginLockedConfiguration.LoginLockedType,p.securityQuestionEnabled&&(p.SecurityQuestions=t.SecurityQuestions.Questions,p.securityQuestionsCount=void 0===p.securityQuestionsCount?t.SecurityQuestions.SecurityQuestionCount:p.securityQuestionsCount),void 0===p.passwordLength&&p.displayPasswordStrength&&p.RegistrationFormSchema&&(o=g.findInSchema(p.RegistrationFormSchema,"name","password").rules.split("|"),a=(a=g.isSubstring("min_length[",Object.keys(o).map(function(e){return o[e]})))?o[a].substring(o[a].lastIndexOf("min_length[")+11,o[a].lastIndexOf("]")):"",s=(s=g.isSubstring("max_length[",Object.keys(o).map(function(e){return o[e]})))?o[s].substring(o[s].lastIndexOf("max_length[")+11,o[s].lastIndexOf("]")):"",i={},a&&(i.min=parseInt(a)),s&&(i.max=parseInt(s)),p.passwordLength=i),p.SocialSchema=t.SocialSchema,p.maskSensitiveInput=p.encryptedAnswer||p.maskSensitiveInput,p.noCallbackForSocialLogin=void 0!==p.noCallback?p.noCallback:p.noCallbackForSocialLogin,t.TwoFactorAuthentication&&t.TwoFactorAuthentication.IsEnabled&&(n.optionalTwoFactorAuthentication=!0,n.twoFactorAuthentication=!1,n.qrCodeAuthentication=t.TwoFactorAuthentication.IsAuthenticator,n.emailOTPAuthentication=t.TwoFactorAuthentication.IsEmailOTPAuthenticator,n.pushNotificationAuthenticator=t.TwoFactorAuthentication.IsPushAuthenticator,n.securityQuestionAuthentication=t.TwoFactorAuthentication.IsSecurityQuestionAuthenticator,n.smsOTPAuthentication=t.TwoFactorAuthentication.IsSmsOTPAuthenticator,n.duoAuthentication=t.TwoFactorAuthentication.IsDuoSecurityAuthenticator,n.passkeyAuthenticator=t.TwoFactorAuthentication.IsPasskeyAuthenticator,t.TwoFactorAuthentication.IsRequired)&&(n.optionalTwoFactorAuthentication=!1,n.twoFactorAuthentication=!0),p.optionalTwoFactorAuthentication=(void 0===p.optionalTwoFactorAuthentication?n:p).optionalTwoFactorAuthentication,p.twoFactorAuthentication=(void 0===p.twoFactorAuthentication?n:p).twoFactorAuthentication,p.qrCodeAuthentication=void 0===p.googleAuthentication?(void 0===p.qrCodeAuthentication?n:p).qrCodeAuthentication:p.googleAuthentication,p.phoneLogin=void 0===p.phoneLogin?t.IsPhoneLogin:p.phoneLogin,p.passwordlessLoginOTP=void 0===p.instantOTPLogin&&void 0===p.passwordlessLoginOTP?t.IsInstantSignin.SmsOtp:p.instantOTPLogin||p.passwordlessLoginOTP,"optional"===t.EmailVerificationFlow?n.optionalEmailVerification=!0:"disabled"===t.EmailVerificationFlow&&(n.disabledEmailVerification=!0),p.optionalEmailVerification=(void 0===p.optionalEmailVerification?n:p).optionalEmailVerification,p.disabledEmailVerification=(void 0===p.disabledEmailVerification?n:p).disabledEmailVerification,p.loginOnEmailVerification=void 0===p.loginOnEmailVerification?t.IsLoginOnEmailVerification:p.loginOnEmailVerification,p.passwordlessLogin=void 0===p.instantLinkLogin&&void 0===p.passwordlessLogin?t.IsInstantSignin.EmailLink:p.instantLinkLogin||p.passwordlessLogin,p.askRequiredFieldForTraditionalLogin=void 0===p.askRequiredFieldForTraditionalLogin?t.AskRequiredFieldsOnTraditionalLogin:p.askRequiredFieldForTraditionalLogin,p.stayLogin=void 0===p.stayLogin?t.IsRememberMe:p.stayLogin,p.disableSignup=void 0===p.disableSignup?t.IsDisabledRegistration:p.disableSignup,p.riskBasedAuthentication=void 0===p.riskBasedAuthentication?t.IsRiskBasedAuthentication:p.riskBasedAuthentication,p.noCallbackForSocialLogin=void 0===p.noCallbackForSocialLogin?t.IsNoCallbackForSocialLogin:p.noCallbackForSocialLogin,p.usernameLogin=void 0===p.usernameLogin?t.IsUserNameLogin:p.usernameLogin,p.promptPasswordOnSocialLogin=void 0===p.promptPasswordOnSocialLogin?t.AskPasswordOnSocialLogin:p.promptPasswordOnSocialLogin,p.askOptionalFieldsOnRegistration=void 0===p.askOptionalFieldsOnRegistration?t.AskOptionalFieldsOnSocialSignup:p.askOptionalFieldsOnRegistration,p.askEmailForUnverifiedProfileAlways=void 0===p.askEmailForUnverifiedProfileAlways?t.AskEmailIdForUnverifiedUserLogin:p.askEmailForUnverifiedProfileAlways,p.logoutOnVerifyEmail=void 0===p.logoutOnVerifyEmail?t.IsLogoutOnEmailVerification:p.logoutOnVerifyEmail,p.disableAccountLinking=t.IsDisabledAccountLinking,p.duplicateEmailWithUniqueUsername=t.DuplicateEmailWithUniqueUsername,p.customDomain=p.customDomain||t.CustomDomain,p.privacyPolicyConfiguration=t.PrivacyPolicyConfiguration,p.isConsentManagementEnabled=(void 0===p.IsConsentManagementEnabled?t:p).IsConsentManagementEnabled,p.loginOnPasswordReset=t.LoginOnPasswordReset,p.optionalRecaptchaConfiguration=t.OptionalRecaptchaConfiguration,p.isVoiceOtp=t.IsVoiceOTP,p.isB2BEnabled=t.IsB2BEnabled,(p.v2Recaptcha||t.IsV2Recaptcha)&&(p.invisibleRecaptcha=!1,p.v2Recaptcha=!0),(p.invisibleRecaptcha||t.IsInvisibleRecaptcha)&&(p.invisibleRecaptcha=!0,p.v2Recaptcha=!1),p.isCaptchaEnabled=p.v2Recaptcha||p.invisibleRecaptcha,p.v2RecaptchaSiteKey=p.v2RecaptchaSiteKey||t.V2RecaptchaSiteKey,p.tencentCaptchaAppid=p.tencentCaptchaAppid||t.QQTencentCaptchaKey,(a=t.CaptchaConfig)&&a.IsEnabled&&(p.isCaptchaEnabled=!0,a.GoogleRecaptchaV2&&(p.v2RecaptchaSiteKey=a.GoogleRecaptchaV2.PublicKey,p.v2Recaptcha=void 0===p.v2Recaptcha?!a.GoogleRecaptchaV2.IsInvisibleCaptcha:p.v2Recaptcha,p.invisibleRecaptcha=void 0===p.invisibleRecaptcha?a.GoogleRecaptchaV2.IsInvisibleCaptcha:p.invisibleRecaptcha),a.QQTencentCaptcha&&(p.tencentCaptchaAppid=a.QQTencentCaptcha.PublicKey,p.tencentCaptcha=void 0===p.tencentCaptcha||p.tencentCaptcha),a.GoogleRecaptchaV3&&(p.v2RecaptchaSiteKey=a.GoogleRecaptchaV3.PublicKey,p.invisibleRecaptcha=!0,p.v2Recaptcha=!1),a.HCaptcha)&&(p.hCaptchaSiteKey=p.hCaptchaSiteKey||a.HCaptcha.PublicKey,p.captchaTheme=p.captchaTheme||a.HCaptcha.IsDarkTheme?"dark":"light",p.invisibleRecaptcha=a.HCaptcha.IsInvisibleCaptcha),(s=t.PassKeysConfig)&&s.IsEnabled&&(p.isPassKeysEnabled=!0),n.isPINAuthentication=!1,t.PINAuthentication&&t.PINAuthentication.IsEnabled&&(n.isPINAuthentication=!0,n.PINConfiguration=Object.assign({},t.PINAuthentication.Configuration),p.PINConfiguration?p.PINConfiguration=Object.assign({},n.PINConfiguration,p.PINConfiguration):p.PINConfiguration=Object.assign({},n.PINConfiguration)),p.isPINAuthentication=n.isPINAuthentication,p.isPINAuthentication&&(c.pinSchema=[],i=g.findInSchema(p.RegistrationFormSchema,"name","pin"),g.isEmpty(i)?c.log("Pin schema is not defined"):(c.pinSchema.push(i),!p.PINConfiguration.IsRequired||c.pinSchema[0].rules&&-1!==c.pinSchema[0].rules.indexOf("required")||(c.pinSchema[0].rules=c.pinSchema[0].rules?[c.pinSchema[0].rules,"required"].join("|"):"required"),a=g.findInSchema(p.RegistrationFormSchema,"name","confirmpin"),g.isEmpty(a)||c.pinSchema.push(a))),p.isConsentManagementEnabled&&m.setConsentTemplate(),p.emailOTPAuthentication=n.emailOTPAuthentication,p.smsOTPAuthentication=n.smsOTPAuthentication,p.duoAuthentication=n.duoAuthentication,p.securityQuestionAuthentication=n.securityQuestionAuthentication,p.templateVerificationTypes=t.TemplateVerificationTypes,p.pushNotificationAuthentication=n.pushNotificationAuthenticator,p.passkeyAuthentication=n.passkeyAuthenticator,p=g.mergeOptions(d,p)),c.options=p,c.appConfigInfoCalled=!0;for(var r=0;r<f.length;r++)"function"==typeof f[r]&&f[r](e)}var e,t;o.IsAutoLookUpEnabled&&c.currentActionOptions&&c.currentActionOptions.login.container?(i(o),e=c.currentActionOptions.login.container,t=function(e){c.getAutoLookupDomainConfiguration(e.email,function(){var e,t;c.lookupOptions&&c.lookupOptions.Provider&&c.lookupOptions.Provider.Endpoint?(e=m.addSocialEndpointOptions(),t=c.util.getThisObjectName(),window[t].util.openWindow(decodeURIComponent(c.lookupOptions.Provider.Endpoint+e)),c.isLookupApiCallingStarted=!1,c.lookupOptions=""):i(o)})},m.createForm(c.lookupFormSchema,"lookupdomain",e,function(e){var n=c.util.parseQueryString(e);c.$hooks.register("afterFormRender",function(e,t,o,i){"login"===e&&(i.elements[0].value=n.email)}),t(n)})):i(o)},"registrationSchema")):c.isApiCallingStarted&&(c.appConfigInfoCalled?e():"logout"===c.useraction?(c.isApiCallingStarted=!1,h(e)):f.push(e)):(c.isApiCallingStarted=!1,f.push(e),"organization"===c.useraction&&(l=c.currentActionOptions[c.useraction].container,u=function(){h(function(e){var t;e.ErrorCode?(c.isApiCallingStarted=!1,c.currentActionOptions[c.useraction].onError(e)):((t=document.getElementsByName("loginradius-organization")[0])&&t.remove(),c.currentActionOptions[c.useraction].onSuccess(e))})},c.currentActionOptions[c.useraction].classPrefix,m.createForm(c.organizationFormSchema,"organization",l,function(e){e=c.util.parseQueryString(e),c.options.organization=e.organizationname,u()})))}catch(e){c.log(e)}var l,u}var l=[],o=(c.getConsentConfiguration=function(e){c.isConsentApiCallingStarted||""!==c.consentOptions?c.isConsentApiCallingStarted&&(""!==c.consentOptions?e(c.consentOptions):l.push(e)):(c.isConsentApiCallingStarted=!0,l.push(e),g.ajaxCall("get",LoginRadiusDefaults.configApiDomain+"consent?apiKey="+c.options.apiKey,"",function(e){if(e){c.consentOptions={},c.consentsList={};for(var t="",o=0;o<e.length;o++){for(var i=0;i<e[o].Events.length;i++)t=e[o].Events[i].Name,"true"===e[o].Events[i].IsCustom&&(t="custom_"+t),c.consentOptions[t]={},c.consentOptions[t].ConsentForm=e[o].ConsentForm,c.consentOptions[t].TermOfService=e[o].TermOfService,c.consentOptions[t].PrivacyPolicy=e[o].PrivacyPolicy;for(var n=0;n<e[o].ConsentForm.length;n++)for(var a=e[o].ConsentForm[n],s=0;s<a.Consents.length;s++)c.consentsList[a.Consents[s].ConsentId]||(c.consentsList[a.Consents[s].ConsentId]=a.Consents[s])}for(var r=0;r<l.length;r++)l[r](c.consentOptions)}else c.isConsentApiCallingStarted=!1}))},[]);c.getAutoLookupDomainConfiguration=function(e,t){c.isLookupApiCallingStarted||""!==c.lookupOptions?c.isLookupApiCallingStarted&&(""!==c.lookupOptions?t(c.lookupOptions):o.push(t)):(c.isLookupApiCallingStarted=!0,o.push(t),g.ajaxCall("get",LoginRadiusDefaults.configApiDomain+"lookup?apiKey="+c.options.apiKey+"&email="+e,"",function(e){e?(c.lookupOptions=e,o[0](c.lookupOptions)):c.isLookupApiCallingStarted=!1}))},c.getAppConfiguration=h,c.progressiveProfiling=new LRNameSpace.ProgressiveProfiling(c,m,e,LoginRadiusDefaults),c.progressiveProfiling.init=function(){h(function(){c.progressiveProfiling.fetchSchema(function(e){c.progressiveProfilingSchema=e,c.$hooks.register("registrationSchemaFilter",function(e,t){c.options.progressiveProfilingTraditional&&(c.LoggedinSocialProvderProfile=t)})},"progressiveProfilingSchema")})}}function LoginRadiusHooksModel(T){var S=T.util,o=LoginRadiusDefaults.messages;T.$hooks={hooks:[],register:function(e,t,o){void 0===T.$hooks.hooks[e]&&(T.$hooks.hooks[e]=[]),parseInt(o,10)===o&&T.$hooks.hooks[e].length>o+1?T.$hooks.hooks[e].splice(o,0,t):T.$hooks.hooks[e].push(t)},call:function(e){var t=Array.prototype.splice.call(arguments,1);if(void 0!==T.$hooks.hooks[e])for(var o=0,i=T.$hooks.hooks[e].length;o<i;++o)T.$hooks.hooks[e]&&T.$hooks.hooks[e][o]&&T.$hooks.hooks[e][o].apply(null,t)}},T.$hooks.register("addEventOnElement",function(e){S.extend(T.eventsName,e)}),T.$hooks.register("mapErrorMessages",function(e){if(e.code&&e.message)T.errorMessages.push(e);else if(S.isArray(e))for(var t=0;t<e.length;t++)e[t].code&&e[t].message?T.errorMessages.push(e[t]):T.log(o.notValidMessage);else T.log(o.notValidMessage)}),T.$hooks.register("passwordMeterConfiguration",function(e){S.isArray(e)?S.extend(T.passwordMeterConfiguration,e):T.log(o.passwordStrengthMessage)}),T.$hooks.register("setButtonsName",function(e){for(var t,o=Object.keys(e),i=o.length,n={};i--;)n[(t=o[i]).toLowerCase()]=e[t];S.extend(T.buttonsName,n)}),T.$hooks.register("mapValidationMessages",function(e){if(e.rule&&e.message)T.validationMessages.push(e);else if(S.isArray(e))for(var t=0;t<e.length;t++)e[t].rule&&e[t].message?T.validationMessages.push(e[t]):T.log(o.notValidMessage);else T.log(o.notValidMessage)}),T.$hooks.register("customizeFormLabel",function(e){S.extend(T.formCustomLabel,e)}),T.$hooks.register("customizeElementTitle",function(e){S.extend(T.formElementsTitle,e)}),T.$hooks.register("defaultChoiceOption",function(e){S.extend(T.defaultOptionField,e)}),T.$hooks.register("customizeFormPlaceholder",function(e){S.extend(T.formPlaceholder,e)}),T.$hooks.register("formValidationRules",function(e){S.extend(T.formValidations,e)}),T.$hooks.register("formAttributes",function(e){S.extend(T.formElementAttributes,e)}),T.$hooks.register("buttonAttributes",function(e){S.extend(T.buttonElements,e)}),T.$hooks.register("addFormCaptcha",function(n,a,s,r){T.getAppConfiguration(function(){s&&(T.options[s]=!0);var e,t,o=r||n+"recaptcha_widget",i=(S.addRecaptchaJS(),[]);T.util.elementById(o)||(S.captchaSchema(o,i,!1,a),(e=document.createElement("div")).setAttribute("name",i[0].name),T.options.invisibleRecaptcha&&a&&(t=a.toString(),t=/function ([^\(]*)/.exec(t)[1],i[0].html=i[0].html.replace("onCaptchaSubmit",t)),e.innerHTML=i[0].html,S.addHTMLContent(n,e,!0)),S.renderV2Recaptcha(o,!1,a)})}),T.$hooks.register("addFormCaptchaExecute",function(e,t,o){var i,n=t?e:e+"recaptcha_widget",t=S.elementById(n+"_tencent");T.options.invisibleRecaptcha?i=setInterval(function(){try{if(void 0!==window.hcaptcha&&T.options.hCaptchaSiteKey){try{window.hcaptcha.execute(window[n])}catch(e){}clearInterval(i)}else if("undefined"!=typeof grecaptcha){try{grecaptcha.execute(window[n])}catch(e){}clearInterval(i)}}catch(e){clearInterval(i),T.log(e)}},1e3):t&&"none"!==t.style.display&&(T.options.tencentCaptcha||T.options.tencentCaptchaAsFallback&&!window.grecaptcha)?t.click():T.options.isCaptchaEnabled&&(e={error:LoginRadiusDefaults.messages.captchaError},T.options.hCaptchaSiteKey&&(t=document.querySelector("textarea[name*='h-captcha-response']"))&&(t.value?o({success:t.value}):o(e)),T.options.v2RecaptchaSiteKey)&&(t=document.querySelector("textarea[name*='g-recaptcha-response']"))&&(t.value?o({success:t.value}):o(e))}),T.$hooks.register("successCallback",function(n,a,e){var t,o,i,s,r,l,u,c,p,d,m,g,f,h,y,C,v,w="";n&&(T.$hooks.register("setCurrentAction",function(){T.storage.setBrowserStorage("LRSetSafariToken",n)}),w="verifyotp"===n.toLowerCase()?"otp":n.toLowerCase()),"1132"==a.ErrorCode?(T.LRCheckLogin||!T.LRCheck2FA||T.LRCheck2FA&&"twofaotp"===n)&&(T.options.v2Recaptcha||T.options.invisibleRecaptcha||T.options.tencentCaptcha||T.options.tencentCaptchaAsFallback||(T.options.v2Recaptcha=!0),"verifyemail"===w&&(S.elementById("loginradius-submit-verify").style.display="block"),C=T.LRPrefix.replace("##","")+"recaptcha_widget_"+w,(v=T.util.elementById(C,!0))&&(v.style.display="block"),window.grecaptcha&&v&&""!==v.innerHTML?grecaptcha.reset(window[C+"lr_recaptcha_widgets_idprefix"]):T.util.renderV2Recaptcha(C,!1)):"1148"==a.ErrorCode||"1165"==a.ErrorCode?(v=S.parseString(e))&&!v.hasOwnProperty("securityanswer")&&(C=e,h=w,T.options.securityQuestionEnabled)&&(y=S.jsonToQueryString(JSON.parse(C)),new LoginRadiusControllers(T).getSecurityQuestionsController(y,function(n){if(0<n.length)for(var e=0;e<n.length;e++)-1!==y.indexOf(n[e].name)&&n.splice(e,1);var t,o,i;0<n.length&&(t=document.createElement("div"),o=[],i=T.LRPrefix.split("##"),new SetLoginRadiusCommonFunctions(T).createFormFields(n,t,h,o,i[0],i[1]),new FormValidator(i[1]+h,o,function(e){T.mergeFormErrors={},T.mergeFormErrors=e}),T.$hooks.register("startProcess",function(e,t){for(var o={},i=0;i<n.length;i++)t&&t[n[i].name]&&(o[n[i].name]=t[n[i].name],delete t[n[i].name]);t&&(t.securityanswer=o)}),T.util.addHTMLContent("",t,!0,h,i[0]))})):"1194"==a.ErrorCode?(t=a,e=n,o="",(w=T.privacyPolicySchema.slice())[0].rules="Strict"===T.options.privacyPolicyConfiguration.Mode?"required":"",i=new SetLoginRadiusCommonFunctions(T),s=new LoginRadiusControllers(T,i),T.$hooks.call("getCurrentActionOptions",e),r=function(){},l=function(){},u="",T.currentActionOptions[e]&&(r=T.currentActionOptions[e].onSuccess||r,l=T.currentActionOptions[e].onError||l,u=T.currentActionOptions[e].classPrefix||u),"socialLogin"===e?(o=T.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),T.$hooks.call("socialLoginFormRender")):o=t.Data.access_token||(t.Data&&t.Data.Data?t.Data.Data.access_token:""),i.createForm(w,"privacyPolicyUpdate",T.currentLRContainer,function(e){s.updatePrivacyPolicy(o,t,r,l,null,T.currentLRContainer,u)},function(e){l(i.setMappedMessage(e))})):"1243"==a.ErrorCode?(e=a,w=n,T.pinSchema&&T.pinSchema.length?(c=e.Data.PINAuthToken,(p=new SetLoginRadiusCommonFunctions(T)).setPINRule(S.findInSchema(T.pinSchema,"name","confirmpin")),d=new LoginRadiusControllers(T,p),T.$hooks.call("getCurrentActionOptions",w),m=function(){},g=function(){},f="",T.currentActionOptions[w]&&(m=T.currentActionOptions[w].onSuccess||m,g=T.currentActionOptions[w].onError||g,f=T.currentActionOptions[w].classPrefix||f),p.createForm(T.pinSchema,"pinSetup",T.currentLRContainer,function(e){d.configurePINController(c,e,m,g,T.currentLRContainer,f)},function(e){g(p.setMappedMessage(e))})):T.log("Pin Schema is not defined in the schema")):1226===a.ErrorCode&&a.Data&&a.Data.ConsentToken&&!T.lrApiFramework&&T.getConsentConfiguration(function(e){var o,t=a,u=n,c=t.Data.ConsentToken;t.Data.ConsentProfile&&t.Data.ConsentProfile.Consents&&t.Data.ConsentProfile.Consents.Options&&(o=t.Data.ConsentProfile.Consents.Options);for(var p=new SetLoginRadiusCommonFunctions(T),d=new LoginRadiusControllers(T,p),m="",g=[],f=[],i=0;i<t.Data.Events.length;i++)g.push(t.Data.Events[i].Name);T.$hooks.call("getCurrentActionOptions",u);var h=function(){},y=function(){},C="",v="";T.currentActionOptions[u]&&(h=T.currentActionOptions[u].onSuccess||h,y=T.currentActionOptions[u].onError||y,C=T.currentActionOptions[u].classPrefix||C,v=T.currentActionOptions[u].container||""),v=v||T.currentLRContainer,"socialLogin"===u&&T.$hooks.call("socialLoginFormRender"),function s(r,l){var e=[],t=p.createConsentInterface(r[l],o);""!==t&&(e.push({html:t,type:"html",name:"consent"}),p.createForm(e,"consentlogin",v,function(e){var t=p.consentValidation(e,l);if(0<t.length)y(p.setMappedMessage(t));else if(m=m?m+"&"+e:e,f.push({Event:l,IsCustom:!1}),g.splice(0,1),0<g.length)s(r,g[0]);else{var o,i=T.util.parseQueryString(m),n=[];for(o in i){var a=o.replace("consent_","");n.push({ConsentOptionId:a,IsAccepted:i[o]})}i={},0<n.length&&(i.Events=f,i.Data=n),d.submitConsentController(c,i,h,y,v,C,u)}},function(e){y(p.setMappedMessage(e))}))}(e,g[0])})}),T.$hooks.register("afterFormRender",function(e,t,o,i){var n=T.options.RegistrationFormSchema,a=[];if("registration"===e){for(var s,r,l={},u=0;u<n.length;u++)n[u]&&n[u].DataSource&&null!==n[u].DataSource&&(l[n[u].DataSource]=n[u],l[n[u].DataSource].children=[]);for(r in l)l.hasOwnProperty(r)&&((s=l[r]).ParentDataSource&&null!=s.ParentDataSource?l[s.ParentDataSource].children:a).push(s);if(0<a.length)for(var c=t,p=a,d=o,m=[],g=new SetLoginRadiusCommonFunctions(T),f=0;f<p.length;f++)p[f].ParentDataSource||S.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/registrationdata/"+p[f].DataSource+"?apiKey="+T.options.apiKey,"",function(e,t){if(m[e.DataSource]=t,m[e.DataSource])for(var o=0;o<m[e.DataSource].length;o++){var i=document.createElement("option"),n=(i.setAttribute("value",m[e.DataSource][o].Id),i.appendChild(document.createTextNode(m[e.DataSource][o].Key)),document.getElementById(d+"registration-"+e.name));n&&n.appendChild(i)}if(e&&e.children&&0<e.children.length)for(var a=0;a<e.children.length;a++)g.addChangeEventHandler(c,e,e.children[a],d)},"registration",p[f])}if("validatecode"===e)for(var h=e,y=n,C=o,v=0;v<y.length;v++)y[v].DataSource&&T.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/registrationdata/"+y[v].DataSource+"?apiKey="+T.options.apiKey,"",function(e,t){for(var o=0;o<t.length;o++){var i=document.createElement("option");i.setAttribute("value",t[o].Id),i.appendChild(document.createTextNode(t[o].Key)),document.getElementById(C+h+"-"+e.name).appendChild(i)}},"registration",y[v])}),T.$hooks.register("setLocaleBasedInfo",function(e){for(var t in e)if(e.hasOwnProperty(t))switch(t){case"labels":S.extend(T.formCustomLabel,e[t]);break;case"placeholders":S.extend(T.formPlaceholder,e[t]);break;case"validationMessages":T.$hooks.call("mapValidationMessages",e[t]);break;case"errorMessages":T.$hooks.call("mapErrorMessages",e[t]);break;case"passwordMeterConfiguration":T.$hooks.call("passwordMeterConfiguration",e[t]);break;case"buttonsName":T.$hooks.call("setButtonsName",e[t])}})}function SetLoginRadiusCommonFunctions(D){var I=this,h=LoginRadiusDefaults.messages,L=LoginRadiusDefaults.buttonNames,O=new LoginRadiusControllers(D,I);function b(o,i,e,t){var n=D.util.elementById(e+"_tencent"),a=!1,s=("profileeditor"===t&&(a=!0),D.util.elementById(e));D.options.invisibleRecaptcha&&s&&""!==s.innerHTML&&"none"!==s.style.display&&!window.lrpasswordlesslogin&&!window.lrpasswordlessloginotp&&s.closest("form")?window.hcaptcha&&D.options.hCaptchaSiteKey?window.hcaptcha.execute(window[e+"lr_recaptcha_widgets_idprefix"]):window.grecaptcha&&grecaptcha.execute(window[e+"lr_recaptcha_widgets_idprefix"]):n&&"none"!==n.style.display&&(D.options.tencentCaptcha||D.options.tencentCaptchaAsFallback&&!window.grecaptcha&&!window.hcaptcha)?window.onTencentCaptchaSubmitCallback=function(e){var t=D.util.serialize(o,a),t=(t+="&qq_captcha_ticket="+e.ticket)+"&qq_captcha_randstr="+e.randstr;i(t)}:(i(D.util.serialize(o,a)),I.resetGoogleCaptcha(t,e))}function R(e,t,o,i,n){var a="linksignin",s=("passwordlessLoginOTPButtonLabel"===e&&(a="otpsignin"),document.createElement("input")),r=(s.type="submit",D.buttonsName[e.toLowerCase()]||L[e.toLowerCase()]),l=L[e.toLowerCase()];s.value=r,s.id=i+a+"-"+l.toLowerCase().replace(/ /g,"-"),s.setAttribute("class",n+a+" "+a+"-"+i+l.toLowerCase().replace(/ /g,"-")),D.options.disableButtonOnsubmit&&(D.$hooks.register("startProcess",function(e){("otpsignin"===a&&window.lrpasswordlessloginotp||"linksignin"===a&&window.lrpasswordlesslogin)&&(s.disabled=!0)}),D.$hooks.register("xhrEndWithError",function(e){("otpsignin"===a&&window.lrpasswordlessloginotp||"linksignin"===a&&window.lrpasswordlesslogin)&&(s.disabled=!1)}),D.$hooks.register("xhrEndWithSuccess",function(e){("otpsignin"===a&&window.lrpasswordlessloginotp||"linksignin"===a&&window.lrpasswordlesslogin)&&D.options.enableSubmitOnSuccess&&(s.disabled=!1)})),t.appendChild(s),D.util.addEvent("click",o,function(e){window.lrpasswordlessloginotp=!1,window.lrpasswordlesslogin=!1,window.lrpasskeylogin=!1}),"passwordlessLoginOTPButtonLabel"===e?D.util.addEvent("click",s,function(e){window.lrpasswordlessloginotp=!0,window.lrpasswordlesslogin=!1,window.lrpasskeylogin=!1}):D.util.addEvent("click",s,function(e){window.lrpasswordlesslogin=!0,window.lrpasswordlessloginotp=!1,window.lrpasskeylogin=!1})}I.showOTPTemplateForm=function(e){return D.options.templateVerificationTypes&&"OTP"===D.options.templateVerificationTypes[e]},I.addSocialEndpointOptions=function(e){var t=D.util.getQueryParameterByName("scope");return""===D.options.scope&&t&&(D.options.scope=t),-1===(t="&callback="+D.options.callbackUrl+"&same_window="+D.options.callbackInsideSameWindow+"&is_access_token="+D.options.accessTokenResponse+"&callbacktype="+D.options.callbackType+"&disablesignup="+D.options.disableSignup).indexOf("scope")&&(t+="&scope="+D.options.scope),D.options.isMobile&&(t+="&ismobile=true"),e&&(t+="&ac_linking=true"),D.options.isCustomScope&&(t+="&is_custom_scope=true"),D.options.isB2BEnabled&&"orginvite"===D.util.getHashParam("vtype")&&(e=D.util.getHashParam("vtoken"))&&(t+="&invitation_token="+e),t},I.renderCustomInterface=function(e,T,S,k,L,t){function o(e){for(var t,o=e,i=(D.options.providerCountry&&!D.options.providersList&&(o=function(e,t){for(var o=[{Name:"Facebook",country:"global",except:"china"},{Name:"Google",country:"global",except:"china"},{Name:"Yahoo",country:"global",except:"china"},{Name:"Live",country:"global",except:"china"},{Name:"Twitter",country:"global",except:"china"},{Name:"Linkedin",country:"global",except:"china"},{Name:"Myspace",country:"US"},{Name:"Foursquare",country:"global",except:"china"},{Name:"Vkontakte",country:"Russia"},{Name:"Renren",country:"China"},{Name:"QQ",country:"China"},{Name:"Kaixin",country:"China"},{Name:"Github",country:"global",except:"china"},{Name:"Mailru",country:"Russia"},{Name:"Amazon",country:"US"},{Name:"Paypal",country:"global"},{Name:"Salesforce",country:"global"},{Name:"ODNOKLASSNIKI",country:"Russia"},{Name:"WORDPRESS",country:"global"},{Name:"GOOGLEPLUS",country:"global",except:"china"},{Name:"Disqus",country:"global",except:"china"},{Name:"INSTAGRAM",country:"global",except:"china"},{Name:"SINAWEIBO",country:"China"},{Name:"XING",country:"Germany"},{Name:"PINTEREST",country:"global",except:"china"},{Name:"LINE",country:"global"},{Name:"AOL",country:"US"}],i=0;i<o.length;i++)for(var n=0;n<t.length;n++)!t[n]||t[n].Name.toLowerCase()!==o[i].Name.toLowerCase()||o[i].country.toLowerCase()===e.toLowerCase()||"global"===o[i].country.toLowerCase()&&!o[i].except||o[i].except&&o[i].except.toLowerCase()!==e.toLowerCase()||t.splice(n,1);return t}(D.options.providerCountry,o)),D.$hooks.call("socialInterfaceProviders",o),D.options.providersList&&(t=D.options.providersList),D.options.hashTemplate?D.util.hashTmpl:D.util.tmpl),n=S.split(","),a=I.addSocialEndpointOptions(L),s=D.util.getThisObjectName(),r=0;r<n.length;r++){var l=D.util.elementById(n[r]),u=(l&&-1!==l.innerHTML.indexOf("ac_linking")&&(a=a.replace("&ac_linking=true","")),[]);b[r]="";for(var c=0;c<o.length;c++){o[c].ObjectName=s,-1===o[c].Endpoint.indexOf("callback=")&&(o[c].Endpoint+=a);var p={islinked:!1,providerId:!1},p=(T&&T[o[c].Name.toLowerCase()]&&(p.islinked=!0,p.providerId=T[o[c].Name.toLowerCase()]),o[c].isLinked=p.islinked,o[c].providerId=p.providerId,o[c]);u.push(p)}for(var d=[],m=0;m<u.length;m++)u[m].isLinked&&d.push(u[m]);if(0<d.length){for(var g=0;g<u.length;g++)u[g].isLinked||d.push(u[g]);u=d}for(var f=0;f<u.length;f++)""===n[r]||void 0!==t&&-1===t.indexOf(u[f].Name)&&-1===t.indexOf(u[f].Name.toLowerCase())||(u[f].Name=u[f].DisplayName||u[f].Name,b[r]+=i(n[r],u[f]))}for(var h=D.options.selector.split(","),y=0;y<h.length;y++)if(0===(C=h[y]).indexOf(".")){var C=C.replace(".",""),v=D.util.elementsByClass(C);if(v&&0<v.length)for(var w=0;w<v.length;w++)k?v[w].innerHTML+=b[y]:v[w].innerHTML=b[y]}else""!==C&&(C=D.util.elementById(C))&&(k?C.innerHTML+=b[y]:C.innerHTML=b[y])}D.options.selector=e;var b=[];t?o(t):void 0!==D.options.SocialSchema&&o(D.options.SocialSchema.Providers)},I.mapRegistrationSchema=function(e,t,o){var i,n,a,s=D.util.parseQueryString(t),r={},l={},u={},t=[],c=[];for(i in s)if(-1!==i.indexOf("cf_"))r[i.replace("cf_","")]=s[i],delete s[i];else if(-1!==i.indexOf("consent_")){var p={ConsentOptionId:i.replace("consent_",""),IsAccepted:s[i]};c.push(p),delete s[i]}else if("emailsubscription"===i)s.IsEmailSubscribed=!("on"!==s[i]&&"true"!==s[i]),delete s[i];else if("emailid"===i||"email"===i)l.value=s[i],l.type="Primary";else if("SecurityQuestionAnswer"!==i&&-1!==i.indexOf("securityQuestion")){for(var d={},m=0;m<D.options.securityQuestionsCount;m++)s["securityAnswer"+m]&&s["securityQuestion"+m]&&(d[s["securityQuestion"+m]]=s["securityAnswer"+m]),delete s["securityQuestion"+m],delete s["securityAnswer"+m];0!==Object.keys(d).length&&(s.SecurityQuestionAnswer=d)}else"country"===i?u=-1!==s[i].indexOf("|")?{code:s[i].split("|")[0],name:s[i].split("|")[1]}:{code:"",name:s[i]}:(p=D.util.findInSchema(e,"name",i))&&p.Parent&&(n=-1!==i.indexOf("_")?i.split("_")[1]:i,void 0===s[p.Parent]?(s[p.Parent]=[],(a={})[n]=s[i],"Addresses"===p.Parent?a.type="personal":"PhoneNumbers"!==p.Parent||a.phonetype||(a.phonetype="default"),s[p.Parent].push(a)):("Addresses"!==p.Parent||s[p.Parent][0].type||(s[p.Parent][0].type="personal"),s[p.Parent][0][n]=s[i]),delete s[i]);return 0!==Object.keys(r).length&&(s.CustomFields=r),0!==Object.keys(l).length&&(t.push(l),s.email=t),0!==Object.keys(u).length&&(s.country=u),D.options.isPINAuthentication&&D.options.PINConfiguration.AskOnRegistration&&(s=I.sanitizePinData(s)),0<c.length&&(s.Consents={Events:[{Event:"Register",IsCustom:!1}],Data:c}),s},I.showQRCode=function(e,t,o,i,n,a,s){function r(e,t){var o;e&&c.splice(0,0,{type:"image",name:"qrcode",display:"QR Code",rules:"",permission:"r",value:e}),t&&(o=n||LoginRadiusDefaults.classPrefix,c.splice(1,0,{type:"button",name:"ManualEntryCode",display:"Get Manual Entry Code",rules:"",permission:"r",title:"Use this code when you unable to scan QR code. Tap 'Enter a provided key' then enter the email address of your Account and enter this key in your authenticator app",event:"click",eventCallback:function(e){document.getElementsByClassName("content-"+o+"ManualEntryCode")[0].innerHTML=t}}))}var l,u,c=D.QRCodeSchema.slice();D.options.maskSensitiveInput?c[0].type="password":c[0].type="string",e.SecondFactorAuthentication?(l=e.SecondFactorAuthentication.QRCode,u=e.SecondFactorAuthentication.ManualEntryCode,e.SecondFactorAuthentication.IsAuthenticatorVerified||r(l,u)):(l=e.QRCode,u=e.ManualEntryCode,e.IsAuthenticatorVerified||r(l,u)),I.createForm(c,"showQRcode",t,function(e){O.verify2FAOTPController(e,o,i,a,s)},function(e){i(e)},n)},I.showMFASecurityQuestions=function(o,i,n,a,s,r,l){var t="",e=(D.$hooks.register("afterFormRender",function(e,t,o,i){var n;!D.LRCheckLogin&&i&&"loginradius-mfasecurityquestion"===i.name&&(n=D.util.findInSchema(i,"type","submit"),i=D.util.findInSchema(i,"name","setsecurityquestions"),n.style.display=i?"none":"block")}),o&&o.SecurityQuestions&&(t=o.SecurityQuestions,o.haveSecurityQuestionOnProfile=!0),[]);!D.LRCheckLogin&&o.haveSecurityQuestionOnProfile?e.push({type:"button",name:"enablesecurityquestions",display:"Enable Security Questions Authenticator",rules:"",permission:"r",event:"click",eventCallback:function(){O.verifyMFASecurityQuestionsByAccessTokenController("",n,a,!0)}}):e=I.getSecurityQuestionSchema([],!1,t),0<t.length&&o&&!o.IsSecurityQuestionAuthenticatorVerified&&e.push({type:"button",name:"setsecurityquestions",display:"Set Security Questions",rules:"",permission:"r",event:"click",eventCallback:function(e){var t=Object.assign({},o);delete t.SecurityQuestions,LoginRadiusDefaults.innerHTML=!1,e.target.style.display="none",t.haveSecurityQuestionOnProfile=!1,I.showMFASecurityQuestions(t,i,n,a,s,r,l)}}),!(0<e.length)?a([I.setMappedMessage(h.noSecurityQuestions)]):I.createForm(e,"mfasecurityquestion",i,function(e){D.LRCheckLogin?o&&o.IsSecurityQuestionAuthenticatorVerified||t&&0<t.length?O.verifyMFASecurityQuestionsController(e,n,a,r,l):O.submitMFASecurityQuestionsController(e,n,a,r,l):O.verifyMFASecurityQuestionsByAccessTokenController(e,n,a,o.haveSecurityQuestionOnProfile,t)},function(e){a(e)},s)},I.disableMFAOptions=function(e,o,t){var i,n=D.storage.getBrowserStorage(LoginRadiusDefaults.storedGAAuth),a=D.storage.getBrowserStorage(LoginRadiusDefaults.storedOTPAuth),s={authenticator:{field:n,name:"authenticatorcode",defaultKey:"storedGAAuth"},emailotpauthenticator:{field:D.storage.getBrowserStorage(LoginRadiusDefaults.storedEmailOTPAuth),name:"Email authenticator",defaultKey:"storedEmailOTPAuth"},otpauthenticator:{field:a,name:"OTP authenticator",defaultKey:"storedOTPAuth"},sqauthenticator:{field:D.storage.getBrowserStorage(LoginRadiusDefaults.storedSQAuth),name:"Security Questions authenticator",defaultKey:"storedSQAuth"},pushnotificationauthenticator:{field:D.storage.getBrowserStorage(LoginRadiusDefaults.storedPushNotificationAuth),name:"Push Notification authenticator",defaultKey:"storedPushNotificationAuth"},duoauthenticator:{field:D.storage.getBrowserStorage(LoginRadiusDefaults.storedDuoAuth),name:"Duo Security authenticator",defaultKey:"storedDuoAuth"},passkeyauthenticator:{field:D.storage.getBrowserStorage(LoginRadiusDefaults.storedPasskeyAuth),name:"Passkey authenticator",defaultKey:"storedPasskeyAuth"}},r=e.emailotpauthenticator,l=0;for(i in s)i===e?r=s[i]:"false"!==s[i].field&&l++;D.options.twoFactorAuthentication?"false"===r.field?t([{Message:r.name+"has already disabled."}]):0<l?O.resetTwoFactorAuthenticationController(e,function(e,t){D.storage.setBrowserStorage(LoginRadiusDefaults[r.defaultKey],!1),o(e,t)},t):0===l&&t([{Message:"TwoFactorAuthentication is required, So atleast one authenticator should be required."}]):O.resetTwoFactorAuthenticationController(e,o,t)};var s=!(I.getSecurityQuestionSchema=function(e,t,o){var i=[],n=D.options.SecurityQuestions,a=D.options.securityQuestionsCount;if(o&&(a=(n=o).length),n){var s=[],r=[],l=function(e){for(var t=new RegExp("securityQuestion"),o=e.target.id.split("securityQuestion")[1],i=(r[o]=e.target.selectedIndex,D.util.findElementByRegex("id",t,"select")),n=0;n<i.length;n++)for(var a=1;a<i[n].options.length;a++)-1<r.indexOf(i[n].options[a].index)&&i[n].options[a].index!==i[n].options.selectedIndex?i[n].options[a].style.display="none":i[n].options[a].style.display="block"};if(!o)for(var u=0;u<n.length;u++){var c={};c.text=n[u].Question,c.value=n[u].QuestionId,s.push(c),r.push(0)}for(var p=0;p<a;p++){var d={},d=(o?(d.type="html",d.name="securityQuestion"+p,d.html=n[p].Question):(d.type="option",d.options=s,d.name="securityQuestion"+p,d.display="Security Question",d.event="change",d.eventCallback=l),d.rules=t?"optional":"required",d.permission="r",(t?e:i).push(d),{});D.options.maskSensitiveInput?d.type="password":d.type="string",d.name=o?n[p].QuestionId:"securityAnswer"+p,d.display="Answer",d.rules=t?"optional":"required",d.permission="r",(t?e:i).push(d)}}return i});function P(e,t){return"changepassword"===(e=e.toLowerCase())&&t.PutChangePassword||("profileeditor"===e||"loginRequiredFieldsUpdate"===e||"progressiveProfiling"===e||"socialRegistration"===e)&&t.PutUpdateProfile||"forgotpassword"===e&&(D.options.phoneLogin&&t.PostForgotPasswordByPhone&&t.PostForgotPasswordByEmail||!D.options.phoneLogin&&t.PostForgotPasswordByEmail)||"login"===e&&(D.options.usernameLogin&&t.PostLoginByUserNameAndPassword&&D.options.phoneLogin&&t.PostLoginByEmailAndPassword&&t.PostLoginByPhoneAndPassword||D.options.phoneLogin&&t.PostLoginByEmailAndPassword&&t.PostLoginByPhoneAndPassword||!D.options.phoneLogin&&D.options.usernameLogin&&t.PostLoginByUserNameAndPassword||!D.options.usernameLogin&&!D.options.phoneLogin&&t.PostLoginByEmailAndPassword)}I.socialLogin=function(o,i,n,a){window.html5passToken=function(e){var t;s||(s=!0,o=LoginRadiusDefaults.socialRegFormId||o,(t=D.storage.getBrowserStorage("LRSetSafariToken"))&&(D.$hooks.call("getCurrentActionOptions",t),i=window.LRSafarionSuccess||i,n=window.LRSafarionError||n),O.socialLoginReceiveToken(e,o,i,n,a))};var e=D.util.getHashParam("lr-token");e&&window.html5passToken(e),D.loginRadiusHtml5PassToken=window.html5passToken,D.options.isMobile||D.options.noCallbackForSocialLogin?D.$hooks.register("socialCalls",function(e,t){D.currentLRContainer=o,D.options.noCallbackForSocialLogin&&I.pingForSocialLogin(t,function(e){e.access_token?O.socialLoginReceiveToken(e.access_token,o,i,n,a):i(e)},function(){})}):D.util.addEvent("message",window,function(e){-1===e.origin.indexOf(D.options.customDomain)&&-1===e.origin.indexOf(LoginRadiusDefaults.hubDomain)||(o=LoginRadiusDefaults.socialRegFormId||o,"string"==typeof e.data&&(LoginRadiusDefaults._uuidFormat.test(e.data)||D.util.isJWT(e.data))&&O.socialLoginReceiveToken(e.data,o,i,n,a))})},I.resetPassKey=function(t,o,i,n){var e;D.options.isPassKeysEnabled?null==D.util.getHashParam("vtype")?(e=D.forgotPassKeyFormSchema,I.createForm(e,"forgotPassKey",t,function(e){O.forgotPassKeyController(e,t,o,i,n)},function(e){i(e)},n)):(e=D.util.getHashParam("vtoken"))?O.resetPassKeyController(e,t,o,i,n):i([{Message:"Verification Token not found in query string."}]):D.log("please enable pass key from admin console")},I.resetPassword=function(i,n,a,s,o){var r,t,l,e,u,c,p=D.resetPasswordFormSchema.slice();null==D.util.getHashParam("vtype")?(p=D.resetPasswordByPhoneSchema.slice(),I.setPasswordRule(D.util.findInSchema(p,"name","password")),o?(o.email?(e="email",u=o.email):o.username&&(e="username",u=o.username),p.push({type:"hidden",name:e,value:u})):D.options.phoneLogin&&(l="&"+LoginRadiusDefaults.LRPhoneNo,D.util.findInSchema(p,"name","resendotp")||(D.LRPrefix=s+"##"+LoginRadiusDefaults.idPrefix,r=D.LRPrefix.replace("##","")+"recaptcha_widget_resetpassword",t=function(e,o){function t(e){var t={};"string"==typeof e?t.success=e:t=e,t.error?a([I.setMappedMessage(t.error)]):("string"==typeof LoginRadiusDefaults.LRPhoneNo&&(LoginRadiusDefaults.LRPhoneNo=D.util.parseQueryString(LoginRadiusDefaults.LRPhoneNo)),-1!==LoginRadiusDefaults.LRPhoneNo["g-recaptcha-response"]&&(LoginRadiusDefaults.LRPhoneNo["g-recaptcha-response"]=t.success,window.grecaptcha)&&grecaptcha.reset(window[r+"lr_recaptcha_widgets_idprefix"]),-1!==LoginRadiusDefaults.LRPhoneNo["h-captcha-response"]&&(LoginRadiusDefaults.LRPhoneNo["h-captcha-response"]=t.success,window.hcaptcha)&&D.options.hCaptchaSiteKey&&window.hcaptcha.reset(window[r+"lr_recaptcha_widgets_idprefix"]),O.forgotPasswordbyPhoneController(LoginRadiusDefaults.LRPhoneNo,i,n,a,s,o,function(){}))}D.options.disableResendOTPButton&&D.util.disableResendOTPButton(e),(e=D.options.optionalRecaptchaConfiguration)&&e.IsEnabled&&e.Apis&&P("forgotpassword",e.Apis)?(window.onCaptchaSubmit=t,D.$hooks.call("addFormCaptchaExecute",r,!0,t)):O.forgotPasswordbyPhoneController(LoginRadiusDefaults.LRPhoneNo,i,n,a,s,o,function(){})},e=Object.assign({},D.btnOTPSchema,{name:"resendotp",display:"Resend via SMS",eventCallback:function(e){t(e,!1)}}),p.push(e),D.options.isVoiceOtp&&(u=Object.assign({},D.btnOTPSchema,{name:"resendvoiceotp",display:"Resend via Voice call",eventCallback:function(e){t(e,!0)}}),p.push(u))))):(I.setPasswordRule(D.util.findInSchema(p,"name","password")),I.setPasswordRule(D.util.findInSchema(p,"name","confirmpassword")),(e=D.util.getHashParam("vtoken"))?D.options.verifyEmailByOTP?(u=D.util.getQueryParameterByName("email"),c="&otp="+e,c+="&email="+encodeURIComponent(u.replace(/ /g,"+")),p.splice(2,1)):D.resetPasswordFormSchema[2].value=e:a([{Message:"Verification Token not found in query string."}])),I.createForm(p,"resetpassword",i,function(e){var t;-1===e.indexOf("otp")||o?(c&&(e+=c),O.resetPasswordController(e,n,a,i,s)):(t=D.util.parseQueryString(l),O.resetPasswordByPhoneController(e+"&phone="+t.phone,n,a,i,s))},function(e){a(e)},s,"forgotpassword")},I.resetPIN=function(t,o,i,n,a){var s,e,r,l,u=D.resetPINFormSchema.slice();null==D.util.getHashParam("vtype")?(u=D.resetPINByPhoneSchema.slice(),I.setPINRule(D.util.findInSchema(u,"name","pin")),a?(a.email?(e="email",r=a.email):a.username&&(e="username",r=a.username),u.push({type:"hidden",name:e,value:r})):D.options.phoneLogin&&(s="&"+LoginRadiusDefaults.LRPhoneNo,D.util.findInSchema(u,"name","resendotp")||(e=Object.assign({},D.btnOTPSchema,{name:"resendotp",display:"Resend via SMS",eventCallback:function(e){D.options.disableResendOTPButton&&D.util.disableResendOTPButton(e),O.forgotPINbyPhoneController(LoginRadiusDefaults.LRPhoneNo,t,o,i,n,!1,function(){})}}),u.push(e),D.options.isVoiceOtp&&(r=Object.assign({},D.btnOTPSchema,{name:"resendvoiceotp",display:"Resend via Voice call",eventCallback:function(e){D.options.disableResendOTPButton&&D.util.disableResendOTPButton(e),O.forgotPINbyPhoneController(LoginRadiusDefaults.LRPhoneNo,t,o,i,n,!0,function(){})}}),u.push(r))))):(I.setPINRule(D.util.findInSchema(u,"name","pin")),I.setPINRule(D.util.findInSchema(u,"name","confirmpin")),(e=D.util.getHashParam("vtoken"))?D.options.verifyEmailByOTP?(r=D.util.getQueryParameterByName("email"),l="&otp="+e,l+="&email="+encodeURIComponent(r.replace(/ /g,"+")),u.splice(2,1)):D.resetPINFormSchema[2].value=e:i([{Message:"Verification Token not found in query string."}])),I.createForm(u,"resetpin",t,function(e){-1===e.indexOf("otp")||a?(l&&(e+=l),O.resetPINController(e,o,i,t,n)):O.resetPINByPhoneController(e+s,o,i,t,n)},function(e){i(e)},n)},I.setPasswordRule=function(e,t){D.options.passwordLength=D.options.passwordlength||D.options.passwordLength;var o,i=D.util.findInSchema(D.options.RegistrationFormSchema,"name","password").rules;e&&e.rules&&((o=new RegExp(/matches\[\w*\]/).exec(e.rules))?(o=o[0],e.rules=[i,o].join("|")):e.rules=i,D.options.passwordLength)&&D.options.passwordLength.min&&D.options.passwordLength.max&&(e.rules=e.rules||"",e.rules=e.rules.replace("min_length[6]","min_length["+D.options.passwordLength.min+"]").replace("max_length[32]","max_length["+D.options.passwordLength.max+"]")),(t=t||!1)&&e&&(e.rules="required")},I.setPINRule=function(e){var t,o;D.pinSchema&&D.pinSchema.length&&(t=D.pinSchema[0].rules,e)&&e.rules&&((o=new RegExp(/matches\[\w*\]/).exec(e.rules))?(o=o[0],e.rules=[t,o].join("|")):e.rules=t,D.options.PINConfiguration.IsRequired)&&-1===e.rules.indexOf("required")&&(e.rules=e.rules?[e.rules,"required"].join("|"):"required")},I.changeNumberForm=function(t,e,o,i,n,a,s,r){var l=D.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),u=D.util.getButtonAttribute("changenumber",n),c=D.util.getButtonAttribute("disableotpauthenticator",n),p=D.storage.getBrowserStorage(LoginRadiusDefaults.storedGAAuth),d=D.storage.getBrowserStorage(LoginRadiusDefaults.storedDuoAuth),m=D.storage.getBrowserStorage(LoginRadiusDefaults.storedSQAuth),g=D.storage.getBrowserStorage(LoginRadiusDefaults.storedEmailOTPAuth),f=D.storage.getBrowserStorage(LoginRadiusDefaults.storedPushNotificationAuth),g="false"!==g||"false"!==p||"false"!==m||"false"!==d||"false"!==f;e?(e.appendChild(u),l&&!D.LRCheckLogin&&(D.options.optionalTwoFactorAuthentication||g&&D.options.twoFactorAuthentication)&&e.appendChild(c)):(D.util.addHTMLContent(t,u,a),l&&!D.LRCheckLogin&&(D.options.optionalTwoFactorAuthentication||g&&D.options.twoFactorAuthentication)&&D.util.addHTMLContent(t,c,!0)),D.util.addEvent("click",c,function(e){I.disableMFAOptions("otpauthenticator",o,i)}),D.util.addEvent("click",u,function(e){document.getElementsByName(n+"changePhone")[0]||(LoginRadiusDefaults.innerHTML=!1,I.updatePhoneNumber(t,o,i,n,"changePhone",s,r))})},I.validateAndCall=function(e){LoginRadiusDefaults.isSSOInitFired?D.options.appName?e():D.log("LoginRadius site name (app name) required to do SSO"):D.log("Init method should be called first then login.")},I.logout=function(i){I.validateAndCall(function(){var e=D.options.tokenExpire?"?tokenExpire=1":"",t=D.options.tokenExpire?"tokenExpire":"logout",o=D.options.customDomain||D.options.appName+"."+LoginRadiusDefaults.hubDomain;D.util.ajaxCall("get","https://"+o+"/ssologin/"+t+e,"",function(e){LRNameSpace.cookies.removeItem(LoginRadiusDefaults.tokenCookie,D.options.appPath),D.clearSession(),i&&i()})})},I.otpEmailVerification=function(t,o,i,n,a){var e=D.otpSchema;I.createForm(e,"otp",t,function(e){"string"!=typeof(e="string"!=typeof a?(e=D.util.parseQueryString(e),D.util.mergeOptions(a,e)):a+"&"+e)&&e.onetouchlogin?O.oneTouchLoginEmailVerification(e.otp,o,i,e.email):O.emailVerificationController(e,o,i,t,n,!0)},function(e){i(e)},n)},I.passwordlessLoginVerification=function(e,t,o,i,n){var a,s,r;e&&(a="get",s="",r=LoginRadiusDefaults.apiDomain+"/auth/login/passwordlesslogin/email/verify?apiKey="+D.options.apiKey+"&verificationtoken="+e+"&welcomeEmailTemplate="+D.options.welcomeEmailTemplate,n&&((s="string"==typeof e?D.util.parseQueryString(e):{email:(n=D.util.getQueryParameterByName("email"))?n.replace(/ /g,"+"):"",otp:e}).welcomeemailtemplate=D.options.welcomeEmailTemplate,a="post",n=s.username?"username":"email",r=LoginRadiusDefaults.apiDomain+"/auth/login/passwordlesslogin/"+n+"/verifyotp?apiKey="+D.options.apiKey),D.util.ajaxCall(a,r,s,function(e){e.ErrorCode?o(I.loginRadiusErrorTojsError(e)):I.loginHandleToken(e,"",t,o,i)},"passwordlessLogin##otp"))},I.loginHandleToken=function(e,t,o,i,n,a){var s,r,l,u,c,p,d,m,g,f;LoginRadiusDefaults.lrResponseCounter=0,LoginRadiusDefaults.lrCounterJwtResponse="",LoginRadiusDefaults.lrCounterTokenResponse="",e&&(e.ErrorCode?i(I.loginRadiusErrorTojsError(e)):(e.Data&&e.Data.hasOwnProperty("Profile")&&(delete(e=e.Data).Data,delete e.IsPosted),D.options.privacyPolicyConfiguration.IsEnabled&&e.Profile&&(p=!1,e.Profile.PrivacyPolicy&&e.Profile.PrivacyPolicy.Version&&(p=I.checkForLatestPrivacyPolicy(e.Profile)),e.Profile=Object.assign({},e.Profile,{IsLatestPrivacyPolicy:p})),s=function(){D.LoginRadiusHostedPage&&e.access_token&&LRNameSpace.cookies.setItem("lr-session-token",e.access_token),LoginRadiusDefaults.lrResponseCounter++,LoginRadiusDefaults.lrCounterTokenResponse=e,D.options.tokenType&&"jwt"===D.options.tokenType.toLowerCase()?2===LoginRadiusDefaults.lrResponseCounter&&LoginRadiusDefaults.lrCounterJwtResponse&&LoginRadiusDefaults.lrCounterJwtResponse.signature&&(e.jwttoken=LoginRadiusDefaults.lrCounterJwtResponse.signature,null!=t&&""!==t?o(e,D.util.parseQueryString(t)):o(e)):null!=t&&""!==t?o(e,D.util.parseQueryString(t)):o(e)},p=D.storage.getBrowserStorage("LRSetSafariToken"),D.storage.removeBrowserStorage("LRSetSafariToken"),D.setHostedToken||p?o(e):(p=D.registrationFormSchema&&0<D.registrationFormSchema.length?D.registrationFormSchema:D.options.RegistrationFormSchema,p=(p=D.util.findInSchema(p,"name","phoneid"))&&-1!==p.rules.indexOf("required")&&D.options.phoneLogin,r=e.Profile||e.Data,u=!(D.options.disabledEmailVerification||D.options.optionalEmailVerification),r&&!r.EmailVerified&&u&&!a?i([I.setMappedMessage(h.emailNotVerified)]):p&&r&&!r.PhoneIdVerified&&!a?r.PhoneId?(u={phone:r.PhoneId},l=D.currentLRContainer,O.resendOTPController(u,function(){I.verifyOTP("phone="+r.PhoneId,l,o,i,n),I.resendOTP("phone="+r.PhoneId+"&noPhoneVerified=false",l,o,i,n),D.options.isVoiceOtp&&I.resendOTP("phone="+r.PhoneId+"&noPhoneVerified=false",l,o,i,n,!0)},i,n)):D.log("Phone ID is required field."):(r&&r.Uid&&D.storage.setBrowserStorage(LoginRadiusDefaults.storedUidName,r.Uid),D.storage.setBrowserStorage(LoginRadiusDefaults.storedTokenName,e.access_token),D.options.isPINAuthentication&&D.options.PINConfiguration.PINLogin&&e&&e.session_token&&D.setSessionToken(e),LoginRadiusDefaults.isSSOInitFired&&e.access_token?(I.setToken(e.access_token),a=!!(-1===(p=navigator.userAgent.toLowerCase()).indexOf("crios")&&-1===p.indexOf("chrome")&&0<=p.indexOf("safari")),u=/ipad|iphone|ipod/.test(p)&&!window.MSStream,c=0<=p.indexOf("ucbrowser"),p=/crios/i.test(p),d=D.options.customDomain||D.options.appName+"."+LoginRadiusDefaults.hubDomain,g=D.util.getQueryParameterByName("vtype"),f=D.util.getQueryParameterByName("vtoken"),m=window.location.href,g&&(m=m.replace("?vtype="+g,"").replace("&vtype="+g,"")),f&&(m=m.replace("&vtoken="+f,"").replace("?vtoken="+f,"")),m=encodeURIComponent(m),a||u&&c||u&&p?(D.options.askRequiredFieldForTraditionalLogin||D.storage.setBrowserStorage("LRTraditionalLogin",!0),D.$hooks.call("setCurrentAction"),D.options.stayLogin?(g=D.storage.getBrowserStorage("lr-rememberme"),D.storage.removeBrowserStorage("lr-rememberme"),window.location="https://"+d+"/ssologin/setCustomSafariToken?token="+e.access_token+"&apiKey="+D.options.apiKey+"&isrememberMe="+g+"&callback="+m):window.location="https://"+d+"/ssologin/setSafariToken?token="+e.access_token+"&apiKey="+D.options.apiKey+"&callback="+m):(f="",a="setToken",D.options.stayLogin&&(f="&isrememberMe="+D.storage.getBrowserStorage("lr-rememberme"),D.storage.removeBrowserStorage("lr-rememberme"),a="setCustomToken"),D.util.ajaxCall("get","https://"+d+"/ssologin/"+a+"?access_token="+e.access_token+"&apiKey="+D.options.apiKey+f,"",function(){s()},"setToken"))):s(),D.options.tokenType&&"jwt"===D.options.tokenType.toLowerCase()&&I.getJwtToken(e.access_token,o,i)))))},I.getJwtToken=function(e,t,o){D.util.ajaxCall("get",LoginRadiusDefaults.cloudApiDomain+"sso/jwt/api/token?apikey="+D.options.apiKey+"&jwtapp="+D.options.integrationName+"&access_token="+e,"",function(e){LoginRadiusDefaults.lrResponseCounter++,LoginRadiusDefaults.lrCounterJwtResponse=e,2===LoginRadiusDefaults.lrResponseCounter&&(e.ErrorCode?o(e):(LoginRadiusDefaults.lrCounterTokenResponse.jwttoken=e.signature,t(LoginRadiusDefaults.lrCounterTokenResponse)))},"JWTToken")},I.mapSchema=function(t,e,o,i){e=D.util.keysToLowerCase(e);var n=[];Object.keys(t).forEach(function(e){n.push(t[e])});for(var a,s,r=0;r<t.length;r++)null!=t[r]&&("emailid"===t[r].name.toLowerCase()&&e.email&&e.email[0]&&e.email[0].value&&""!==e.email[0].value?e.emailverified||(D.options.disabledEmailVerification||D.options.optionalEmailVerification)&&!D.options.askEmailForUnverifiedProfileAlways?(n[r].value=e.email[0].value,t[r]=null):D.options.askEmailForUnverifiedProfileAlways&&!D.setHostedToken||(n[r]=t[r]=null):"country"===t[r].name.toLowerCase()&&""===t[r].Parent&&e.country&&null!=e.country.name&&""!==e.country.name&&"unknown"!==e.country.name.toLowerCase()?(n[r].value=e.country.name,e.country.code&&(n[r].value=e.country.code+"|"+n[r].value),t[r]=null):"emailsubscription"===t[r].name.toLowerCase()&&e.isemailsubscribed&&""!==e.isemailsubscribed?(n[r].value=e.isemailsubscribed,t[r]=null):"phoneid"===t[r].name.toLowerCase()&&e.phoneid&&""!==e.phoneid?(n[r].value=e.phoneid.replace("+",""),t[r]=null):"birthdate"===t[r].name.toLowerCase()&&e.birthdate&&""!==e.birthdate?(a=e.birthdate.replace("-","/").replace("-","/").split("/"))[2]&&""!==a[2]&&(n[r].value=e.birthdate,t[r]=null):"password"===t[r].name.toLowerCase()||"confirmpassword"===t[r].name.toLowerCase()?null==e.password&&(D.options.promptPasswordOnSocialLogin||D.options.promptPasswordOnFirstLoginForSocial)||(n[r]=t[r]=null):"pin"===t[r].name.toLowerCase()||"confirmpin"===t[r].name.toLowerCase()?(e.pin&&e.pin.pin||!D.options.isPINAuthentication)&&(n[r]=t[r]=null):""!==t[r].Parent&&void 0!==t[r].Parent&&null!==t[r].Parent?t[r].Parent&&e[t[r].Parent.toLowerCase()]&&void 0!==e[t[r].Parent.toLowerCase()]&&(a=-1!==t[r].name.indexOf("_")?t[r].name.split("_")[1]:t[r].name,s=Object.keys(e[t[r].Parent.toLowerCase()]).length-1,"object"==typeof e[t[r].Parent.toLowerCase()]&&e[t[r].Parent.toLowerCase()][s]&&e[t[r].Parent.toLowerCase()][s][a.toLowerCase()]?null!=e[t[r].Parent.toLowerCase()][s][a.toLowerCase()]&&void 0!==e[t[r].Parent.toLowerCase()][s][a.toLowerCase()]&&"unknown"!==e[t[r].Parent.toLowerCase()][s][a.toLowerCase()]&&(n[r].value=e[t[r].Parent.toLowerCase()][s][a.toLowerCase()],t[r]=null):(n[r].value=e[t[r].Parent.toLowerCase()][t[r].name.toLowerCase()],t[r]=null)):0===t[r].name.indexOf("cf_")&&e.customfields&&e.customfields[t[r].name.replace("cf_","").toLowerCase()]?(n[r].value=e.customfields[t[r].name.replace("cf_","").toLowerCase()],t[r]=null):t[r].name&&"object"!=typeof e[t[r].name.toLowerCase()]&&null!=e[t[r].name.toLowerCase()]&&""!==e[t[r].name.toLowerCase()]&&void 0!==e[t[r].name.toLowerCase()]&&"unknown"!==e[t[r].name.toLowerCase()]&&(n[r].value=e[t[r].name.toLowerCase()],t[r]=null));if(t=t.filter(function(e){return e}),o&&"profileeditor"===o&&!e.ErrorCode)return n=n.filter(function(e){return e});for(var l=0;l<t.length;l++)if(null!=t[l].rules&&""!==t[l].rules&&-1<t[l].rules.indexOf("required")||D.options.askOptionalFieldsOnRegistration&&!0===e.firstlogin&&"email"!==e.registrationprovider.toLowerCase()||D.options.askOptionalFieldsOnProgressiveSteps&&i||D.askPinOnLogin)return o&&!e.ErrorCode?n=n.filter(function(e){return e}):t;return[]},I.loginRadiusErrorTojsError=function(e){var t=[];return t.push(I.setMappedMessage(e)),t},I.setMappedMessage=function(e){for(var t=0;t<D.errorMessages.length;t++)D.errorMessages[t].code==e.ErrorCode&&(e.Message=D.errorMessages[t].message||e.Message,e.Description=D.errorMessages[t].description||e.Description);return e},I.setCustomLabel=function(e){for(var t=0;t<e.length;t++)e[t]&&D.formCustomLabel[e[t].name]&&(e[t].display=D.formCustomLabel[e[t].name])},I.setCustomTitle=function(e){for(var t=0;t<e.length;t++)e[t]&&D.formElementsTitle[e[t].name]&&(e[t].title=D.formElementsTitle[e[t].name])},I.setPlaceholder=function(e){for(var t=0;t<e.length;t++)e[t]&&D.formPlaceholder[e[t].name]&&(e[t].placeholder=D.formPlaceholder[e[t].name])},I.setValidation=function(e){D.formValidations[e.name]&&(e.rules=D.formValidations[e.name])},I.setAttribute=function(e,t){if(D.formElementAttributes[e.name])for(var o=D.formElementAttributes[e.name].split("&"),i=0;i<o.length;i++){var n=(a=o[i].split("=")).splice(0,1),a=a.join("=");t.setAttribute(n,a)}},I.verifyOTP=function(o,e,i,n,t,a,s){var r,l=!1,u="otp",c="",p=(D.LRCheck2FA&&(D.options.twoFactorAuthentication||D.options.optionalTwoFactorAuthentication)&&!D.LRCheckRegistration&&(l=!0,u="twofaotp"),D.otpSchema);o.mfaEmailToken&&o.EmailId?(c=o.EmailId,u="twofaemailotp",LoginRadiusDefaults.innerHTML=!1,(r=D.util.findInSchema(p,"name","emailid"))?r.value=o.EmailId:p.push({type:"hidden",name:"emailid",value:o.EmailId})):((r=o)&&"string"==typeof o&&(r=JSON.parse(JSON.stringify(o)),r=D.util.parseQueryString(r)),c=r.phone||r.phoneid||r.phoneId||r.phoneNo2FA||""),c&&p&&p[0]&&"otp"===p[0].name&&D.$hooks.register("afterFormRender",function(e,t,o,i){i&&i.name==="loginradius-"+u&&i[0].name===p[0].name&&i[0].labels&&i[0].labels[0].innerText&&-1!==i[0].labels[0].innerText.indexOf("%value")&&(i[0].labels[0].innerText=i[0].labels[0].innerText.replace("%value",c))}),I.createForm(p,u,e,function(e){var t;l||o.phoneNo2FA?(o.mfaEmailToken&&"string"==typeof e&&(e+="&mfaEmailToken=true"),O.verify2FAOTPController(e,i,n,a,s)):(("string"==typeof o||o instanceof String)&&(o=D.util.parseQueryString(o)),e=D.util.parseQueryString(e),o.phone?t={phone:o.phone}:(o.phoneid||o.phoneId)&&(t={phone:o.phoneid||o.phoneId}),o.onetouchloginflag&&(e.onetouchloginflag=!0),o.haveToken&&(e.haveToken=!0),O.verifyOTPController(e,t,i,n,a,s))},function(e){n(e)},t)},I.resendOTP=function(e,t,i,n,o,a,s,r,l){function u(t,o){if(c.isVoice=o,window.onCaptchaSubmit=v,D.options.disableResendOTPButton&&D.util.disableResendOTPButton(t),D.options.isCaptchaEnabled&&!m)D.$hooks.call("addFormCaptchaExecute",p,!0,v);else if(l){if((t=D.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName))&&I.isValidToken(t,n)){let e=LoginRadiusDefaults.apiDomain+"/auth/phone?apiKey="+D.options.apiKey+"&access_token="+t+"&smsTemplate="+D.options.smsTemplateUpdatePhone;o&&(e+="&isvoiceotp=true"),D.util.ajaxCall("put",e,c,function(e){e.ErrorCode&&n(I.loginRadiusErrorTojsError(e))},"updatePhone")}}else m&&I.resendOTPManually(c,i,n,y,o)}var c={},p=LoginRadiusDefaults.idPrefix+"recaptcha_widget_otp",d=!0,m=!0,g=((e="string"==typeof e||e instanceof String?D.util.parseQueryString(e):e).noPhoneVerified&&(d=!1),!0),f=(e.phoneid||e.phoneId?(g=!1,c={phone:e.phoneid||e.phoneId}):e.phone?(D.socialLoginFlag||(g=!1),c=e):e.phoneNo2FA||e.phoneno2fa?c={phoneno2fa:e.phoneNo2FA||e.phoneno2fa}:e.SecondFactorAuthentication&&e.SecondFactorAuthentication.OTPPhoneNo&&(c={phoneno2fa:e.SecondFactorAuthentication.OTPPhoneNo}),null),h=D.util.getButtonAttribute("resendotp",o),y=(a&&(f=D.util.getButtonAttribute("resendvoiceotp",o)),o||LoginRadiusDefaults.classPrefix),o=g?"twofaotp":"otp",C=document.getElementsByName(y+o)[0],v=((C=C||document.getElementsByName(y+("twofaotp"==o?"otp":"twofaotp"))[0])&&((o=D.util.findInSchema(C,"type","submit"))?(a&&o.parentNode.insertBefore(f,o.nextSibling),o.parentNode.insertBefore(h,o.nextSibling)):(a&&C.appendChild(f),C.appendChild(h))),!D.LRCheckLogin||!g||d&&"false"!==D.storage.getBrowserStorage(LoginRadiusDefaults.storedOTPAuth)||I.changeNumberForm(t,C,i,n,y,"",s,r),function(){});e.onetouchloginflag&&(m=!1,c.onetouchloginflag=!0,v=function(e){var t={};"string"==typeof e?t.success=e:t=e,t.error?n(t.error):(window.grecaptcha&&(c["g-recaptcha-response"]=t.success,grecaptcha.reset(window[p+"lr_recaptcha_widgets_idprefix"])),window.hcaptcha&&D.options.hCaptchaSiteKey&&(c["h-captcha-response"]=t.success,window.hcaptcha.reset(window[p+"lr_recaptcha_widgets_idprefix"])),I.resendOTPManually(c,i,n,y,c.isVoice))},D.$hooks.call("addFormCaptcha",D.currentLRContainer,"","",p)),e.updatePhone&&(c.updatePhone=!0),f&&D.util.addEvent("click",f,function(e){u(e,!0)}),D.util.addEvent("click",h,function(e){u(e,!1)})},I.sendInstantSignInLink=function(t,o,i,e,n){if(t=(t=D.util.parseQueryString(t)).emailid||t.email,LoginRadiusDefaults.regexExpression.emailRegex.test(t)||D.options.usernameLogin||D.options.duplicateEmailWithUniqueUsername){LoginRadiusDefaults.regexExpression.emailRegex.test(t)?a="email="+encodeURIComponent(t.replace(/ /g,"+")):(D.options.usernameLogin||D.options.duplicateEmailWithUniqueUsername)&&(a="username="+t),a+="&oneClickSignIn=true";var a,t=D.options.instantLinkLoginEmailTemplate||D.options.passwordlessLoginEmailTemplate;let e=LoginRadiusDefaults.apiDomain+"/auth/login/passwordlesslogin/email?apiKey="+D.options.apiKey+"&verificationUrl="+D.options.verificationUrl+"&passwordlesslogintemplate="+t+"&"+a;D.options.isB2BEnabled&&"orginvite"===D.util.getHashParam("vtype")&&(t=D.util.getHashParam("vtoken"))&&(e+="&invitation_token="+t),D.util.ajaxCall("GET",e,"",function(e){window.lrpasswordlessloginotp=!1,window.lrpasswordlesslogin=!1,e.ErrorCode?i(I.loginRadiusErrorTojsError(e)):o(e,a)},"passwordlessLogin")}else i([I.setMappedMessage(h.invalidEmail)])},I.sendInstantSignInOtp=function(e,i,n,o,a){var s,r,e=(e=D.util.parseQueryString(e)).emailid||e.email;LoginRadiusDefaults.regexExpression.phoneRegex.test(e)?(r=D.options.smsTemplateInstantOTPLogin||D.options.passwordlessLoginSMSTemplate,D.util.ajaxCall("GET",LoginRadiusDefaults.apiDomain+"/auth/login/passwordlesslogin/otp?apiKey="+D.options.apiKey+"&"+(s="phone="+e)+"&smsTemplate="+r,"",function(e){window.lrpasswordlessloginotp=!1,window.lrpasswordlesslogin=!1,e.ErrorCode?n(I.loginRadiusErrorTojsError(e)):(i(e),e.Data&&e.Data.Sid&&(D.$hooks.register("beforeFormRender",function(e,t){var o;D.util.findInSchema(t,"name","resendotp")||(o=Object.assign({},D.btnOTPSchema,{name:"resendotp",display:"Resend via SMS",eventCallback:function(e){D.options.disableResendOTPButton&&D.util.disableResendOTPButton(e),I.resendOTPHandler({data:s,onsuccess:i,onerror:n,smstemplate:r,action:"sendInstantSignInResendOtp"})}}),t.push(o),D.options.isVoiceOtp&&(o=Object.assign({},D.btnOTPSchema,{name:"resendvoiceotp",display:"Resend via Voice call",eventCallback:function(e){D.options.disableResendOTPButton&&D.util.disableResendOTPButton(e),I.resendOTPHandler({data:s,onsuccess:i,onerror:n,smstemplate:r,voiceotp:!0,action:"sendInstantSignInResendOtp"})}}),t.push(o)))}),e=D.otpSchema,I.createForm(e,"otp",o,function(e){var t=a+LoginRadiusDefaults.idPrefix+"recaptcha_widget_verifyotp";O.verifyInstantOTP(e,D.util.parseQueryString(s),i,n,t,o,a)},function(e){n(I.setMappedMessage(e))},a)))},"passwordlessLogin")):n([I.setMappedMessage(h.invalidPhone)])},I.resendOTPManually=function(e,t,o,i,n){var a;D.LRCheck2FA&&(D.options.twoFactorAuthentication||D.options.optionalTwoFactorAuthentication)&&!D.LRCheckRegistration?"false"===D.storage.getBrowserStorage(LoginRadiusDefaults.storedOTPAuth)?(a={data:e,onsuccess:t,onerror:o,smstemplate:D.options.smsTemplate2FA,voiceotp:n,action:"update2FANumberResendOTP"},I.resendOTPHandler(a)):O.resendOTP2FAController(e,t,o,i,n):O.resendOTPController(e,t,o,i,n)},I.updatePhoneNumber=function(t,o,i,n,e,a,s){D.LRCheck2FA&&(D.options.twoFactorAuthentication||D.options.optionalTwoFactorAuthentication)&&(D.checkPhoneNumberSchema[0].name="phoneNo2FA"),n=n||LoginRadiusDefaults.classPrefix,document.getElementsByName(n+"showQRcode")[0]&&(LoginRadiusDefaults.innerHTML=!0),I.createForm(D.checkPhoneNumberSchema,e||"updatePhone",t,function(e){-1===e.indexOf("phone=")&&(D.options.twoFactorAuthentication||D.options.optionalTwoFactorAuthentication)?O.update2FAPhoneNumberController(e,t,o,i,n,a,s):O.updatePhoneNumberController(e,t,o,i,n,a,s)},function(e){i(e)},n)},I.pingForSmartLogin=function(t,o,i){var n=D.options.autoLoginPingInterval||D.options.smartLoginPingInterval,a=D.options.autoLoginPingCount||D.options.smartLoginPingCount;D.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/login/smartlogin/ping?apiKey="+D.options.apiKey+"&clientGuid="+t,"",function(e){1139===e.ErrorCode||1140===e.ErrorCode?setTimeout(function(){LoginRadiusDefaults.pingCount<a&&(I.pingForSmartLogin(t,o,i),LoginRadiusDefaults.pingCount++)},1e3*n):e.ErrorCode&&1139!==e.ErrorCode?(i(e),LoginRadiusDefaults.pingCount=0):(LoginRadiusDefaults.pingCount=0,o(e))},"pingSmartLogin")},I.pingForSocialLogin=function(o,i,n){var a=D.options.autoLoginPingInterval||D.options.smartLoginPingInterval,s=D.options.autoLoginPingCount||D.options.smartLoginPingCount;D.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account/ping?apiKey="+D.options.apiKey+"&clientGuid="+o+"&verificationUrl="+D.options.verificationUrl+"&emailTemplate="+D.options.verificationEmailTemplate+"&welcomeEmailTemplate="+D.options.welcomeEmailTemplate,"",function(e){var t;1139===e.ErrorCode||1140===e.ErrorCode?setTimeout(function(){LoginRadiusDefaults.pingCount<s&&(I.pingForSocialLogin(o,i,n),LoginRadiusDefaults.pingCount++)},1e3*a):D.options.sendVerificationEmailForUnverifiedSocialLogin&&e.ErrorCode&&1026===e.ErrorCode?(LoginRadiusDefaults.pingCount=0,n(e),(t=D.util.getButtonAttribute("sendverificationemail",LoginRadiusDefaults.classPrefix,()=>{O.sendVerificaionEmailForSocialController(o,D.currentLRContainer,i,n,"clientguid")})).childNodes&&t.childNodes[0].id&&(document.getElementById(t.childNodes[0].id)||(D.util.addHTMLContent(D.currentLRContainer,t,!1),D.$hooks.call("socialLoginFormRender")))):e.ErrorCode&&1139!==e.ErrorCode?(n(e),LoginRadiusDefaults.pingCount=0):(LoginRadiusDefaults.pingCount=0,i(e))},"socialLogin")},I.pingForSocialIdentity=function(t,o,i,n){var a=D.options.autoLoginPingInterval||D.options.smartLoginPingInterval,s=D.options.autoLoginPingCount||D.options.smartLoginPingCount;D.util.ajaxCall("POST",LoginRadiusDefaults.apiDomain+"/auth/socialidentity/ping?apiKey="+D.options.apiKey+"&access_token="+t,{clientGuid:o},function(e){1139===e.ErrorCode||1140===e.ErrorCode?setTimeout(function(){LoginRadiusDefaults.pingCount<s&&(I.pingForSocialIdentity(t,o,i,n),LoginRadiusDefaults.pingCount++)},1e3*a):e.ErrorCode&&1139!==e.ErrorCode?(LoginRadiusDefaults.pingCount=0,n(I.loginRadiusErrorTojsError(e))):(LoginRadiusDefaults.pingCount=0,i(e))},"linkAccount")},I.pingForCrossDeviceSSO=function(t,o,i,n){var a=D.options.crossDeviceSSOPingInterval,s=D.options.crossDeviceSSOPingCount,r=1;D.util.ajaxCall("get",LoginRadiusDefaults.cloudApiDomain+"sso/mobile/token?apiKey="+D.options.apiKey+"&code="+t,"",function(e){e&&null===e.access_token?D.CDSSOPingApiTimeout=setTimeout(function(){r<s&&(I.pingForCrossDeviceSSO(t,o,i,n),r++)},1e3*a):(r=0,n(),o(e))},"pingForCrossDeviceSSO")},I.generateCrossDeviceSSOCode=function(a,e,s,r,l,u){60<+(e=e||"60")?D.log("QR code expiry time should not be more than 60 seconds."):D.util.ajaxCall("get",LoginRadiusDefaults.cloudApiDomain+"sso/mobile/generate?apikey="+D.options.apiKey+"&expiry="+e,"",function(e){var o,t,i,n;e.ErrorCode?r(I.loginRadiusErrorTojsError(e)):e&&e.code&&(o=[],QRCode.toDataURL(e.code,function(e,t){o.push({type:"image",name:"qrcode",display:"QR Code",rules:"",permission:"r",value:t})}),t=l||LoginRadiusDefaults.idPrefix,i=l||LoginRadiusDefaults.classPrefix,(n=document.createElement("div")).setAttribute("name",t+"crossDeviceSSO"),I.createFormFields(o,n,"crossDeviceSSO",[],i,t,r),D.util.addHTMLContent(a,n,LoginRadiusDefaults.innerHTML),I.pingForCrossDeviceSSO(e.code,function(e){I.loginHandleToken(e,"",s,r,"",!0)},r,u))},"crossDeviceSSO")},I.addChangeEventHandler=function(l,e,t,u){D.util.addEvent("change",document.getElementById(u+"registration-"+e.name),function(e){D.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/registrationdata/"+t.DataSource+"?apiKey="+D.options.apiKey+"&parentId="+this.value,"",function(e,t){var o=document.getElementById(u+"registration-"+e.name);if(t.ErrorCode)for(var i=1;i<o.options.length;i++)o.options[i]=null;else for(var n=0;n<t.length;n++){if(0===n&&1<o.options.length){for(var a=1;a<o.options.length;a++)o.options[a]=null;var s=document.createElement("option");s.setAttribute("value",t[n].Id)}else(s=document.createElement("option")).setAttribute("value",t[n].Id);s.appendChild(document.createTextNode(t[n].Key)),o.appendChild(s)}for(var r=0;r<e.children.length;r++)I.addChangeEventHandler(l,e,e.children[r],u)},"registration",t)})},I.createFormFields=function(e,t,l,o,i,n,a){function s(e){var t=Math.random(),o=this.value,i=D.util.elementById(l+"-password-strength-meter"),n=D.util.elementById(l+"-password-strength-text"),a=(n.innerHTML="",0),s=(0<o.length&&(a++,o.match(/[a-z]/)&&o.match(/[A-Z]/)&&a++,o.match(/\d+/)&&a++,o.match(/.[!,@,#,$,%,^,&,*,?,_,~,-,(,)]/)&&a++,12<o.length)&&a++,i.value=a,document.getElementsByClassName(l+"-password"));if(0<s.length)for(var r=0;r<s.length;r++)s[r].parentNode.removeChild(s[r]);(i=D.util.elementById(t)?D.util.elementById(t):document.createElement("style")).type="text/css",i.id=t,i.setAttribute("class",l+"-password"),t=-1!==navigator.userAgent.indexOf("Firefox"),i.innerHTML=t?"#"+l+"-password-strength-meter::-moz-meter-bar { background: "+u[a].color+" !important; }":"#"+l+"-password-strength-meter::-webkit-meter-optimum-value { background: "+u[a].color+" !important; }",document.body.appendChild(i),""!==o&&0<a?(n.innerHTML="Strength: "+u[a].Message,n.style.color=""):""!==o&&(n.innerHTML=u[a].Message,n.style.color=u[a].color)}a=a||function(){};var u,r="cursor:pointer;transform: translateY(-50%);position: absolute;top: 50%;right: 16px;width:24px; height:24px;display:block;";let c=r+'background:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGNsYXNzPSJpY29uIGljb24tdGFibGVyIGljb24tdGFibGVyLWV5ZS1vZmYiIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZT0iY3VycmVudENvbG9yIiBmaWxsPSJub25lIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiPjxwYXRoIHN0cm9rZT0ibm9uZSIgZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPjxwYXRoIGQ9Ik0xMC41ODUgMTAuNTg3YTIgMiAwIDAgMCAyLjgyOSAyLjgyOCIgLz48cGF0aCBkPSJNMTYuNjgxIDE2LjY3M2E4LjcxNyA4LjcxNyAwIDAgMSAtNC42ODEgMS4zMjdjLTMuNiAwIC02LjYgLTIgLTkgLTZjMS4yNzIgLTIuMTIgMi43MTIgLTMuNjc4IDQuMzIgLTQuNjc0bTIuODYgLTEuMTQ2YTkuMDU1IDkuMDU1IDAgMCAxIDEuODIgLS4xOGMzLjYgMCA2LjYgMiA5IDZjLS42NjYgMS4xMSAtMS4zNzkgMi4wNjcgLTIuMTM4IDIuODciIC8+PHBhdGggZD0iTTMgM2wxOCAxOCIgLz48L3N2Zz4=")',p=r+'background:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGNsYXNzPSJpY29uIGljb24tdGFibGVyIGljb24tdGFibGVyLWV5ZSIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlPSJjdXJyZW50Q29sb3IiIGZpbGw9Im5vbmUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCI+PHBhdGggc3Ryb2tlPSJub25lIiBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIi8+PHBhdGggZD0iTTEwIDEyYTIgMiAwIDEgMCA0IDBhMiAyIDAgMCAwIC00IDAiIC8+PHBhdGggZD0iTTIxIDEyYy0yLjQgNCAtNS40IDYgLTkgNmMtMy42IDAgLTYuNiAtMiAtOSAtNmMyLjQgLTQgNS40IC02IDkgLTZjMy42IDAgNi42IDIgOSA2IiAvPjwvc3ZnPg==")';for(var d=function(e){var t,o;e.target.parentNode.childNodes&&e.target.parentNode.childNodes[0].id&&(o="password"===(t=document.getElementById(e.target.parentNode.childNodes[0].id)).getAttribute("type")?"text":"password",t.setAttribute("type",o),"text"==o?e.target.setAttribute("style",c):e.target.setAttribute("style",p))},m=0;m<e.length;m++)if(e[m]){switch(I.setValidation(e[m]),e[m].rules&&""!==e[m].rules&&-1<e[m].rules.indexOf("custom_validation")&&-1===e[m].rules.indexOf("callback_custom_validation")&&(e[m].rules=e[m].rules.replace(/custom_validation\b/g,"callback_custom_validation")),o[m]={},o[m].name=e[m].name,o[m].display=e[m].display,o[m].rules=e[m].rules,e[m].type){case"text":g=document.createElement("textarea");break;case"html":case"captcha":g=document.createElement("div");break;case"password":(g=document.createElement("input")).type="password";break;case"hidden":(g=document.createElement("input")).type="hidden",g.value=e[m].value||"";break;case"option":var g=document.createElement("select"),f=document.createElement("option");if(f.appendChild(document.createTextNode("-- select --")),f.setAttribute("value",""),g.appendChild(f),null==e[m].DataSource&&null!=e[m].options){for(var h=0;h<e[m].options.length;h++){var y=document.createElement("option");y.setAttribute("value",e[m].options[h].value),"country"===e[m].name&&y.setAttribute("value",e[m].options[h].value+"|"+e[m].options[h].text),y.appendChild(document.createTextNode(e[m].options[h].text)),g.appendChild(y)}D.defaultOptionField[e[m].name]&&(g.value=D.defaultOptionField[e[m].name])}break;case"multi":(g=document.createElement("input")).type="checkbox";break;case"email":(g=document.createElement("input")).type="email";break;case"button":(g=document.createElement("input")).type="button",g.value=e[m].display;break;case"image":(g=document.createElement("img")).src=e[m].value,g.type="image";break;default:(g=document.createElement("input")).type="text"}if(e[m].title&&(g.title=e[m].title),e[m].disabled&&(g.disabled=e[m].disabled),I.setAttribute(e[m],g),e[m].placeholder&&(g.placeholder=e[m].placeholder),e[m].value&&("multi"===e[m].type?g.checked=!0:g.value=e[m].value),"html"===e[m].type){var C=document.createElement("div");if(C.setAttribute("class",i+"-form-element-content content-"+n+e[m].name),C.innerHTML=e[m].html,e[m].event&&D.util.addEvent(e[m].event,C,e[m].eventCallback),"consent"===e[m].name)for(var v=C.getElementsByTagName("input"),w=0;w<v.length;w++)v[w].setAttribute("id",n+l+"-"+v[w].name);t.appendChild(C)}else if("captcha"===e[m].type)(C=document.createElement("div")).setAttribute("class",i+"-form-element-content content-"+n+e[m].name),C.innerHTML=e[m].html,D.options.formValidationMessage&&((k=document.createElement("div")).setAttribute("id","validation-"+n+l+"-"+e[m].name),k.setAttribute("class",i+"validation-message validation-"+n+e[m].name),C.appendChild(k)),t.appendChild(C);else{if(g.setAttribute("name",e[m].name),"registration"===l&&(e[m].name&&("phoneid"===e[m].name.toLowerCase()||"phone"===e[m].name.toLowerCase())&&D.options.existPhoneNumber&&D.util.addEvent("blur",g,function(e){var t,o=a;""!==(t=e).target.value.trim()&&O.checkPhoneNumberAvailabilityController("phone="+t.target.value,function(e){e.IsExist?-1!==t.target.parentNode.getAttribute("class").indexOf("phoneid")&&(t.target.parentNode.childNodes[2].innerHTML="phone already exists, enter unique phone number"):-1!==t.target.parentNode.getAttribute("class").indexOf("phoneid")&&(t.target.parentNode.childNodes[2].innerHTML="")},o)}),e[m].name)&&"username"===e[m].name.toLowerCase()&&D.options.existUsername&&D.util.addEvent("blur",g,function(e){var t,o=a;""!==(t=e).target.value.trim()&&O.checkUserNameAvailabilityController("username="+t.target.value,function(e){e.IsExist?-1!==t.target.parentNode.getAttribute("class").indexOf("username")&&(t.target.parentNode.childNodes[2].innerHTML="username already exists, enter unique username"):-1!==t.target.parentNode.getAttribute("class").indexOf("username")&&(t.target.parentNode.childNodes[2].innerHTML="")},o)}),"emailid"===e[m].name&&("login"===l&&D.options.isPassKeysEnabled&&D.options.isPasskeyAutofill&&(g.autocomplete="username webauthn"),D.util.addEvent("keyup",g,function(e){32===e.keyCode&&(this.value=this.value.trim())})),g.setAttribute("id",n+l+"-"+e[m].name),e[m].event&&D.util.addEvent(e[m].event,g,e[m].eventCallback),D.eventsName[g.id]){var T=D.eventsName[g.id];if(D.util.isArray(T))for(var S=0;S<T.length;S++)T[S].event&&T[S].eventCallback&&D.util.addEvent(T[S].event,g,T[S].eventCallback);else D.util.addEvent(T.event,g,T.eventCallback)}if("hidden"===e[m].type)t.appendChild(g);else if("button"===e[m].type){var k=document.createElement("div");k.setAttribute("class",i+"-form-element-content content-"+n+e[m].name),k.appendChild(g),t.appendChild(k)}else{(E=document.createElement("label")).setAttribute("for",n+l+"-"+e[m].name),E.innerHTML=e[m].display,g.setAttribute("class",i+e[m].type+" "+n+e[m].name),e[m].rules&&-1!==e[m].rules.indexOf("required")&&(g.className+=" lr-required");var L=document.createElement("div");if(L.setAttribute("class",i+"-form-element-content content-"+n+e[m].name),"multi"===e[m].type?(L.appendChild(g),L.appendChild(E)):(L.appendChild(E),L.appendChild(g)),e[m].style&&0<e[m].style.length)for(var b=0;b<e[m].style.length;b++)L.style[e[m].style[b].key]=e[m].style[b].value;if(D.options.formValidationMessage&&((E=document.createElement("div")).setAttribute("id","validation-"+n+l+"-"+e[m].name),E.setAttribute("class",i+"validation-message validation-"+n+e[m].name),L.appendChild(E)),D.options.displayPasswordStrength&&("password"===g.name||"newpassword"===g.name)&&("registration"===l||"resetpassword"===l||"setpassword"===l||"changepassword"===l||"socialRegistration"===l||"loginRequiredFieldsUpdate"===l)){if(D.options.passwordLength&&D.options.passwordLength.min,D.options.passwordLength&&D.options.passwordLength.max,e[m].rules)for(var R=e[m].rules.split("|"),P=0;P<R.length;P++)(-1<R[P].indexOf("min_length")||-1<R[P].indexOf("max_length"))&&R[P].substring(11,R[P].length-1);(E=document.createElement("meter")).setAttribute("max","4"),E.setAttribute("id",l+"-password-strength-meter");var E,A=document.createElement("div");A.setAttribute("id",l+"-password-strength-text"),g.parentNode.appendChild(E),g.parentNode.appendChild(A),u=function(){var e,t={0:"worst",1:"bad",2:"weak",3:"good",4:"strong",5:"secure"},o={0:"#dd514c",1:"orange",2:"yellow",3:"#5eb95e",4:"blue",5:"violet"},i={0:"Worst",1:"Bad",2:"Weak",3:"Good",4:"Strong",5:"Secure"},n=[],a=D.passwordMeterConfiguration;for(e in t)a[e]&&a[e].case?a[e].case.toLowerCase()===t[e]&&n.push({color:a[e].color||o[e],Message:a[e].message||i[e]}):n.push({color:o[e],Message:i[e]});return n}(),D.util.addEvent("keyup",g,s)}(("password"===g.name||"newpassword"===g.name||"oldpassword"===g.name)&&D.options.passwordVisibilityControl||("confirmpassword"===g.name||"confirmnewpassword"===g.name)&&D.options.confirmPasswordVisibilityControl)&&((E=document.createElement("i")).setAttribute("class","fa-eye"),E.setAttribute("style",p),"password-visibility-wrap"!==g.parentNode.id&&((A=document.createElement("div")).setAttribute("id","password-visibility-wrap"),A.setAttribute("style","position: relative;"),g.parentNode.insertBefore(A,g),A.appendChild(g),A.appendChild(E)),D.util.addEvent("click",E,d)),t.appendChild(L)}}}},I.setToken=function(e){LRNameSpace.cookies.setItem(LoginRadiusDefaults.tokenCookie,e,"",D.options.appPath)},I.resetGoogleCaptcha=function(e,t){D.options.optionalRecaptchaConfiguration&&D.options.optionalRecaptchaConfiguration.IsEnabled&&"registration"!==e&&(e=D.util.elementById(t,!0))&&""!==e.innerHTML&&(window.hcaptcha&&D.options.hCaptchaSiteKey?window.hcaptcha.reset(window[t+"lr_recaptcha_widgets_idprefix"]):window.grecaptcha&&grecaptcha.reset(window[t+"lr_recaptcha_widgets_idprefix"]))},I.createForm=function(e,c,t,p,d,m,o){var i,n,a,s,r,l,g=m||LoginRadiusDefaults.idPrefix,f=m||LoginRadiusDefaults.classPrefix,o=o||c;if(D.LRPrefix=m+"##"+LoginRadiusDefaults.idPrefix,"registration"!==c&&"oneTouchLogin"!==c&&("Captcha"===D.options.loginLockedType||D.options.optionalRecaptchaConfiguration&&D.options.optionalRecaptchaConfiguration.IsEnabled)&&(n=D.options.optionalRecaptchaConfiguration.Apis,"Captcha"===D.options.loginLockedType&&LoginRadiusDefaults.captchaActions.includes(c.toLowerCase())||n&&P(o,n))&&(i=m+LoginRadiusDefaults.idPrefix+"recaptcha_widget_"+c.toLowerCase(),D.util.addRecaptchaJS(),D.util.captchaSchema(i,e)),D.$hooks.call("beforeFormRender",c,e),LoginRadiusDefaults.isRegFormSchemaLock=!1,LoginRadiusDefaults.isSecurityFormSchemaLock=!1,D.options.apiKey){if(I.setCustomLabel(e),I.setPlaceholder(e),I.setCustomTitle(e),0<e.length){var u,h,y=[],C=document.createElement("form"),v=(C.setAttribute("name",g+c),C.setAttribute("method","POST"),I.createFormFields(e,C,c,y,f,g,d),document.createElement("input")),w=D.buttonsName[c.toLowerCase()]||L[c.toLowerCase()],T=L[c.toLowerCase()].toLowerCase().replace(/ /g,"-"),S=(v.type="submit",D.options.isPINAuthentication&&"loginRequiredFieldsUpdate"===c&&D.util.findInSchema(e,"name","pin")?v.value="Continue":v.value=w,v.id=g+"submit-"+T,v.setAttribute("class",f+"submit submit-"+g+T),D.options.disableButtonOnsubmit&&(D.$hooks.register("eventCalls",function(e){window.lrpasswordlessloginotp||window.lrpasswordlesslogin||(u=e)}),D.$hooks.register("startProcess",function(e){u===c&&(v.disabled=!0)}),D.$hooks.register("xhrEndWithError",function(e){u===c&&(v.disabled=!1)}),D.$hooks.register("xhrEndWithSuccess",function(e){u===c&&D.options.enableSubmitOnSuccess&&(v.disabled=!1)})),C.appendChild(v),D.options.passwordlessLogin&&"login"===c&&R("passwordlessloginbuttonlabel",C,v,g,f),D.options.passwordlessLoginOTP&&"login"===c&&R("passwordlessLoginOTPButtonLabel",C,v,g,f),!D.options.isPassKeysEnabled||"passkeyregister"!==c&&"login"!==c||(a="passkeyregister"===c?"registerwithpwd":"passkeylogin",e=C,w=g,T=f,(s=document.createElement("input")).type="submit",r=D.buttonsName[a.toLowerCase()]||L[a.toLowerCase()],l=L[a.toLowerCase()],s.value=r,s.id=w+"-"+l.toLowerCase().replace(/ /g,"-"),s.name=a,s.setAttribute("class",T+" "+w+l.toLowerCase().replace(/ /g,"-")),s.setAttribute("class",T+" "+l.toLowerCase().replace(/ /g,"-")),e.appendChild(s),D.util.addEvent("click",s,function(e){"registerwithpwd"===a?window.lrpwdregister=!0:(window.lrpasskeylogin=!0,window.lrpasswordlessloginotp=!1,window.lrpasswordlesslogin=!1)})),D.util.addHTMLContent(t,C,LoginRadiusDefaults.innerHTML),D.$hooks.call("afterFormRender",c,t,f,C),LoginRadiusDefaults.innerHTML=!1,new FormValidator(g+c,y,function(e,t){var o=document.getElementsByTagName("form"),i="";if(o[g+c])i=o[g+c];else if("object"==typeof o)for(var n=0;n<o.length;n++)if(o[n].name===g+c){i=o[n];break}D.currentLRContainer=i.parentElement.id,D.$hooks.call("eventCalls",c,f),D.mergeFormErrors&&0<D.mergeFormErrors.length&&(e=D.util.mergeObjects(e,D.mergeFormErrors));for(var a=D.util.elementsByClass(f+"validation-message"),s=0;s<a.length;s++)a[s].innerHTML="";var r=m+g+"recaptcha_widget",l=(r+="_"+c.toLowerCase(),D.util.elementById(r+"_tencent"));if(D.options.invisibleRecaptcha&&(window.onCaptchaSubmit=function(e){var t=D.util.serialize(C);window.grecaptcha&&-1===t.indexOf("g-recaptcha-response")&&(t+="&g-recaptcha-response="+e),window.hcaptcha&&D.options.hCaptchaSiteKey&&-1===t.indexOf("h-captcha-response")&&(t+="&h-captcha-response="+e),p(t),window.hcaptcha&&D.options.hCaptchaSiteKey?window.hcaptcha.reset(window[r+"lr_recaptcha_widgets_idprefix"]):window.grecaptcha&&grecaptcha.reset(window[r+"lr_recaptcha_widgets_idprefix"])}),l&&"none"!==l.style.display&&(D.options.tencentCaptcha||D.options.tencentCaptchaAsFallback&&!window.grecaptcha)&&0==e.length&&l.click(),0<e.length){D.$hooks.call("afterValidation",c);for(var u=0;u<e.length;u++)if("login"===c&&(D.options.isPassKeysEnabled&&window.lrpasskeylogin||D.options.passwordlessLogin&&window.lrpasswordlesslogin||D.options.passwordlessLoginOTP&&window.lrpasswordlessloginotp)){if(1===e.length||D.options.v2Recaptcha||D.options.hCaptchaSiteKey&&!D.options.invisibleRecaptcha){if(e[u].Id===g+""+c+"-password")return b(C,p,r,c),!0;if("g-recaptcha-response"===e[u].Id)return b(C,p,r,c),!0}}else{if("passkeyregister"===c&&D.options.isPassKeysEnabled&&window.lrpwdregister)return b(C,p,r,c),!0;D.options.formValidationMessage&&"resettoken"!==e[u].Name&&(D.util.elementById("validation-"+g+c+"-"+e[u].Name).innerHTML=e[u].Message)}D.options.formValidationMessage||(d(e),I.resetGoogleCaptcha(c,r))}else b(C,p,r,c);t&&t.preventDefault?t.preventDefault():event&&(event.returnValue=!1)}));if(D.validationMessages&&0<D.validationMessages.length)for(var k=0;k<D.validationMessages.length;k++)S.setMessage(D.validationMessages[k].rule,D.validationMessages[k].message),"valid_date"!==D.validationMessages[k].rule&&"callback_valid_date"!==D.validationMessages[k].rule||(h=D.validationMessages[k].message);S.registerCallback("valid_date",function(e){return o=e.split("/"),-1!==e.indexOf("-")&&(o=e.split("-")),e=parseInt(o[1],10),i=parseInt(o[0],10),!((o=parseInt(o[2],10))<1e3||3e3<o||0===i||12<i)&&(t=[31,28,31,30,31,30,31,31,30,31,30,31],(o%400==0||o%100!=0&&o%4==0)&&(t[1]=29),0<e)&&e<=t[i-1];var t,o,i}).setMessage("valid_date",h||"The %s field must contain a valid date."),S.registerCallback("custom_validation",function(e,t){t=(t=t.split("###")[0]).split("or").join("|");try{return!!new RegExp(t,"gu").test(e)}catch(e){return D.log("Invalid custom validation regex expression"),!1}}).setMessage("custom_validation","The %s field is not valid."),D.Validator=S}}else D.log("API key must be set.");D.options.optionalRecaptchaConfiguration&&D.options.optionalRecaptchaConfiguration.IsEnabled&&n&&P(o,n)&&"registration"!==c&&D.util.renderV2Recaptcha(i,!0)},I.createConsentInterface=function(e,t){var o="";if(e){for(var i=0;i<e.ConsentForm.length;i++)if("Group"===e.ConsentForm[i].Type){if(e.ConsentForm[i].Consents.length){var n={consentGroupTitle:e.ConsentForm[i].Title,consentGroupDescription:e.ConsentForm[i].Description};o+=D.util.hashTmpl(LoginRadiusDefaults.templates.consentGroupTemplate,n);for(var a=0;a<e.ConsentForm[i].Consents.length;a++){var s={consentTitle:e.ConsentForm[i].Consents[a].Title,consentDescription:e.ConsentForm[i].Consents[a].Description,consentId:"consent_"+e.ConsentForm[i].Consents[a].ConsentId};o+=D.util.hashTmpl(LoginRadiusDefaults.templates.consentOptionTemplate,s)}}}else if("Consent"===e.ConsentForm[i].Type)for(var r=0;r<e.ConsentForm[i].Consents.length;r++){var l={consentTitle:e.ConsentForm[i].Consents[r].Title,consentDescription:e.ConsentForm[i].Consents[r].Description,consentId:"consent_"+e.ConsentForm[i].Consents[r].ConsentId};o+=D.util.hashTmpl(LoginRadiusDefaults.templates.consentOptionTemplate,l)}if(o+=D.util.hashTmpl(LoginRadiusDefaults.templates.consentMainTemplate,e),t){var u=document.createElement("div");u.innerHTML=o.trim();for(var c=0;c<t.length;c++){var p=u.querySelector('input[name="consent_'+t[c].ConsentOptionId+'"]');p&&p.setAttribute("checked","checked")}o=u.innerHTML||""}}return o},I.createConsentOptionInterface=function(e,t){var o="";if(e){for(var i in e)i={consentTitle:e[i].Title,consentDescription:e[i].Description,consentId:"consent_"+e[i].ConsentId,checked:!!e[i].checked},o+=D.util.hashTmpl(LoginRadiusDefaults.templates.consentOptionTemplate,i);if(t){var n=document.createElement("div");n.innerHTML=o.trim();for(var a=0;a<t.length;a++)e[t[a].ConsentOptionId]&&n.querySelector('input[name="consent_'+t[a].ConsentOptionId+'"]').setAttribute("checked","checked");o=n.innerHTML||""}}return o},I.setConsentTemplate=function(){var e,t,o,i,n=document.getElementById(LoginRadiusDefaults.templates.consentMainTemplate);n&&((e=document.createElement("div")).innerHTML=n.innerHTML,n.append(e),(t=document.createElement("script")).type="text/html",t.id=LoginRadiusDefaults.templates.consentOptionTemplate,t.innerHTML=this.decodeHtml(document.getElementById(LoginRadiusDefaults.templates.consentOptionTemplate).innerHTML),(o=document.getElementById(LoginRadiusDefaults.templates.consentGroupTemplate))&&(i=o.querySelectorAll("#"+LoginRadiusDefaults.templates.consentOptionTemplate)[0])&&i.remove(),(i=document.createElement("script")).type="text/html",i.id=LoginRadiusDefaults.templates.consentGroupTemplate,i.innerHTML=this.decodeHtml(o.innerHTML),o.remove(),n.innerHTML=this.decodeHtml(e.innerHTML),e.remove(),document.body.append(i),document.body.append(t))},I.consentValidation=function(e,t){var o=D.util.parseQueryString(e),i=[];if(t){if(D.consentOptions[t]&&D.consentOptions[t].ConsentForm)for(var n=D.consentOptions[t].ConsentForm,a=0;a<n.length;a++)var s=n[a],i="Group"===s.Type?I.setConsentValidation(s,o,i,!0):I.setConsentValidation(s,o,i)}else{var r,l={Type:"Consent",Consents:[]};for(r in D.consentsList)l.Consents.push(D.consentsList[r]);i=I.setConsentValidation(l,o,i)}return i},I.setConsentValidation=function(e,t,o,i){var n=!1;if(i&&e.IsRequiredAtleastOne&&0===e.Consents.length)o.push({Id:e.GroupId,Name:e.Title,Message:"In "+e.Title+" group should have at least one consent"});else{for(var a=0;a<e.Consents.length;a++)i&&e.IsRequiredAtleastOne&&"true"===t["consent_"+e.Consents[a].ConsentId]&&(n=!0),e.Consents[a].IsRequired&&"true"!==t["consent_"+e.Consents[a].ConsentId]&&o.push({Id:e.Consents[a].ConsentId,Name:e.Consents[a].Title,Message:e.Consents[a].Title+" consent is required"});e.IsRequiredAtleastOne&&!n&&o.push({Id:e.GroupId,Name:e.Title,Message:"In "+e.Title+" group at least one consent is required"})}return o},I.isValidToken=function(e,t){return!!e||(t([I.setMappedMessage(h.tokenValid)]),!1)},I.decodeHtml=function(e){var t=document.createElement("textarea");return t.innerHTML=e,t.value},I.checkForLatestPrivacyPolicy=function(e){for(var t=D.options.privacyPolicyConfiguration.PrivacyPolicies,o=(new Date).getTime(),i={},n=0;n<t.length;n++)new Date(t[n].StartDateTime).getTime()<o&&(D.util.isEmpty(i)||!D.util.isEmpty(i)&&new Date(i.StartDateTime).getTime()<new Date(t[n].StartDateTime).getTime())&&(i=t[n]);return i.Version===e.PrivacyPolicy.Version},I.sanitizePinData=function(e){var t={PIN:"",Skipped:null};return(e=Object.assign({},e)).hasOwnProperty("pin")&&e.pin?t.PIN=e.pin:t.Skipped=!0,delete e.pin,e.PINInfo=t,e},I.sanitizeSecurityQuesData=function(e){var t,o=D.util.parseQueryString(e),i={},n=["email","username","phone","password","pin","phoneApi"];for(t in o)-1===n.indexOf(t)&&(i[t]=o[t],delete o[t]);return o.securityanswer=i,o},I.loadQRCodeScript=function(e){var t;D.options.isCrossDeviceSSOEnabled&&((t=document.createElement("script")).src=LoginRadiusDefaults.externalLibrary+"qrcode.js",t.type="text/javascript",t.onload=function(){e()},document.getElementsByTagName("head")[0].appendChild(t))},I.createAccountPasskey=function(t,o){let i=D.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);D.options.isPassKeysEnabled&&D.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account/register/passkey/begin?apikey="+D.options.apiKey+"&access_token="+i,"",function(e){e.ErrorCode?o(I.loginRadiusErrorTojsError(e)):D.util.createPassKeyCredentials(e.RegisterBeginCredential).then(e=>{e={id:e.id,rawId:D.util.base64UrlEncode(e.rawId),type:e.type,response:{attestationObject:D.util.base64UrlEncode(e.response.attestationObject),clientDataJSON:D.util.base64UrlEncode(e.response.clientDataJSON)}},D.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/account/register/passkey/finish?apiKey="+D.options.apiKey+"&access_token="+i,e,function(e){e.ErrorCode?o(I.loginRadiusErrorTojsError(e)):t(e)},"account-passkey")}).catch(e=>{o(I.loginRadiusErrorTojsError(e))})})},I.removePasskey=function(e,t,o){var i=D.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);D.options.isPassKeysEnabled&&D.util.ajaxCall("delete",LoginRadiusDefaults.apiDomain+`/auth/account/passkey/${e}?apikey=`+D.options.apiKey+"&access_token="+i,"",function(e){e.ErrorCode?o(I.loginRadiusErrorTojsError(e)):t(e)})},I.resendOTPHandler=function(t){let e="",o,i;t.voiceotp&&(e="&isvoiceotp=true"),"update2FANumberResendOTP"===t.action?(o=D.storage.getBrowserStorage(LoginRadiusDefaults.storedTwoFAToken),(i=D.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName))&&!D.LRCheckLogin?D.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/account/2FA?apiKey="+D.options.apiKey+"&access_token="+i+"&smsTemplate="+t.smstemplate+e,t.data,function(e){e.ErrorCode?t.onerror(I.loginRadiusErrorTojsError(e)):t.onsuccess(e,t.data)},"updatePhone"):o?(t.data.phone&&(t.data.phoneno2fa=t.data.phone),D.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/login/2FA/?apiKey="+D.options.apiKey+"&SecondFactorAuthenticationToken="+o+"&smsTemplate2FA="+t.smstemplate+e,t.data,function(e){e.ErrorCode?t.onerror(I.loginRadiusErrorTojsError(e)):t.onsuccess(e,t.data)},"login")):t.onerror([I.setMappedMessage(h.twofaTokenValid)])):"smartLoginResendOTP"===t.action?D.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/login/passwordlesslogin/otp?apiKey="+D.options.apiKey+"&phone="+t.data+"&smsTemplate="+t.smstemplate+e,"",function(e){e.ErrorCode?t.onerror(I.loginRadiusErrorTojsError(e)):t.onsuccess(e)},"loginOTP"):"sendInstantSignInResendOtp"===t.action&&D.util.ajaxCall("GET",LoginRadiusDefaults.apiDomain+"/auth/login/passwordlesslogin/otp?apiKey="+D.options.apiKey+"&"+t.data+"&smsTemplate="+t.smstemplate+e,"",function(e){e.ErrorCode?t.onerror(I.loginRadiusErrorTojsError(e)):t.onsuccess(e)},"passwordlessLogin")},I.addResendOTPBtn=function(s,r,l){D.$hooks.register("afterFormRender",function(e,t,o,i){var n,a;s&&i&&"loginradius-twofaemailotp"===i.name&&(D.util.findInSchema(i,"id","loginradius-button-resendemailotp")||(n=D.util.getButtonAttribute("resendemailotp",o,function(e){D.options.disableResendOTPButton&&D.util.disableResendOTPButton(e),O.sendMFAEmailOTPController({EmailId:i[1].value},r,l,t,o,"resend")}),(a=D.util.findInSchema(i,"type","submit"))?a.parentNode.insertBefore(n,a.nextSibling):i.appendChild(n)))})},I.pingForPushNotification=function(t,o,i){var n=D.options.autoLoginPingInterval||D.options.smartLoginPingInterval,a=D.options.autoLoginPingCount||D.options.smartLoginPingCount,e=D.LRCheckLogin?"/auth/login/2fa/push/ping?secondfactorauthenticationtoken="+t:"/auth/account/2fa/push/ping?access_token="+t;D.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+e+"&apiKey="+D.options.apiKey,"",function(e){1295===e.ErrorCode||1313===e.ErrorCode?setTimeout(function(){LoginRadiusDefaults.pingCount<a&&(I.pingForPushNotification(t,o,i),LoginRadiusDefaults.pingCount++)},1e3*n):e.ErrorCode?(i(I.loginRadiusErrorTojsError(e)),LoginRadiusDefaults.pingCount=0):(LoginRadiusDefaults.pingCount=0,o(e))},"pingForPushNotification")},I.resendPushNotification=function(t,o,i){var e=LoginRadiusDefaults.apiDomain+"/auth/login/2fa/push?apiKey="+D.options.apiKey+"&secondfactorauthenticationtoken="+t;D.util.ajaxCall("post",e,{},function(e){e.ErrorCode?i(I.loginRadiusErrorTojsError(e)):(LoginRadiusDefaults.pingCount<=1&&I.pingForPushNotification(t,o,i),o(e))},"resendPushNotification")},I.createAccountMFAPasskey=function(t,o){let i=D.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);D.options.isPassKeysEnabled&&D.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account/2fa/register/passkey/begin?apikey="+D.options.apiKey+"&access_token="+i,"",function(e){e.ErrorCode?o(I.loginRadiusErrorTojsError(e)):D.util.createPassKeyCredentials(e.RegisterBeginCredential).then(e=>{e={PasskeyCredential:{id:e.id,rawId:D.util.base64UrlEncode(e.rawId),type:e.type,response:{attestationObject:D.util.base64UrlEncode(e.response.attestationObject),clientDataJSON:D.util.base64UrlEncode(e.response.clientDataJSON)}}},D.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/account/2fa/register/passkey/finish?apiKey="+D.options.apiKey+"&access_token="+i,e,function(e){e.ErrorCode?o(I.loginRadiusErrorTojsError(e)):t(e)},"account-passkey-mfa")}).catch(e=>{o(I.loginRadiusErrorTojsError(e))})})},I.createMFAPasskey=function(t,o,i){D.options.isPassKeysEnabled&&D.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/login/2fa/register/passkey/begin?apikey="+D.options.apiKey+"&secondfactorauthenticationtoken="+t,"",function(e){e.ErrorCode?i(I.loginRadiusErrorTojsError(e)):D.util.createPassKeyCredentials(e.RegisterBeginCredential).then(e=>{e={PasskeyCredential:{id:e.id,rawId:D.util.base64UrlEncode(e.rawId),type:e.type,response:{attestationObject:D.util.base64UrlEncode(e.response.attestationObject),clientDataJSON:D.util.base64UrlEncode(e.response.clientDataJSON)}}},D.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/login/2fa/register/passkey/finish?apiKey="+D.options.apiKey+"&secondfactorauthenticationtoken="+t,e,function(e){e.ErrorCode?i(I.loginRadiusErrorTojsError(e)):O.handleFeatures(e,"","","",o,i,"")},"register-passkey-mfa")}).catch(e=>{i(I.loginRadiusErrorTojsError(e))})})},I.loginMFAPasskey=function(s,r,l){D.options.isPassKeysEnabled&&D.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/login/2fa/passkey/begin?apikey="+D.options.apiKey+"&secondfactorauthenticationtoken="+s,"",function(e){e.ErrorCode?l(I.loginRadiusErrorTojsError(e)):D.util.getPassKeyCredentials(e.LoginBeginCredential,!1).then(e=>{var t=e.response.authenticatorData,o=e.response.clientDataJSON,i=e.rawId,n=e.response.signature,a=e.response.userHandle,i={PasskeyCredential:{id:e.id,rawId:D.util.base64UrlEncode(i),type:e.type,authenticatorAttachment:e.authenticatorAttachment,response:{authenticatorData:D.util.base64UrlEncode(t),clientDataJSON:D.util.base64UrlEncode(o),signature:D.util.base64UrlEncode(n),userHandle:D.util.base64UrlEncode(a)}}};D.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/login/2fa/passkey/finish?apiKey="+D.options.apiKey+"&secondfactorauthenticationtoken="+s,i,function(e){e.ErrorCode?l(I.loginRadiusErrorTojsError(e)):O.handleFeatures(e,"","","",r,l,"")},"login-passkey-mfa")}).catch(e=>{l(I.loginRadiusErrorTojsError(e))})})}}function LoginRadiusControllers(P,E){var C=LoginRadiusDefaults.messages,A=this;function n(e,t,o,i,n){t?P.util.ajaxCall(e,LoginRadiusDefaults.apiDomain+"/auth/customobject/"+o+"?apiKey="+P.options.apiKey+"&access_token="+t+"&objectname="+P.options.customObjectName,"",function(e){e.ErrorCode?n(E.loginRadiusErrorTojsError(e)):i(e)},"CustomObject"):n([E.setMappedMessage(C.twofaTokenValid)])}A.handleFeatures=function(e,t,o,i,n,a,s){var r,l,u,c,p=e.Profile;"string"!=typeof t&&(t=P.util.jsonToQueryString(t)),i&&P.options.periodicPasswordReset&&p.PasswordExpirationDate&&new Date(p.PasswordExpirationDate)<=new Date?(E.setPasswordRule(P.changePasswordFormSchema[1]),E.setPasswordRule(P.changePasswordFormSchema[2]),i(p,e)):o&&(P.options.askRequiredFieldForTraditionalLogin||LoginRadiusDefaults.autoFilledFieldforPasswordLesLogin||P.askPinOnLogin)?(i=p,r=t,l=n,u=a,P.storage.setBrowserStorage(LoginRadiusDefaults.storedTokenName,(p=e).access_token),P.options.isPINAuthentication&&P.options.PINConfiguration.PINLogin&&p&&p.session_token&&P.setSessionToken(p),c=P.options,c=JSON.parse(JSON.stringify(c)).RegistrationFormSchema,i.IsDeleted?u(E.loginRadiusErrorTojsError(i)):(P.options.autoFilledFieldForTraditional&&P.$hooks.register("beforeFormRender",function(e,t){"loginRequiredFieldsUpdate"===e&&((e=P.util.findInSchema(t,"name","emailid"))&&e.value&&(e.disabled=!0),e=P.util.findInSchema(t,"name","phoneid"))&&e.value&&(e.disabled=!0)}),P.registrationFormSchema=E.mapSchema(c,i,P.options.autoFilledFieldForTraditional),0<P.registrationFormSchema.length?(E.setPasswordRule(P.util.findInSchema(c,"name","password")),E.setPasswordRule(P.util.findInSchema(c,"name","confirmpassword")),P.$hooks.call("registrationSchemaFilter",c,i),o(i,p,p.access_token,r,l,u)):E.loginHandleToken(p,r,l,u))):E.loginHandleToken(e,t,n,a,s)},A.verifyOTPController=function(t,e,o,i,n,a){var s=LoginRadiusDefaults.apiDomain+"/auth/phone/otp?apiKey="+P.options.apiKey+"&otp="+t.otp+"&smsTemplate="+P.options.smsTemplateWelcome;t.haveToken&&(s+="&access_token="+P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName)),t.onetouchloginflag&&(s=LoginRadiusDefaults.apiDomain+"/auth/onetouchlogin/phone/verify?apiKey="+P.options.apiKey+"&otp="+t.otp+"&smsTemplate="+P.options.smsTemplateOneTouchLoginWelcome),e={...e,...t},P.util.ajaxCall("put",s,e,function(e){e.ErrorCode?i(E.loginRadiusErrorTojsError(e)):t.onetouchloginflag&&!P.options.askRequiredFieldsOnPasswordLessLogin?E.loginHandleToken(e,"",o,i,"",!0):e.access_token?(LoginRadiusDefaults.autoFilledFieldforPasswordLesLogin=!0,A.handleFeatures(e,t,a,n,o,i)):o(e,t)},"verifyOTP")},A.updateSecurityQuestionController=function(e,t,o){for(var i=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),n=P.util.parseQueryString(e),a=0;a<P.options.securityQuestionsCount;a++)n[n["securityQuestion"+a]]=n["securityAnswer"+a],delete n["securityQuestion"+a],delete n["securityAnswer"+a];e={SecurityQuestionAnswer:n},E.isValidToken(i,o)&&P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/account?apikey="+P.options.apiKey+"&access_token="+i,e,function(e){e.ErrorCode?o(E.loginRadiusErrorTojsError(e)):t(e)},"updateSecurityQuestion")},A.resetTwoFactorAuthenticationController=function(t,o,i){var e,n=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),a={};a[t]=!0,E.isValidToken(n,i)&&(e="/auth/account/2FA/authenticator","emailotpauthenticator"===t?(e="/auth/account/2fa/authenticator/otp/email",a={}):"sqauthenticator"===t?(e="/auth/account/2fa/authenticator/securityquestionanswer",a={}):"pushnotificationauthenticator"===t?(e="/auth/account/2fa/authenticator/push",a={}):"duoauthenticator"===t?(e="/auth/account/2fa/authenticator/duo",a={}):"passkeyauthenticator"===t&&(e="/auth/account/2fa/authenticator/passkey",a={}),P.util.ajaxCall("delete",LoginRadiusDefaults.apiDomain+e+"?apikey="+P.options.apiKey+"&access_token="+n,a,function(e){e.ErrorCode?i(E.loginRadiusErrorTojsError(e)):o(e,t)},"resetTwoFactorAuthentication"))},A.forgotPasswordController=function(o,i,n,a,s){var e=P.options.forgotPasswordUrl||P.options.resetPasswordUrl;P.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/password?apiKey="+P.options.apiKey+"&resetPasswordUrl="+e+"&emailTemplate="+P.options.resetPasswordEmailTemplate,o,function(e){var t;e.ErrorCode?a(E.loginRadiusErrorTojsError(e)):(t=P.util.parseQueryString(o),n(e,t),E.showOTPTemplateForm("ForgotPassword")&&E.resetPassword(i,n,a,s,t))},"forgotPassword")},A.forgotPassKeyController=function(o,e,i,n,t){var a=P.options.forgotPassKeyUrl||P.options.resetPassKeyUrl;P.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/passkey/forgot?apiKey="+P.options.apiKey+"&resetpasskeyurl="+a+"&emailTemplate="+P.options.resetPassKeyEmailTemplate,o,function(e){var t;e.ErrorCode?n(E.loginRadiusErrorTojsError(e)):(t=P.util.parseQueryString(o),i(e,t))},"forgotPassKey")},A.resetPasskeyFinishController=function(e,t,o,i,n,a){e={id:e.id,rawId:P.util.base64UrlEncode(e.rawId),type:e.type,response:{attestationObject:P.util.base64UrlEncode(e.response.attestationObject),clientDataJSON:P.util.base64UrlEncode(e.response.clientDataJSON)}},P.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/passkey/reset/finish?apiKey="+P.options.apiKey+"&vtoken="+t,e,function(e){e.ErrorCode?i(E.loginRadiusErrorTojsError(e)):o(e,{})},"resetPassword")},A.resetPassKeyController=function(t,o,i,n,a){P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/passkey/reset/begin?apiKey="+P.options.apiKey+"&vtoken="+t,"",function(e){e.ErrorCode?n(E.loginRadiusErrorTojsError(e)):P.util.createPassKeyCredentials(e.RegisterBeginCredential).then(e=>{A.resetPasskeyFinishController(e,t,i,n,o,a)}).catch(e=>{n(E.loginRadiusErrorTojsError(e))})})},A.forgotPINController=function(o,i,n,a,s){var e=P.util.parseQueryString(o).hasOwnProperty("username")?"username":"email",t=P.options.forgotPINUrl||P.options.resetPINUrl;P.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/pin/forgot/"+e+"?apiKey="+P.options.apiKey+"&resetPINUrl="+t+"&emailTemplate="+P.options.resetPINEmailTemplate,o,function(e){var t;e.ErrorCode?a(E.loginRadiusErrorTojsError(e)):(t=P.util.parseQueryString(o),n(e,t),E.showOTPTemplateForm("ForgotPIN")&&E.resetPIN(i,n,a,s,t))},"forgotPIN")},A.loginController=function(o,i,n,a,s,r,l,u,c){P.options.verificationEmailTemplate=P.options.emailTemplate||P.options.verificationEmailTemplate;var e="emailTemplate="+P.options.verificationEmailTemplate+"&verificationUrl="+P.options.verificationUrl,t=(P.options.phoneLogin&&(e+="&smsTemplate="+P.options.smsTemplatePhoneVerification),P.options.riskBasedAuthentication&&(e=(e+="&RbaOneclickEmailTemplate="+P.options.rbaOneclickEmailTemplate+"&RbaOTPSmsTemplate="+P.options.rbaOTPSmsTemplate+"&RbaCityEmailTemplate="+P.options.rbaCityEmailTemplate+"&RbaCountryEmailTemplate="+P.options.rbaCountryEmailTemplate+"&RbaBrowserEmailTemplate="+P.options.rbaBrowserEmailTemplate+"&RbaIpEmailTemplate="+P.options.rbaIpEmailTemplate+"&RbaDeviceEmailTemplate="+P.options.rbaDeviceEmailTemplate+"&RbaCitySmsTemplate="+P.options.rbaCitySmsTemplate+"&RbaCountrySmsTemplate="+P.options.rbaCountrySmsTemplate)+"&RbaBrowserSmsTemplate="+P.options.rbaBrowserSmsTemplate+"&RbaIpSmsTemplate="+P.options.rbaIpSmsTemplate+"&RbaDeviceSmsTemplate="+P.options.rbaDeviceSmsTemplate),("string"==typeof(o=P.util.checkPhoneOrEmailLogin(o))||o instanceof String)&&(o=P.util.parseQueryString(o)),P.options.duplicateEmailWithUniqueUsername&&(delete o.email,delete o.phoneid),P.options.isB2BEnabled&&P.options.organizationObj&&P.options.organizationObj.Id&&(e+="&org_id="+P.options.organizationObj.Id),P.options.isB2BEnabled&&"orginvite"===P.util.getHashParam("vtype")&&(t=P.util.getHashParam("vtoken"))&&(e+="&invitation_token="+t),LoginRadiusDefaults.apiDomain+"/auth/login?apiKey="+P.options.apiKey+"&loginUrl="+P.options.loginUrl+"&"+e);o["g-recaptcha-response"]&&(t+="&g-recaptcha-response="+o["g-recaptcha-response"],delete o["g-recaptcha-response"]),o["h-captcha-response"]&&(t+="&h-captcha-response="+o["h-captcha-response"],delete o["h-captcha-response"]),o.qq_captcha_randstr&&(t+="&qq_captcha_randstr="+o.qq_captcha_randstr,delete o.qq_captcha_randstr),o.qq_captcha_ticket&&(t+="&qq_captcha_ticket="+o.qq_captcha_ticket,delete o.qq_captcha_ticket),P.util.ajaxCall("post",t,o,function(e){var t;P.options.stayLogin&&P.storage.setBrowserStorage("lr-rememberme",o.stayLogin),e.ErrorCode?("970"!=e.ErrorCode||P.options.verifyEmailByOTP?"1167"==e.ErrorCode&&(e.PhoneId||o.phone)?(delete o.email,o.phone=e.PhoneId||o.phone,A.loginOTPController(o,i,n,a,l,"no")):P.options.phoneLogin&&"1066"==e.ErrorCode&&(E.verifyOTP=u||E.verifyOTP,E.resendOTP=c||E.resendOTP,E.verifyOTP(o,i,n,a,l,s,r),E.resendOTP(o,i,n,a,l,P.options.isVoiceOtp,s,r)):E.otpEmailVerification(i,n,a,l,o),a(E.loginRadiusErrorTojsError(e))):(P.askPinOnLogin=!1,t=e.Profile,P.options.isPINAuthentication&&t&&(P.options.PINConfiguration.AskOnlyOnFirstLogin&&t.FirstLogin||P.options.PINConfiguration.AskOnLogin)&&(null!==t.PIN&&t.PIN.PIN||(P.askPinOnLogin=!0)),A.handleFeatures(e,o,r,s,n,a,l))},"login")},A.loginOTPController=function(e,o,i,n,a,t){var s,r,l=e=P.util.checkPhoneOrEmailLogin(e);(l="string"==typeof e||e instanceof String?P.util.parseQueryString(e):l).email||l.username?E.sendInstantSignInLink(e,i,n,o,a):(s=P.options.smsTemplateInstantOTPLogin||P.options.passwordlessLoginSMSTemplate,P.$hooks.register("beforeFormRender",function(e,t){P.util.findInSchema(t,"name","resendotp")||(t.push({type:"button",name:"resendotp",display:"Resend via SMS",rules:"",permission:"r",event:"click",eventCallback:function(e){P.options.disableResendOTPButton&&P.util.disableResendOTPButton(e),e={data:l.phone,onsuccess:i,onerror:n,smstemplate:s,action:"smartLoginResendOTP"},E.resendOTPHandler(e)}}),P.options.isVoiceOtp&&t.push({type:"button",name:"resendvoiceotp",display:"Resend via Voice call",rules:"",permission:"r",event:"click",eventCallback:function(e){P.options.disableResendOTPButton&&P.util.disableResendOTPButton(e),e={data:l.phone,onsuccess:i,onerror:n,smstemplate:s,voiceotp:!0,action:"smartLoginResendOTP"},E.resendOTPHandler(e)}}))}),r=function(){var e=P.otpSchema;E.createForm(e,"otp",o,function(e){var t=a+LoginRadiusDefaults.idPrefix+"recaptcha_widget_verifyotp";A.verifyInstantOTP(e,l,i,n,t,o,a)},function(e){n(E.setMappedMessage(e))},a)},t?r():P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/login/passwordlesslogin/otp?apiKey="+P.options.apiKey+"&phone="+l.phone+"&smsTemplate="+s,"",function(e){e.ErrorCode?n(E.loginRadiusErrorTojsError(e)):(i(e),r())},"loginOTP"))},A.loginPINController=function(t,e,o,i,n,a,s,r){P.options.verificationEmailTemplate=P.options.emailTemplate||P.options.verificationEmailTemplate,("string"==typeof t||t instanceof String)&&(t=P.util.parseQueryString(t)),r=LoginRadiusDefaults.apiDomain+"/auth/login/pin?apiKey="+P.options.apiKey+"&session_token="+r,P.util.ajaxCall("post",r,t,function(e){e.ErrorCode?i(E.loginRadiusErrorTojsError(e)):A.handleFeatures(e,t,s,a,o,i,n)},"login")},A.login2FAController=function(o,f,h,y,C,v,w,T,S,k){P.LRCheck2FA=!0,o=P.util.checkPhoneOrEmailLogin(o);var e,L=!1,b=!1,R=function(r,e){var t,o,n=e.IsOTPAuthenticatorVerified||"",l=e.IsAuthenticatorVerified||"",u=e.IsDuoAuthenticatorVerified||"",c=e.IsEmailOtpAuthenticatorVerified||"",p=e.IsSecurityQuestionAuthenticatorVerified||"",d=e.IsPushDeviceRegistered||"",m=e.IsPasskeyAuthenticatorVerified||"",i=(null!==e.EmailOTPStatus||n||l||p||d||(b=!0),P.$hooks.register("afterFormRender",function(e,t,o,i){var n=i?P.util.findInSchema(i,"id","loginradius-button-backupcodebackbutton"):P.util.elementById("loginradius-button-backupcodebackbutton");(i=i||P.util.elementById(t))&&P.LRCheck2FA&&(n||(t=P.util.getButtonAttribute("backupcodebackbutton",o,function(){b=!0,R(r,r.SecondFactorAuthentication)}),i.appendChild(t)))}),P.util.getButtonAttribute("otpauthenticator",C)),g=!1,a=P.options.authenticatorOptionsOrder;for(t in a)if(a[t])if("emailotp"===a[t])!function(){var a,s,e;!P.options.emailOTPAuthentication||(l||d||n||p||u||!P.options.twoFactorAuthentication||m)&&!c||r.SecondFactorAuthentication&&r.SecondFactorAuthentication.Email&&r.SecondFactorAuthentication.Email.length&&(L=!0,a=r.SecondFactorAuthentication.Email)&&(s=function(e){E.addResendOTPBtn(L,h,y),b||p||l||n||d?A.sendMFAEmailOTPController({EmailId:e},h,y,f,C):E.verifyOTP({mfaEmailToken:!0,EmailId:e},f,h,y,C)},LoginRadiusDefaults.innerHTML=!0,e=P.util.getButtonAttribute("emailotp",C,function(e){if(1<a.length){LoginRadiusDefaults.innerHTML=!1;for(var t,o=[],i=0;i<a.length;i++)a[i]&&((t={}).text=a[i],t.value=a[i],o.push(t));var n={type:"option"};n.options=o,n.name="sendemailotp",n.rules="required",n.display="Select email to send verification code",E.createForm([n],"mfaselectemails",f,function(e){e=P.util.parseQueryString(e),s(e.sendemailotp)})}else r.SecondFactorAuthentication.Email&&r.SecondFactorAuthentication.Email[0]&&s(r.SecondFactorAuthentication.Email[0])}),P.util.addHTMLContent(f,e,g),g=!0)}();else if("sms"===a[t])o=void 0,!P.options.smsOTPAuthentication||(p||d||c||l||u||m||!P.options.twoFactorAuthentication)&&!n?(p||d||l||c||!P.options.twoFactorAuthentication)&&(!P.options.optionalTwoFactorAuthentication||n||p||d||l||c||""===r.SecondFactorAuthentication.OTPPhoneNo||null==r.SecondFactorAuthentication.OTPPhoneNo)&&!n||(C=C||LoginRadiusDefaults.classPrefix,o=document.getElementsByName(C+"showQRcode")[0],P.options.qrCodeAuthentication&&o&&o.appendChild(i)):r.SecondFactorAuthentication.OTPPhoneNo?(P.util.addHTMLContent(f,i,g),g=!0):P.options.qrCodeAuthentication||P.options.emailOTPAuthentication||P.options.securityQuestionAuthentication||P.options.pushNotificationAuthentication||P.options.duoAuthentication||P.options.passkeyAuthentication?(o=P.util.getButtonAttribute("otpauthenticator",C,function(){LoginRadiusDefaults.innerHTML=!1,E.updatePhoneNumber=T||E.updatePhoneNumber,E.updatePhoneNumber(f,h,y,C,"",v,w)}),P.util.addHTMLContent(f,o,g),g=!0):(E.updatePhoneNumber=T||E.updatePhoneNumber,E.updatePhoneNumber(f,h,y,C,"",v,w));else if("securityquestion"===a[t])o=void 0,P.options.securityQuestionAuthentication&&(!(c||d||l||n||u||m)&&P.options.twoFactorAuthentication||p)&&(o=P.util.getButtonAttribute("securityquestionsauthenticator",C,function(){LoginRadiusDefaults.innerHTML=!1,E.showMFASecurityQuestions(r.SecondFactorAuthentication,f,h,y,C,v,w)}),P.util.addHTMLContent(f,o,g),g=!0);else if("auth"===a[t]||"googleauth"===a[t])s=void 0,P.options.qrCodeAuthentication&&(!(c||d||n||p||u||m)&&P.options.twoFactorAuthentication||l)&&(s=P.util.getButtonAttribute("googleauthenticator",C,function(){LoginRadiusDefaults.innerHTML=!1,E.showQRCode(r,f,h,y,C,v,w)}),P.util.addHTMLContent(f,s,g),g=!0);else if("pushnotification"===a[t])!function(){var e=!p&&!c&&!n&&!l&&!u&&!m&&P.options.twoFactorAuthentication;if(P.options.pushNotificationAuthentication&&(e||d)){let t=r.SecondFactorAuthentication.SecondFactorAuthenticationToken;var o=function(e){E.loginHandleToken(e,"",h,y,"",!0)},i=P.util.getButtonAttribute("pushnotification",C,function(e){P.util.disableResendOTPButton(e),!d&&r.SecondFactorAuthentication&&r.SecondFactorAuthentication.PushQRCode?((e=document.createElement("img")).type="image",e.src=r.SecondFactorAuthentication.PushQRCode,P.util.addHTMLContent(f,e,!1),P.$hooks.call("afterFormRender","login",f,C),LoginRadiusDefaults.innerHTML=!1):E.resendPushNotification(t,o,y),!d&&LoginRadiusDefaults.pingCount<=1&&t&&E.pingForPushNotification(t,o,y)});e&&d&&LoginRadiusDefaults.pingCount<=1&&t&&E.pingForPushNotification(t,o,y),P.util.addHTMLContent(f,i,g),g=!0}}();else if("duomfa"===a[t]){if(s=void 0,P.options.duoAuthentication&&(!l&&!d&&!n&&!p&&!c&&!m&&P.options.twoFactorAuthentication||u)){let t=r.SecondFactorAuthentication.DuoAuthEndpoint;var s=P.util.getButtonAttribute("duomfa",C,function(e){window.location.href=t});P.util.addHTMLContent(f,s,g),g=!0}}else"passkey"===a[t]&&!function(){let t=r.SecondFactorAuthentication.SecondFactorAuthenticationToken,e;P.options.passkeyAuthentication&&(!(l||d||n||p||c||u)&&P.options.twoFactorAuthentication||m)&&(e=P.util.getButtonAttribute("passkeyauthenticator",C),P.util.addHTMLContent(f,e,g),g=!0,P.util.addEvent("click",e,function(e){m?E.loginMFAPasskey(t,h,y):E.createMFAPasskey(t,h,y)}))}();(d||p||c||n||l||u||m)&&(e=P.util.getButtonAttribute("backupcodebutton",C),P.util.addHTMLContent(f,e,g),P.util.addEvent("click",e,function(e){var t,o,i,n,a;LoginRadiusDefaults.innerHTML=!1,t=h,o=y,i=C,n=v,a=w,E.createForm(P.backupCodeFormSchema,"backupcode",f,function(e){A.backupCodeController(e,t,o,n,a)},function(e){o(e)},i)})),P.util.addEvent("click",i,function(e){var t="phoneNo2FA="+r.SecondFactorAuthentication.OTPPhoneNo;LoginRadiusDefaults.innerHTML=!1,L=!1,(p||l||c||d||u||m||b)&&E.resendOTPManually(t,h,y,C,P.options.isVoiceOtp),r.phone=r.SecondFactorAuthentication.OTPPhoneNo,E.verifyOTP=S||E.verifyOTP,E.resendOTP=k||E.resendOTP,E.verifyOTP(r,f,h,y,C,v,w),E.resendOTP(r,f,h,y,C,P.options.isVoiceOtp,v,w)})},t=LoginRadiusDefaults.apiDomain+"/auth/login/",i=(P.options.verificationEmailTemplate=P.options.emailTemplate||P.options.verificationEmailTemplate,"post"),n=window.lrbackupcode?(t=t+"backupcode?apiKey="+P.options.apiKey+"&"+o,i="get",""):(t=t+"?apiKey="+P.options.apiKey+"&loginUrl="+P.options.loginUrl+"&emailTemplate="+P.options.verificationEmailTemplate+"&verificationUrl="+P.options.verificationUrl+"&smsTemplate="+P.options.smsTemplateWelcome+"&smsTemplate2FA="+P.options.smsTemplate2FA+"&EmailTemplate2FA="+P.options.EmailTemplate2FA,P.options.duoAuthentication&&(t=t+"&duoredirecturi="+encodeURIComponent(P.options.callbackUrl)),P.util.parseQueryString(o));P.options.isB2BEnabled&&"orginvite"===P.util.getHashParam("vtype")&&(e=P.util.getHashParam("vtoken"))&&(t+="&invitation_token="+e),P.util.ajaxCall(i,t,n,function(e){var t;P.options.stayLogin&&P.storage.setBrowserStorage("lr-rememberme",P.util.getQueryParameterByName("stayLogin",o)),e.ErrorCode?("970"==e.ErrorCode&&E.showOTPTemplateForm("Registration")?E.otpEmailVerification(f,h,y,C,o):P.options.phoneLogin&&"1066"==e.ErrorCode&&(t="phone="+P.util.getQueryParameterByName("phone",o),t+="&noPhoneVerified=false",P.options.optionalTwoFactorAuthentication=!1,P.options.twoFactorAuthentication=!1,E.verifyOTP=S||E.verifyOTP,E.resendOTP=k||E.resendOTP,E.verifyOTP(t,f,h,y,C,v,w),E.resendOTP(t,f,h,y,C,P.options.isVoiceOtp,v,w)),y(E.loginRadiusErrorTojsError(e))):(e.SecondFactorAuthentication?(P.storage.setBrowserStorage(LoginRadiusDefaults.storedTwoFAToken,e.SecondFactorAuthentication.SecondFactorAuthenticationToken),P.storage.setBrowserStorage(LoginRadiusDefaults.storedOTPAuth,e.SecondFactorAuthentication.IsOTPAuthenticatorVerified),"00000000-0000-0000-0000-000000000000"===e.access_token&&(R(e,e.SecondFactorAuthentication),delete e.access_token,h(e,o))):A.handleFeatures(e,o,w,v,h,y,C),P.lrApiFramework&&h(e))},"login")},A.resendOTPController=function(e,t,o,i,n){let a="";n&&(a="&isvoiceotp=true");var s=e.updatePhone?P.options.smsTemplateUpdatePhone:P.options.smsTemplatePhoneVerification,s=LoginRadiusDefaults.apiDomain+"/auth/phone/otp?apiKey="+P.options.apiKey+"&smsTemplate="+s+a;e.onetouchloginflag&&("string"!=typeof e&&(e=P.util.jsonToQueryString(e)),s=LoginRadiusDefaults.apiDomain+"/auth/onetouchlogin/phone?apikey="+P.options.apiKey+"&"+e+"&smstemplate="+P.options.smsTemplatePhoneVerification+a),P.util.ajaxCall("post",s,e,function(e){e.ErrorCode?o(E.loginRadiusErrorTojsError(e)):(P.log(C.otpSent),t(e))},n?"resendvoiceotp":"resendOTP")},A.resendOTP2FAController=function(e,t,o,i,n){var a=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTwoFAToken),s=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),r=n?"&isvoiceotp=true":"";s&&!P.LRCheckLogin?P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/account/2FA?apiKey="+P.options.apiKey+"&access_token="+s+"&smsTemplate="+P.options.smsTemplate2FA+r,e,function(e){e.ErrorCode?o(E.loginRadiusErrorTojsError(e)):(P.log(C.otpSent),t(e))},n?"resendvoiceotp":"resendOTP"):a?P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/login/2FA/resend?apiKey="+P.options.apiKey+"&SecondFactorAuthenticationToken="+a+"&smsTemplate2FA="+P.options.smsTemplate2FA+r,"",function(e){e.ErrorCode?o(E.loginRadiusErrorTojsError(e)):P.log(C.otpSent)},n?"resendvoiceotp":"resendOTP"):o([E.setMappedMessage(C.twofaTokenValid)])},A.verify2FAOTPController=function(t,o,i,n,a){var e=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),s=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTwoFAToken),r=!1,l=(t&&"string"==typeof t&&(r=-1!==t.indexOf("mfaEmailToken=true")),P.util.parseQueryString(t)),u=r?"twofaemailotp":"twofaotp",c="otp";r?(c="otp/email",l.emailid=l.email,delete l.email):"AuthenticatorCode"in l&&(c="authenticatorcode"),e&&!P.LRCheckLogin?P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/account/2fa/verification/"+c+"?apiKey="+P.options.apiKey+"&access_token="+e,l,function(e){e.ErrorCode?i(E.loginRadiusErrorTojsError(e)):o(e,t)},"verifyOTP##"+u):s?(r="",P.options.riskBasedAuthentication&&(r=(r+="&RbaOneclickEmailTemplate="+P.options.rbaOneclickEmailTemplate+"&RbaOTPSmsTemplate="+P.options.rbaOTPSmsTemplate+"&RbaCityEmailTemplate="+P.options.rbaCityEmailTemplate+"&RbaCountryEmailTemplate="+P.options.rbaCountryEmailTemplate+"&RbaBrowserEmailTemplate="+P.options.rbaBrowserEmailTemplate+"&RbaIpEmailTemplate="+P.options.rbaIpEmailTemplate+"&RbaDeviceEmailTemplate="+P.options.rbaDeviceEmailTemplate+"&RbaCitySmsTemplate="+P.options.rbaCitySmsTemplate+"&RbaCountrySmsTemplate="+P.options.rbaCountrySmsTemplate)+"&RbaBrowserSmsTemplate="+P.options.rbaBrowserSmsTemplate+"&RbaIpSmsTemplate="+P.options.rbaIpSmsTemplate+"&RbaDeviceSmsTemplate="+P.options.rbaDeviceSmsTemplate),"otp"===c&&(r+="&smsTemplate2FA="+P.options.smsTemplate2FAWelcome),P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/login/2fa/verification/"+c+"?apiKey="+P.options.apiKey+"&SecondFactorAuthenticationToken="+s+r,l,function(e){e.ErrorCode?i(E.loginRadiusErrorTojsError(e)):A.handleFeatures(e,t,a,n,o,i)},"verifyOTP##"+("authenticatorcode"===c?"showqrcode":u))):i([E.setMappedMessage(C.twofaTokenValid)])},A.backupCodeController=function(t,o,i,n,a){var e,s,r=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTwoFAToken);r?(e=P.util.parseQueryString(t),s="",P.options.riskBasedAuthentication&&(s=(s+="&RbaOneclickEmailTemplate="+P.options.rbaOneclickEmailTemplate+"&RbaOTPSmsTemplate="+P.options.rbaOTPSmsTemplate+"&RbaCityEmailTemplate="+P.options.rbaCityEmailTemplate+"&RbaCountryEmailTemplate="+P.options.rbaCountryEmailTemplate+"&RbaBrowserEmailTemplate="+P.options.rbaBrowserEmailTemplate+"&RbaIpEmailTemplate="+P.options.rbaIpEmailTemplate+"&RbaDeviceEmailTemplate="+P.options.rbaDeviceEmailTemplate+"&RbaCitySmsTemplate="+P.options.rbaCitySmsTemplate+"&RbaCountrySmsTemplate="+P.options.rbaCountrySmsTemplate)+"&RbaBrowserSmsTemplate="+P.options.rbaBrowserSmsTemplate+"&RbaIpSmsTemplate="+P.options.rbaIpSmsTemplate+"&RbaDeviceSmsTemplate="+P.options.rbaDeviceSmsTemplate),P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/login/2FA/verification/backupcode?apiKey="+P.options.apiKey+"&SecondFactorAuthenticationToken="+r+"&smsTemplate2FA="+P.options.smsTemplate2FAWelcome+s,e,function(e){e.ErrorCode?i(E.loginRadiusErrorTojsError(e)):A.handleFeatures(e,t,a,n,o,i)},"login")):i([E.setMappedMessage(C.twofaTokenValid)])},A.passkeyLoginController=function(e,t,o,i,n,a,s){var r=P.util.parseQueryString(e),l=(P.options.verificationEmailTemplate=P.options.emailTemplate||P.options.verificationEmailTemplate,"emailTemplate="+P.options.verificationEmailTemplate+"&verificationUrl="+P.options.verificationUrl),e=r.autofill?LoginRadiusDefaults.apiDomain+"/auth/login/passkey/autofill/begin?apiKey="+P.options.apiKey:LoginRadiusDefaults.apiDomain+"/auth/login/passkey/begin?apiKey="+P.options.apiKey+"&identifier="+r.email+"&"+l;P.util.ajaxCall("get",e,{},function(e){e.ErrorCode?i(E.loginRadiusErrorTojsError(e)):P.util.getPassKeyCredentials(e.LoginBeginCredential,r.autofill).then(e=>{A.passkeyFinishController(e,l,r,t,o,i,n,a,s)}).catch(e=>{i(E.loginRadiusErrorTojsError(e))})})},A.passkeyFinishController=function(e,t,o,i,n,a,s,r,l){var u=e.response.authenticatorData,c=e.response.clientDataJSON,p=e.rawId,d=e.response.signature,m=e.response.userHandle,p={email:o.email,PasskeyCredential:{id:e.id,rawId:P.util.base64UrlEncode(p),type:e.type,authenticatorAttachment:e.authenticatorAttachment,response:{authenticatorData:P.util.base64UrlEncode(u),clientDataJSON:P.util.base64UrlEncode(c),signature:P.util.base64UrlEncode(d),userHandle:P.util.base64UrlEncode(m)}}};P.options.riskBasedAuthentication&&(t=(t+="&RbaOneclickEmailTemplate="+P.options.rbaOneclickEmailTemplate+"&RbaOTPSmsTemplate="+P.options.rbaOTPSmsTemplate+"&RbaCityEmailTemplate="+P.options.rbaCityEmailTemplate+"&RbaCountryEmailTemplate="+P.options.rbaCountryEmailTemplate+"&RbaBrowserEmailTemplate="+P.options.rbaBrowserEmailTemplate+"&RbaIpEmailTemplate="+P.options.rbaIpEmailTemplate+"&RbaDeviceEmailTemplate="+P.options.rbaDeviceEmailTemplate+"&RbaCitySmsTemplate="+P.options.rbaCitySmsTemplate+"&RbaCountrySmsTemplate="+P.options.rbaCountrySmsTemplate)+"&RbaBrowserSmsTemplate="+P.options.rbaBrowserSmsTemplate+"&RbaIpSmsTemplate="+P.options.rbaIpSmsTemplate+"&RbaDeviceSmsTemplate="+P.options.rbaDeviceSmsTemplate),P.options.isB2BEnabled&&"orginvite"===P.util.getHashParam("vtype")&&(e=P.util.getHashParam("vtoken"))&&(t+="&invitation_token="+e);let g=LoginRadiusDefaults.apiDomain+"/auth/login/passkey/finish?apiKey="+P.options.apiKey+"&loginUrl="+P.options.loginUrl+"&"+t;o.autofill&&(g=LoginRadiusDefaults.apiDomain+"/auth/login/passkey/autofill/finish?apiKey="+P.options.apiKey+"&loginUrl="+P.options.loginUrl),P.util.ajaxCall("post",g,p,function(e){P.options.stayLogin&&P.storage.setBrowserStorage("lr-rememberme",o.stayLogin),e.ErrorCode?("970"!=e.ErrorCode||P.options.verifyEmailByOTP||E.otpEmailVerification(i,n,a,l,o),a(E.loginRadiusErrorTojsError(e))):A.handleFeatures(e,o,r,s,n,a,l)},"login")},A.passkeyRegistrationController=function(n,a,s,r,l,i){var e=P.util.getQueryParameterByName("email",n);P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/register/passkey/begin?apiKey="+P.options.apiKey+"&identifier="+e,n,function(e){e.ErrorCode?r(E.loginRadiusErrorTojsError(e)):P.util.createPassKeyCredentials(e.RegisterBeginCredential).then(e=>{let t={};(t=P.lrApiFramework?t:E.mapRegistrationSchema(i,n)).PasskeyCredential={id:e.id,rawId:P.util.base64UrlEncode(e.rawId),type:e.type,response:{attestationObject:P.util.base64UrlEncode(e.response.attestationObject),clientDataJSON:P.util.base64UrlEncode(e.response.clientDataJSON)}};var e=P.options.welcomeEmailTemplate,o=P.util.getHashParam("welcomeemailtemplate"),o="emailTemplate="+P.options.verificationEmailTemplate+"&verificationUrl="+P.options.verificationUrl+"&welcomeEmailTemplate="+(e=o||e),e=(P.options.preventVerificationEmail&&(o+="&options=PreventVerificationEmail"),P.options.isB2BEnabled&&"orginvite"===P.util.getHashParam("vtype")&&(e=P.util.getHashParam("vtoken"))&&(o+="&invitation_token="+e),LoginRadiusDefaults.apiDomain+"/auth/register/passkey/finish?apiKey="+P.options.apiKey+"&"+o);P.util.ajaxCall("post",e,t,function(o){let i=P.util.parseQueryString(n);(o=o&&P.util.isObject(o)?P.util.keyslowerToUpperCamelCase(o):o).ErrorCode?r(E.loginRadiusErrorTojsError(o)):o.Data?(delete(o=o.Data).Data,delete o.IsPosted,P.options.askRequiredFieldForTraditionalLogin=!1,P.options.disabledEmailVerification||o.Profile&&o.Profile.EmailVerified||!E.showOTPTemplateForm("Registration")?E.loginHandleToken(o,n,s,r):(P.$hooks.register("beforeFormRender",function(e,t){"otp"!==e||P.util.findInSchema(t,"name","skip")||t.push({type:"button",name:"skip",display:"Skip",rules:"",permission:"r",event:"click",eventCallback:function(e){E.loginHandleToken(o,i,s,r)}})}),E.otpEmailVerification(a,function(e){e.access_token?E.loginHandleToken(e,n,s,r):E.loginHandleToken(o,n,s,r)},r,l,i))):(s(o,i),E.showOTPTemplateForm("Registration")&&E.otpEmailVerification(a,s,r,l,i))},"registration")}).catch(e=>{r(E.loginRadiusErrorTojsError(e))})},"passkeyRegister")},A.checkPhoneNumberAvailabilityController=function(e,t,o){P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/phone?apiKey="+P.options.apiKey+"&"+e,"",function(e){e.ErrorCode?o(E.loginRadiusErrorTojsError(e)):t(e)},"checkPhone")},A.update2FAPhoneNumberController=function(t,o,i,n,a,s,r,l,u){var e=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTwoFAToken),c=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);c&&!P.LRCheckLogin?P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/account/2FA?apiKey="+P.options.apiKey+"&access_token="+c+"&smsTemplate="+P.options.smsTemplate2FA,t,function(e){e.ErrorCode?n(E.loginRadiusErrorTojsError(e)):(E.verifyOTP=l||E.verifyOTP,E.resendOTP=u||E.resendOTP,E.verifyOTP(t,o,i,n,a,s,r),E.resendOTP(t,o,i,n,a,P.options.isVoiceOtp,s,r),i(e,t))},"updatePhone"):e?P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/login/2FA/?apiKey="+P.options.apiKey+"&SecondFactorAuthenticationToken="+e+"&smsTemplate2FA="+P.options.smsTemplate2FA,t,function(e){e.ErrorCode?n(E.loginRadiusErrorTojsError(e)):(i(e,t),E.verifyOTP=l||E.verifyOTP,E.resendOTP=u||E.resendOTP,E.verifyOTP(t,o,i,n,a,s,r),E.resendOTP(t,o,i,n,a,P.options.isVoiceOtp,s,r))},"login"):n([E.setMappedMessage(C.twofaTokenValid)])},A.updatePhoneNumberController=function(t,o,i,n,a,s,r,l,u){var e=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);E.isValidToken(e,n)&&P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/phone?apiKey="+P.options.apiKey+"&access_token="+e+"&smsTemplate="+P.options.smsTemplateUpdatePhone,t,function(e){e.ErrorCode?n(E.loginRadiusErrorTojsError(e)):(E.verifyOTP=l||E.verifyOTP,E.resendOTP=u||E.resendOTP,E.verifyOTP(t+"&haveToken=true",o,i,n,a,s,r),E.resendOTP(t+"&updatePhone=true",o,i,n,a,P.options.isVoiceOtp,s,r,!0),i(e,t))},"updatePhone")},A.resetPasswordByPhoneController=function(t,o,i,e,n){P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/password/otp?apiKey="+P.options.apiKey+"&smsTemplate="+P.options.smsTemplateWelcome,t,function(e){e.ErrorCode?i(E.loginRadiusErrorTojsError(e)):P.options.loginOnPasswordReset&&e.Data&&e.Data.access_token?E.loginHandleToken(e.Data,"",o,i):o(e,t)},"resetPassword")},A.resetPINByPhoneController=function(t,o,i,e,n){P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/pin/reset/otp/phone?apiKey="+P.options.apiKey+"&smsTemplate="+P.options.smsTemplateWelcome,t,function(e){e.ErrorCode?i(E.loginRadiusErrorTojsError(e)):o(e,t)},"resetPIN")},A.forgotPasswordbyPhoneController=function(t,o,i,n,a,e,s){P.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/password/otp?apiKey="+P.options.apiKey+"&smsTemplate="+P.options.smsTemplateForgot+(e?"&isvoiceotp=true":""),t,function(e){e.ErrorCode?n(E.loginRadiusErrorTojsError(e)):(i(e,t),(s||E.resetPassword)(o,i,n,a))},"forgotPassword")},A.forgotPINbyPhoneController=function(t,o,i,n,a,e,s){P.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/pin/forgot/otp?apiKey="+P.options.apiKey+"&smsTemplate="+P.options.smsTemplateForgot+(e?"&isvoiceotp=true":""),t,function(e){e.ErrorCode?n(E.loginRadiusErrorTojsError(e)):(i(e,t),(s||E.resetPIN)(o,i,n,a))},"forgotPIN")},A.registrationController=function(i,n,a,s,r,e,l,u){P.LRCheckRegistration=!0;var t=i,e=(P.lrApiFramework||(t=E.mapRegistrationSchema(e,i)),P.options.welcomeEmailTemplate),o=P.util.getHashParam("welcomeemailtemplate"),o="emailTemplate="+P.options.verificationEmailTemplate+"&verificationUrl="+P.options.verificationUrl+"&welcomeEmailTemplate="+(e=o||e),e=(P.options.phoneLogin&&(o+="&smsTemplate="+P.options.smsTemplatePhoneVerification),P.options.preventVerificationEmail&&(o+="&options=PreventVerificationEmail"),P.options.isB2BEnabled&&"orginvite"===P.util.getHashParam("vtype")&&(e=P.util.getHashParam("vtoken"))&&(o+="&invitation_token="+e),"");P.options.isCaptchaEnabled||P.options.v2Recaptcha||P.options.invisibleRecaptcha||P.options.tencentCaptcha?e=LoginRadiusDefaults.apiDomain+"/auth/register/captcha?apiKey="+P.options.apiKey+"&"+o:P.options.sott?(e=LoginRadiusDefaults.apiDomain+"/auth/register?apiKey="+P.options.apiKey+"&"+o,P.options.enableHeaderSott?(P.options.sott=decodeURIComponent(P.options.sott),t.sottcheck=!0):e+="&sott="+P.util.encodedString(P.options.sott)):P.options.vNextUX?P.log("SOTT commonOption is missing in configuration. You can use a static SOTT generated from Admin Console or create it at run-time using the API. For more details on SOTT generation, please refer to https://www.loginradius.com/docs/api/v2/customer-identity-api/sott-usage/."):P.log("url is not set as sott option is not defined"),""!==e&&P.util.ajaxCall("post",e,t,function(t){var o,e;(t=t&&P.util.isObject(t)?P.util.keyslowerToUpperCamelCase(t):t).ErrorCode?1049===t.ErrorCode?(P.options.vNextUX&&(C.invalidSott="An error occurred, please refresh the page to proceed with registration."),s([E.setMappedMessage(C.invalidSott)]),P.log(t.Description)):s(E.loginRadiusErrorTojsError(t)):(o=function(e){e.push({type:"button",name:"skip",display:"Skip",rules:"",permission:"r",event:"click",eventCallback:function(e){E.loginHandleToken(t,i,a,s)}})},P.options.phoneLogin&&("string"==typeof i||i instanceof String)&&-1!==i.indexOf("phoneid")?(-1===P.util.findInSchema(P.registrationFormSchema,"name","phoneid").rules.indexOf("required")&&P.$hooks.register("beforeFormRender",function(e,t){"otp"!==e||P.util.findInSchema(t,"name","skip")||o(t)}),E.verifyOTP=l||E.verifyOTP,E.resendOTP=u||E.resendOTP,E.verifyOTP(i,n,a,s,r),E.resendOTP(i,n,a,s,r,P.options.isVoiceOtp)):(e=P.util.parseQueryString(i),t.Data?(delete(t=t.Data).Data,delete t.IsPosted,P.options.askRequiredFieldForTraditionalLogin=!1,P.options.disabledEmailVerification||t.Profile&&t.Profile.EmailVerified||!E.showOTPTemplateForm("Registration")?E.loginHandleToken(t,i,a,s):(P.$hooks.register("beforeFormRender",function(e,t){"otp"!==e||P.util.findInSchema(t,"name","skip")||o(t)}),E.otpEmailVerification(n,function(e){e.access_token?E.loginHandleToken(e,i,a,s):E.loginHandleToken(t,i,a,s)},s,r,e))):(a(t,e),E.showOTPTemplateForm("Registration")&&E.otpEmailVerification(n,a,s,r,e))))},"registration")},A.periodicalPasswordRestController=function(e,t,o,i,n,a){P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/password/change?apiKey="+P.options.apiKey+"&access_token="+n.access_token,e,function(e){e.ErrorCode?o(E.loginRadiusErrorTojsError(e)):E.loginHandleToken(n,a,t,o)},"periodicPassword")},A.changePasswordController=function(t,o,i){P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/password/change?apiKey="+P.options.apiKey+"&access_token="+P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),t,function(e){e.ErrorCode?i(E.loginRadiusErrorTojsError(e)):o(e,P.util.parseQueryString(t))},"changePassword")},A.changePINController=function(t,o,i){P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/pin/change?apiKey="+P.options.apiKey+"&access_token="+P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),t,function(e){e.ErrorCode?i(E.loginRadiusErrorTojsError(e)):o(e,P.util.parseQueryString(t))},"changePIN")},A.resendEmailVerificationController=function(t,o,i){P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/register?apiKey="+P.options.apiKey+"&verificationUrl="+P.options.verificationUrl+"&emailTemplate="+P.options.verificationEmailTemplate,t,function(e){e.ErrorCode?i(E.loginRadiusErrorTojsError(e)):(o(e,P.util.parseQueryString(t)),E.showOTPTemplateForm("Registration")&&P.currentLRContainer&&E.otpEmailVerification(P.currentLRContainer,o,i,"",t))},"resendVerificationEmail")},A.addEmailController=function(t,o,i){var e=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);E.isValidToken(e,i)&&P.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/email?apiKey="+P.options.apiKey+"&access_token="+e+"&verificationUrl="+P.options.verificationUrl+"&emailTemplate="+P.options.addEmailTemplate,t,function(e){e.ErrorCode?i(E.loginRadiusErrorTojsError(e)):(o(e,P.util.parseQueryString(t)),E.showOTPTemplateForm("AddEmail")&&E.otpEmailVerification(P.currentLRContainer,o,i,"",t))},"addEmail")},A.removeEmailController=function(t,o,i){var e=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);E.isValidToken(e,i)&&P.util.ajaxCall("delete",LoginRadiusDefaults.apiDomain+"/auth/email?apiKey="+P.options.apiKey+"&access_token="+e,t,function(e){e.ErrorCode?i(E.loginRadiusErrorTojsError(e)):o(e,P.util.parseQueryString(t))},"removeEmail")},A.changeUsernameController=function(t,o,i){var e=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);E.isValidToken(e,i)&&P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/username?apiKey="+P.options.apiKey+"&access_token="+e,t,function(e){e.ErrorCode?i(E.loginRadiusErrorTojsError(e)):o(e,P.util.parseQueryString(t))},"changeUsername")},A.resetPasswordController=function(t,o,i,e,n){t+="&welcomeEmailTemplate="+P.options.welcomeEmailTemplate+"&ResetPasswordEmailTemplate="+P.options.resetPasswordConfirmationEmailTemplate,P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/password/reset?apiKey="+P.options.apiKey,t,function(e){e.ErrorCode?i(E.loginRadiusErrorTojsError(e)):P.options.loginOnPasswordReset&&e.Data&&e.Data.access_token?E.loginHandleToken(e.Data,"",o,i):o(e,P.util.parseQueryString(t))},"resetPassword")},A.duoVerifyController=function(e,t,o,i,n){var a=LoginRadiusDefaults.apiDomain+"/auth/login/2fa/verification/duo?apiKey="+P.options.apiKey+"&SecondFactorAuthenticationToken="+P.storage.getBrowserStorage(LoginRadiusDefaults.storedTwoFAToken);P.util.ajaxCall("put",a,e,function(e){P.duoLoginFlag=!1,e.ErrorCode?o(E.loginRadiusErrorTojsError(e)):E.loginHandleToken(e,"",t,o)},"login")},A.duoVerifyByAccessTokenController=function(e,t,o,i,n){var a=LoginRadiusDefaults.apiDomain+"/auth/account/2fa/verification/duo?apiKey="+P.options.apiKey+"&access_token="+P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);P.util.ajaxCall("put",a,e,function(e){P.duoLoginFlag=!1,e.ErrorCode?o(E.loginRadiusErrorTojsError(e)):t(e)},"duoVerifyByAccessToken")},A.resetPINController=function(t,o,i,e,n){var a=P.util.parseQueryString(t),a=a.hasOwnProperty("resettoken")?LoginRadiusDefaults.apiDomain+"/auth/pin/reset/token?apiKey="+P.options.apiKey:(a=a.hasOwnProperty("username")?"username":"email",LoginRadiusDefaults.apiDomain+"/auth/pin/reset/otp/"+a+"?apiKey="+P.options.apiKey);t+="&welcomeEmailTemplate="+P.options.welcomeEmailTemplate+"&ResetPINEmailTemplate="+P.options.resetPINConfirmationEmailTemplate,P.util.ajaxCall("put",a,t,function(e){e.ErrorCode?i(E.loginRadiusErrorTojsError(e)):o(e,P.util.parseQueryString(t))},"resetPIN")},A.emailVerificationController=function(e,t,o,i,n,a){var s,r,l,u="get";e?(s=LoginRadiusDefaults.apiDomain+"/auth/email?apiKey="+P.options.apiKey+"&welcomeEmailTemplate="+P.options.welcomeEmailTemplate,r="",a?(u="put",r=e):s+="&verificationtoken="+e+"&url="+P.options.verificationUrl,"##otp"==(l=P.options.verifyEmailByOTP?"":"##otp")&&(P.currentActionOptions||(P.currentActionOptions={}),P.currentActionOptions.otp={},P.currentActionOptions.otp.onSuccess=t||function(){},P.currentActionOptions.otp.onError=o||function(){},P.currentActionOptions.otp.classPrefix=n||""),("string"!=typeof e&&e.oneClickSignIn||"string"==typeof e&&-1!==e.indexOf("oneClickSignIn=true"))&&P.options.templateVerificationTypes&&"OTP"===P.options.templateVerificationTypes.OneClickSignin?E.passwordlessLoginVerification(e,t,o,n,!0):P.util.ajaxCall(u,s,r,function(e){e.ErrorCode?o(E.loginRadiusErrorTojsError(e)):P.options.loginOnEmailVerification?null==e.Data?t(e):e.Data&&e.Data.access_token?E.loginHandleToken(e.Data,"",t,o):e.Data&&t(e):P.options.logoutOnVerifyEmail?E.logout(t(e)):t(e)},"verifyEmail"+l)):o(a?[C.notFound]:[C.vTokenError])},A.deleteUserConfirmController=function(e,t,o){e?P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account/delete?apiKey="+P.options.apiKey+"&deletetoken="+e,"",function(e){e.ErrorCode?o(E.loginRadiusErrorTojsError(e)):t(e)},"deleteUserConfirm"):o([C.vTokenError])},A.checkEmailAvailabilityController=function(e,t,o){P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/email?apiKey="+P.options.apiKey+"&"+e,"",function(e){e.ErrorCode?o(E.loginRadiusErrorTojsError(e)):t(e)},"checkEmail")},A.checkUserNameAvailabilityController=function(e,t,o){P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/username?apiKey="+P.options.apiKey+"&"+e,"",function(e){e.ErrorCode?o(E.loginRadiusErrorTojsError(e)):t(e)},"checkUsername")},A.resetPasswordBySecurityQuestionController=function(t,o,i){var e=E.sanitizeSecurityQuesData(t);P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/password/securityanswer/?apikey="+P.options.apiKey,e,function(e){e.ErrorCode?i(E.loginRadiusErrorTojsError(e)):P.options.loginOnPasswordReset&&e.Data&&e.Data.access_token?E.loginHandleToken(e.Data,"",o,i):o(e,t)},"resetPasswordBySecurityQuestion")},A.resetPINBySecurityQuestionController=function(t,o,i){var e=E.sanitizeSecurityQuesData(t),n=e.hasOwnProperty("email")?"email":e.hasOwnProperty("phone")?"phone":"username";P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/pin/reset/securityanswer/"+n+"?apikey="+P.options.apiKey,e,function(e){e.ErrorCode?i(E.loginRadiusErrorTojsError(e)):o(e,t)},"resetPINBySecurityQuestion")},A.getSecurityQuestionsController=function(e,t,o){var i="/auth/securityquestion/";-1!==e.indexOf("username")?i+="username?apiKey=":-1!==e.indexOf("phone")?i+="phone?apiKey=":i+="email?apiKey=",P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+i+P.options.apiKey+"&"+e,"",function(e){e.ErrorCode?o(E.loginRadiusErrorTojsError(e)):t(function(e){for(var t=[],o=0;o<e.length;o++){var i={};P.options.maskSensitiveInput?i.type="password":i.type="string",i.name=e[o].QuestionId,i.display=e[o].Question,i.rules="required",i.permission="r",t.push(i)}return t}(e))},"securityQuestion")},A.getBackupCodeController=function(e,t,o){e?P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account/2FA/backupcode?apikey="+P.options.apiKey+"&access_token="+e,"",function(e){e.ErrorCode?o(E.loginRadiusErrorTojsError(e)):t(e)},"backupCode"):o([E.setMappedMessage(C.twofaTokenValid)])},A.resetBackupCodeController=function(e,t,o){e?P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account/2FA/backupcode/reset?apikey="+P.options.apiKey+"&access_token="+e,"",function(e){e.ErrorCode?o(E.loginRadiusErrorTojsError(e)):t(e)},"backupCode"):o([E.setMappedMessage(C.twofaTokenValid)])},A.getSocialDataController=function(e,t,o,i,n){e?(i+="?access_token="+e,P.util.ajaxCall("get",LoginRadiusDefaults.socialApiDomain+(i=n?i+"&"+n:i),"",function(e){e.ErrorCode?o(E.loginRadiusErrorTojsError(e)):t(e)},"socialAPI")):o([E.setMappedMessage(C.twofaTokenValid)])},A.postSocialDataController=function(e,t,o,i,n,a){e?(i+="?access_token="+e,P.util.ajaxCall("post",LoginRadiusDefaults.socialApiDomain+(i=n?i+"&"+n:i),a,function(e){e.ErrorCode?o(E.loginRadiusErrorTojsError(e)):t(e)},"socialAPI")):o([E.setMappedMessage(C.twofaTokenValid)])},A.createCustomObjectController=function(e,t,o,i){e?P.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/customobject?apiKey="+P.options.apiKey+"&access_token="+e+"&objectname="+P.options.customObjectName,t,function(e){e.ErrorCode?i(E.loginRadiusErrorTojsError(e)):o(e)},"createCustomObject"):i([E.setMappedMessage(C.twofaTokenValid)])},A.getCustomObjectByIdController=function(e,t,o,i){n("get",e,t,o,i)},A.getCustomObjectsController=function(e,t,o){e?P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/customobject?apiKey="+P.options.apiKey+"&access_token="+e+"&objectname="+P.options.customObjectName,"",function(e){e.ErrorCode?o(E.loginRadiusErrorTojsError(e)):t(e)},"getCustomObject"):o([E.setMappedMessage(C.twofaTokenValid)])},A.updateCustomObjectController=function(e,t,o,i,n,a){e?P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/customobject/"+t+"?apiKey="+P.options.apiKey+"&access_token="+e+"&objectname="+P.options.customObjectName+(i?"&updatetype="+i:""),o,function(e){e.ErrorCode?a(E.loginRadiusErrorTojsError(e)):n(e)},"updateCustomObject"):a([E.setMappedMessage(C.twofaTokenValid)])},A.deleteCustomObjectController=function(e,t,o,i){n("delete",e,t,o,i)},A.updateData=function(r,l,u,c,p,d,m,e,g){var f=r.Profile||r.Data,h=u,y=(P.lrApiFramework||(h=E.mapRegistrationSchema(m,u,f)),P.options.isPINAuthentication&&!P.options.PINConfiguration.AskOnRegistration&&(h=E.sanitizePinData(h)),r.access_token);g=g||P.setHostedToken,e=e||"updateData",P.options.verificationEmailTemplate=P.options.emailTemplate||P.options.verificationEmailTemplate,0<Object.keys(h).length?P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/account?apiKey="+P.options.apiKey+"&access_token="+y+"&verificationUrl="+P.options.verificationUrl+"&emailTemplate="+P.options.verificationEmailTemplate,h,function(e){var t,o,i,n,a,s;e.ErrorCode?p(E.loginRadiusErrorTojsError(e)):(t=g?function(){r.Data=r.Profile,delete r.Profile,e.Data&&(r.Data=e.Data),E.loginHandleToken(r,u,c,p)}:function(){e.Data&&(e.Profile=e.Data,delete e.Data,delete e.IsPosted),e.access_token?E.loginHandleToken(e,u,c,p):c(e,P.util.parseQueryString(u))},o=h.emailid||h.email,i=h.phone||h.phoneid,n=(n=P.util.findInSchema(m,"name","phoneid"))&&-1!==n.rules.indexOf("required"),a=(a=P.util.findInSchema(m,"name","emailid"))&&-1!==a.rules.indexOf("required"),P.storage.setBrowserStorage(LoginRadiusDefaults.storedUidName,f.Uid),s=P.util.parseQueryString(window.location.search.replace("?","")),(void 0===i||i)&&f.PhoneIdVerified&&void 0===o||(void 0===o||o)&&f.EmailVerified&&void 0===i||(i&&!n||void 0===i)&&(P.options.disabledEmailVerification||P.options.optionalEmailVerification)?o&&!f.EmailVerified&&s.return_url&&-1!==s.return_url.toLowerCase().indexOf("/saml/")?p([E.setMappedMessage(C.emailNotVerified)]):(delete e.IsPosted,e.access_token=y,t(),LoginRadiusDefaults.isSSOInitFired&&E.setToken(y)):i&&f&&!f.PhoneIdVerified?((n=new SetLoginRadiusCommonFunctions(P)).verifyOTP(u,l,c,p,d),n.resendOTP(u+"&noPhoneVerified=false",l,c,p,d),P.options.isVoiceOtp&&n.resendOTP(u+"&noPhoneVerified=false",l,c,p,d,!0)):!o||!a||f.EmailVerified||P.options.disabledEmailVerification||P.options.optionalEmailVerification?t():p([E.setMappedMessage(C.emailNotVerified)]))},e):E.loginHandleToken(r,u,c,p)},A.oneTouchLoginController=function(t,s,o,i,r,e,n,a){function l(o,e,i,t,n,a){E.createForm(P.registrationFormSchema,"loginRequiredFieldsUpdate",s,function(e){var t={};t.Profile=o,t.access_token=i,A.updateData(t,s,e,n,a,r,P.registrationFormSchema,"login",!0)},function(e){a(E.setMappedMessage(e))})}var u,c,p=P.util.checkPhoneOrEmailLogin(t),d=p&&"string"!=typeof p?p:P.util.parseQueryString(p),e=(e||P.log("Captcha should be enabled for one touch login"),"");d.phone?(c=LoginRadiusDefaults.apiDomain+"/auth/onetouchlogin/phone?apikey="+P.options.apiKey+"&smstemplate="+P.options.smsTemplateOneTouchLogin,e=Object.assign({},d),P.util.ajaxCall("POST",c,e,function(e){e.ErrorCode?i(E.loginRadiusErrorTojsError(e)):(o(e,t),E.verifyOTP=n||E.verifyOTP,E.resendOTP=a||E.resendOTP,E.verifyOTP(p+"&onetouchloginflag=true",s,o,i,r,"",l),E.resendOTP(p+"&onetouchloginflag=true",s,o,i,r,P.options.isVoiceOtp,"",l))},"oneTouchLogin")):(u=P.util.randomString(16),c=P.options.noRegistrationEmailTemplate||P.options.onetouchLoginEmailTemplate,c=LoginRadiusDefaults.apiDomain+"/auth/onetouchlogin/email?apikey="+P.options.apiKey+"&onetouchloginemailtemplate="+c+"&welcomeemailtemplate="+P.options.welcomeEmailTemplate+"&redirectUrl="+P.options.onetouchLoginRedirectUrl,e=Object.assign({},d,{clientGuid:u}),P.util.ajaxCall("POST",c,e,function(e){var t;e.ErrorCode?i(E.loginRadiusErrorTojsError(e)):e.IsPosted&&(o(e),t=function(e){P.options.askRequiredFieldsOnPasswordLessLogin?(LoginRadiusDefaults.autoFilledFieldforPasswordLesLogin=!0,A.handleFeatures(e,p,l,"",o,i)):E.loginHandleToken(e,"",o,i,"",!0)},E.showOTPTemplateForm("NoRegistrationPasswordlessLogin")?(d.onetouchlogin=!0,E.otpEmailVerification(s,function(){E.pingForSmartLogin(u,t,i)},i,r,d)):E.pingForSmartLogin(u,t,i))},"oneTouchLogin"))},A.smartLoginController=function(e,t,o){var i=P.util.randomString(16),n=P.options.autoLoginRedirectUrl||P.options.smartLoginRedirectUrl,a=P.options.autoLoginEmailTemplate||P.options.smartLoginEmailTemplate;P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/login/smartlogin?apikey="+P.options.apiKey+"&"+e+"&clientGuid="+i+"&smartloginemailtemplate="+a+"&welcomeemailtemplate="+P.options.welcomeEmailTemplate+"&redirectUrl="+n,"",function(e){e.ErrorCode?o(E.loginRadiusErrorTojsError(e)):e.IsPosted&&(t(e),E.pingForSmartLogin(i,function(e){E.loginHandleToken(e,"",t,o)},o))},"smartLogin")},A.verifyInstantOTP=function(t,e,o,i,n,a,s){e="phone="+e.phone+"&"+t,P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/login/passwordlesslogin/otp/verify?apiKey="+P.options.apiKey+"&smsTemplate="+P.options.smsTemplateWelcome,e,function(e){e.ErrorCode?i(E.loginRadiusErrorTojsError(e)):E.loginHandleToken(e,t,o,i)},"login##otp")},A.socialLoginReceiveToken=function(s,r,l,u,c,p,e,t){var d,m;function o(e){var t,o,i,n,a;P.LRCheckLogin=!0,e.IsDeleted?u([E.setMappedMessage(C.blockedUser)]):((t={}).Profile=e,t.access_token=s,E.setPasswordRule(P.util.findInSchema(m,"name","password")),E.setPasswordRule(P.util.findInSchema(m,"name","confirmpassword")),o=!1,P.options.autoFilledFieldForSocial&&(o=!0,P.$hooks.register("beforeFormRender",function(e,t){"socialRegistration"===e&&((e=P.util.findInSchema(t,"name","emailid"))&&e.value&&(e.disabled=!0),e=P.util.findInSchema(t,"name","phoneid"))&&e.value&&(e.disabled=!0)})),P.registrationFormSchema=E.mapSchema(m,e,o),P.$hooks.call("registrationSchemaFilter",m,e),o=P.storage.getBrowserStorage("LRTraditionalLogin"),P.storage.removeBrowserStorage("LRTraditionalLogin"),0<P.registrationFormSchema.length&&!o?r?(P.$hooks.call("socialLoginFormRender"),E.createForm(P.registrationFormSchema,"socialRegistration",r,function(e){A.updateData(t,r,e,l,u,c,P.registrationFormSchema,"socialLogin")},function(e){u(e)},c)):p(s,P.registrationFormSchema,e):(i=(o=(o=P.util.findInSchema(d,"name","phoneid"))&&-1!==o.rules.indexOf("required"))?!!e.PhoneIdVerified:e.PhoneIdVerified,a=(n=(n=P.util.findInSchema(d,"name","emailid"))&&-1!==n.rules.indexOf("required"))?!!e.EmailVerified:e.EmailVerified,(!i&&o||!a&&n)&&(!i&&o||!P.options.disabledEmailVerification&&!P.options.optionalEmailVerification)?null==e.Email||e.EmailVerified?(a={phone:e.PhoneId},u([E.setMappedMessage(C.phoneNotVerified)],a),A.resendOTPController(a,function(){P.socialLoginFlag=!0,E.verifyOTP("phone="+e.PhoneId,r,l,u,c),E.resendOTP("phone="+e.PhoneId+"&noPhoneVerified=false",r,l,u,c,P.options.isVoiceOtp)},u,c)):u([E.setMappedMessage(C.emailNotVerified)]):(P.storage.setBrowserStorage(LoginRadiusDefaults.storedUidName,e.Uid),LoginRadiusDefaults.isSSOInitFired&&E.setToken(s),E.loginHandleToken(t,"",l,u))))}P.currentLRContainer=r,P.options.verificationEmailTemplate=P.options.emailTemplate||P.options.verificationEmailTemplate,P.storage.setBrowserStorage(LoginRadiusDefaults.storedTokenName,s),e=e&&0<e.length?e:P.options.RegistrationFormSchema,d=e,m=JSON.parse(JSON.stringify(d)),t?o(t):P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account?apiKey="+P.options.apiKey+"&access_token="+s+"&verificationUrl="+P.options.verificationUrl+"&emailTemplate="+P.options.verificationEmailTemplate+"&welcomeEmailTemplate="+P.options.welcomeEmailTemplate,"",function(e){var t;e.ErrorCode?(P.storage.removeBrowserStorage(LoginRadiusDefaults.storedOrganization),P.storage.removeBrowserStorage(LoginRadiusDefaults.storedTokenName),u(E.loginRadiusErrorTojsError(e)),P.options.sendVerificationEmailForUnverifiedSocialLogin&&1026===e.ErrorCode&&(t=P.util.getButtonAttribute("sendverificationemail",c,()=>{A.sendVerificaionEmailForSocialController(s,r,l,u)})).childNodes&&t.childNodes[0].id&&(document.getElementById(t.childNodes[0].id)||(P.util.addHTMLContent(r,t,!1),P.$hooks.call("socialLoginFormRender")))):o(e)},"socialLogin")},A.accountLinkingReceiveToken=function(e,t,o){P.options.noCallbackForSocialLogin||P.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/socialidentity?apiKey="+P.options.apiKey+"&access_token="+P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),"candidatetoken="+e,function(e){e.ErrorCode?o(E.loginRadiusErrorTojsError(e)):t(e)},"linkAccount")},A.validateToken=function(e,t,o){e?P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/access_token/Validate?apikey="+P.options.apiKey+"&access_token="+e,"",function(e){e.ErrorCode?o(E.loginRadiusErrorTojsError(e)):t(e)},"validateToken"):o([E.setMappedMessage(C.twofaTokenValid)])},A.invalidateToken=function(e,t,o){e?P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/access_token/InValidate?apikey="+P.options.apiKey+"&access_token="+e,"",function(e){e.ErrorCode?o(E.loginRadiusErrorTojsError(e)):t(e)},"invalidateToken"):o([E.setMappedMessage(C.twofaTokenValid)])},A.updatePrivacyPolicy=function(o,i,n,a,s,r,l){P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/privacypolicy/accept?apikey="+P.options.apiKey+"&access_token="+o,"",function(e){var t;e.ErrorCode?a(E.loginRadiusErrorTojsError(e)):(s?t=e:((t=i.Data||{}).access_token=o,t.Profile=e,t.Profile=Object.assign({},t.Profile,{IsLatestPrivacyPolicy:!0})),t.Profile&&("email"===t.Profile.RegistrationProvider.toLowerCase()?E.loginHandleToken(t,"",n,a):A.socialLoginReceiveToken(o,r,n,a,l)))},"updatePrivacyPolicy")},A.configurePINController=function(e,t,o,i,n,a){P.util.ajaxCall("POST",LoginRadiusDefaults.apiDomain+"/auth/pin/set/pinauthtoken?apikey="+P.options.apiKey+"&pinauthtoken="+e,t,function(e){e&&e.ErrorCode?i(E.loginRadiusErrorTojsError(e)):e&&e.Profile&&("email"===e.Profile.RegistrationProvider.toLowerCase()?E.loginHandleToken(e,"",o,i):A.socialLoginReceiveToken(e.access_token,n,o,i,a))},"pinSetup")},A.pinReauthController=function(e,t,o,i){var n=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);n&&P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/account/reauth/pin?apiKey="+P.options.apiKey+"&access_token="+n,e,function(e){e.ErrorCode?o(E.loginRadiusErrorTojsError(e)):t(e)},"pinreauthentication")},A.customEventConsentController=function(e,t,o,i){var n=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);n&&P.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/consent/profile?apiKey="+P.options.apiKey+"&access_token="+n,e,function(e){e.ErrorCode?o(E.loginRadiusErrorTojsError(e)):t(e)},"customeventconsent")},A.submitConsentController=function(e,t,o,i,s,r,n){e&&P.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/consent/?apiKey="+P.options.apiKey+"&consenttoken="+e,t,function(e){e.ErrorCode?i(E.loginRadiusErrorTojsError(e)):e&&e.Profile&&("email"===e.Profile.RegistrationProvider.toLowerCase()?A.handleFeatures(e,"",function(o,e,i,t,n,a){E.createForm(P.registrationFormSchema,"loginRequiredFieldsUpdate",s,function(e){var t={};t.Profile=o,t.access_token=i,A.updateData(t,s,e,n,a,r,P.registrationFormSchema,"login",!0)},function(e){a(E.setMappedMessage(e))})},"",o,i,r):A.socialLoginReceiveToken(e.access_token,s,o,i,r,"","",e.Profile))},n=n||"submitconsent")},A.verifyConsentController=function(e,t,o){var i=e.isCustom||!1,n=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);n&&P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/consent/verify?apiKey="+P.options.apiKey+"&access_token="+n+"&event="+e.event+"&isCustom="+i,"",function(e){e.ErrorCode?o(E.loginRadiusErrorTojsError(e)):t(e)},"verifyconsent")},A.consentLogsController=function(t,o){var e=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);e&&P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/consent/logs?apiKey="+P.options.apiKey+"&access_token="+e,"",function(e){e.ErrorCode?o(E.loginRadiusErrorTojsError(e)):t(e)},"cosentlogs")},A.updateConsentController=function(e,t,o){var i=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);i&&P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/consent/?apiKey="+P.options.apiKey+"&access_token="+i,e,function(e){e.ErrorCode?o(E.loginRadiusErrorTojsError(e)):t(e)},"updateconsent")},A.sendMFAEmailOTPController=function(t,o,i,n,a,s){var e=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTwoFAToken),r=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);r&&!P.LRCheckLogin?P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account/2fa/otp/email?apiKey="+P.options.apiKey+"&access_token="+r+"&EmailId="+t.EmailId+"&EmailTemplate2FA="+P.options.EmailTemplate2FA,"",function(e){e.ErrorCode?i(E.loginRadiusErrorTojsError(e)):(s||(t.mfaEmailToken=!0,E.verifyOTP(t,n,o,i,a)),o(e,t))},"sendMFAEmailOTP"):e?P.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/login/2fa/otp/email?apiKey="+P.options.apiKey+"&secondfactorauthenticationtoken="+e+"&EmailTemplate2FA="+P.options.EmailTemplate2FA,t,function(e){e.ErrorCode?i(E.loginRadiusErrorTojsError(e)):(s||(t.mfaEmailToken=!0,E.verifyOTP(t,n,o,i,a)),o(e,t))},"sendMFAEmailOTP"):i([E.setMappedMessage(C.twofaTokenValid)])},A.submitMFASecurityQuestionsController=function(t,o,i,n,a){for(var e=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTwoFAToken),s=P.util.parseQueryString(t),r=[],l=0;l<P.options.securityQuestionsCount;l++)r.push({QuestionId:s["securityQuestion"+l],Answer:s["securityAnswer"+l]});P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/login/2fa/securityquestionanswer?apiKey="+P.options.apiKey+"&secondfactorauthenticationtoken="+e,{SecurityQuestionAnswer:r},function(e){e.ErrorCode?i(E.loginRadiusErrorTojsError(e)):(P.LRCheck2FA=!1,A.handleFeatures(e,t,a,n,o,i))},"submitMFASecurityQuestionsController")},A.verifyMFASecurityQuestionsController=function(t,o,i,n,a){var e,s=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTwoFAToken),r=[];for(e in l=P.util.parseQueryString(t))"setsecurityquestions"!==e&&r.push({QuestionId:e,Answer:l[e]});var l={SecurityQuestionAnswer:r},u="";P.options.riskBasedAuthentication&&(u=(u+="&RbaOneclickEmailTemplate="+P.options.rbaOneclickEmailTemplate+"&RbaOTPSmsTemplate="+P.options.rbaOTPSmsTemplate+"&RbaCityEmailTemplate="+P.options.rbaCityEmailTemplate+"&RbaCountryEmailTemplate="+P.options.rbaCountryEmailTemplate+"&RbaBrowserEmailTemplate="+P.options.rbaBrowserEmailTemplate+"&RbaIpEmailTemplate="+P.options.rbaIpEmailTemplate+"&RbaDeviceEmailTemplate="+P.options.rbaDeviceEmailTemplate+"&RbaCitySmsTemplate="+P.options.rbaCitySmsTemplate+"&RbaCountrySmsTemplate="+P.options.rbaCountrySmsTemplate)+"&RbaBrowserSmsTemplate="+P.options.rbaBrowserSmsTemplate+"&RbaIpSmsTemplate="+P.options.rbaIpSmsTemplate+"&RbaDeviceSmsTemplate="+P.options.rbaDeviceSmsTemplate),P.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/login/2fa/verification/securityquestionanswer?apiKey="+P.options.apiKey+"&secondfactorauthenticationtoken="+s+u,l,function(e){e.ErrorCode?i(E.loginRadiusErrorTojsError(e)):(P.LRCheck2FA=!1,A.handleFeatures(e,t,a,n,o,i))},"verifyMFASecurityQuestionsController")},A.verifyMFASecurityQuestionsByAccessTokenController=function(t,o,i,e,n){var a=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),s={};if(t){var s=P.util.parseQueryString(t),r=[];if(n)for(var l in s)r.push({QuestionId:l,Answer:s[l]});else for(var u=0;u<P.options.securityQuestionsCount;u++)r.push({QuestionId:s["securityQuestion"+u],Answer:s["securityAnswer"+u]});s={SecurityQuestionAnswer:r}}s.ReplaceSecurityQuestionAnswer=!e,P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/account/2fa/securityquestionanswer?apiKey="+P.options.apiKey+"&access_token="+a,s,function(e){e.ErrorCode?i(E.loginRadiusErrorTojsError(e)):o(e,t)},"verifyMFASecurityQuestionsController")},A.oneTouchLoginVerify=function(e,t,o){var i=LoginRadiusDefaults.apiDomain+"/auth/email/smartlogin?apiKey="+P.options.apiKey+"&welcomeEmailTemplate="+P.options.welcomeEmailTemplate;P.util.ajaxCall("get",i+="&verificationtoken="+e,"",function(e){e.ErrorCode?o(E.loginRadiusErrorTojsError(e)):t(e)},"oneTouchLoginVerify")},A.oneTouchLoginEmailVerification=function(e,t,o,i){e&&P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/email/"+(i?"onetouchlogin":"smartlogin")+"?apiKey="+P.options.apiKey+"&verificationtoken="+e+"&welcomeEmailTemplate="+P.options.welcomeEmailTemplate+(i?"&email="+i:""),"",function(e){e.ErrorCode?o(E.loginRadiusErrorTojsError(e)):i?t(e):E.loginHandleToken(e,"",t,o)},"smartlogin")},A.getInvitationDataController=function(e,t,o){P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+`/auth/invitations/${e}?apiKey=`+P.options.apiKey,"",function(e){e.ErrorCode?o(E.loginRadiusErrorTojsError(e)):t(e)},"getInvitationData")},A.sendVerificaionEmailForSocialController=function(e,t,o,i,n){P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/email/sendverificationemail?apiKey="+P.options.apiKey+("clientguid"===n?"&clientguid="+e:"&access_token="+e)+"&verificationUrl="+P.options.verificationUrl+"&emailTemplate="+P.options.verificationEmailTemplate,"",function(e){e.ErrorCode?i(E.loginRadiusErrorTojsError(e)):(LoginRadiusDefaults.isSSOInitFired=!0,E.logout(o(e)),E.showOTPTemplateForm("Registration")&&t&&(e=e.UUID,E.otpEmailVerification(t,o,i,"",{uuid:e})))},"sendVerificationEmail")}}var LoginRadiusV2=function(o){this.global=window;var T=this,S=new SetLoginRadiusCommonFunctions(T),k=new LoginRadiusControllers(T,S),p=LoginRadiusDefaults.buttonNames,d=LoginRadiusDefaults.messages,C=LoginRadiusDefaults._uuidFormat,e=hash.get("lr-token");try{e&&window.opener&&window.opener.html5passToken&&(window.opener.html5passToken(e),document.write("<style type='text/css'>body { display: none !important; } </style>"),hash.remove("lr-token"),window.close())}catch(e){}var e=new LRNameSpace.Utilities,L=(T.util=new LoginRadiusUtility(T,o),T.storage=new LRNameSpace.Storage(T,LoginRadiusDefaults),T.util=Object.assign(e,T.util,T.storage));function v(t,o,i,n,a){T.$hooks.call("registrationSchemaFilter",a);var e,s=n+LoginRadiusDefaults.idPrefix+"recaptcha_widget_registration";if(T.options.isConsentManagementEnabled||L.captchaSchema(s,a),T.options.privacyPolicyConfiguration.IsEnabled&&((e=T.privacyPolicySchema.slice())[0].rules="Strict"===T.options.privacyPolicyConfiguration.Mode?"required":"",a.push(e[0])),T.options.isPINAuthentication&&T.options.PINConfiguration.AskOnRegistration)S.setPINRule(L.findInSchema(a,"name","pin")),S.setPINRule(L.findInSchema(a,"name","confirmpin"));else{for(var r=[],l=0;l<a.length;l++)"pin"!==a[l].name&&"confirmpin"!==a[l].name&&r.push(a[l]);a=r}a.push({type:"html",name:"termsandcondition",html:T.options.termsAndConditionHtml||""}),S.setPasswordRule(L.findInSchema(a,"name","password")),S.setPasswordRule(L.findInSchema(a,"name","confirmpassword")),T.registrationFormSchema=a,T.options.isConsentManagementEnabled?T.getConsentConfiguration(function(e){""!==(e=S.createConsentInterface(e.Register))&&a.push({html:e,name:"consent",type:"html"}),L.captchaSchema(s,a),u(a,t,o,i,s,n,!0),L.renderV2Recaptcha(s,!0)}):(u(a,t,o,i,s,n,!1),L.renderV2Recaptcha(s,!0))}function w(t,l,u,c,p,d){S.createForm(t,"passkeyregister",l,function(e){var o=T.util.getQueryParameterByName("email",e);if(window.lrpwdregister){var i=T.util.findInSchema(T.registrationFormSchema,"name","emailid");i&&o&&(i.value=o.trim());let t=JSON.parse(JSON.stringify(T.registrationFormSchema));for(var n,a,s=[],r=0;r<t.length;r++)t[r]&&T.options.showSplitForm&&t[r].DataSource&&null!==t[r].DataSource&&(n=JSON.parse(JSON.stringify(t[r])),a=JSON.parse(JSON.stringify(L.findInSchema(t,"name","cf_"+t[r].DataSource+"Code"))),n.name="recordid",a.name="code",s.push(n),s.push(a));0<s.length&&T.options.showSplitForm?S.createForm(s,"validatecode",l,function(e){L.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/registrationdata/validatecode?apiKey="+T.options.apiKey,e,function(e){1==e.IsValid?v(l,u,c,p,t):c(e)},"registration")}):(T.options.securityQuestionEnabled&&T.options.SecurityQuestions&&S.getSecurityQuestionSchema(t,!0),v(l,u,c,p,t))}else i=[],0<(i=d?S.consentValidation(e,"Register"):i).length?c(i):k.passkeyRegistrationController(e,l,u,c,p,t)},function(e){c(e)})}function u(o,i,n,a,s,r,l){var e=T.util.getHashParam("invitation"),t=T.util.getHashParam("email");e&&T.options.isB2BEnabled&&(e=T.util.findInSchema(o,"name","emailid"))&&t&&(e.value=t.trim(),e.disabled=!0),S.createForm(o,"registration",i,function(e){var t=[];0<(t=l?S.consentValidation(e,"Register"):t).length?a(t):k.registrationController(e,i,function(e,t){window.hcaptcha&&T.options.hCaptchaSiteKey&&!T.options.invisibleRecaptcha?window.hcaptcha.reset(window[s+"lr_recaptcha_widgets_idprefix"]):window.grecaptcha&&T.options.v2Recaptcha&&grecaptcha.reset(window[s+"lr_recaptcha_widgets_idprefix"]),n(e,t)},function(e){window.hcaptcha&&T.options.hCaptchaSiteKey&&!T.options.invisibleRecaptcha?window.hcaptcha.reset(window[s+"lr_recaptcha_widgets_idprefix"]):window.grecaptcha&&T.options.v2Recaptcha&&grecaptcha.reset(window[s+"lr_recaptcha_widgets_idprefix"]),a(e)},r,o)},function(e){window.hcaptcha&&T.options.hCaptchaSiteKey&&!T.options.invisibleRecaptcha?window.hcaptcha.reset(window[s+"lr_recaptcha_widgets_idprefix"]):window.grecaptcha&&T.options.v2Recaptcha&&grecaptcha.reset(window[s+"lr_recaptcha_widgets_idprefix"]),a(e)},r)}function n(e,t,o){o=o||L.getHashParam("vtoken"),k.deleteUserConfirmController(o,e,t)}function b(h,y,C,e){var t=document.createElement("input"),o=(t.setAttribute("type","button"),T.buttonsName["createTwoFactorAuthentication".toLowerCase()]||p.createtwofactorauthentication),v=(t.setAttribute("value",o),e||LoginRadiusDefaults.classPrefix);let w=T.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);document.getElementsByName(v+"profileeditor")[0]?T.options.showTwoFactorOnProfile&&document.getElementsByName(v+"profileeditor")[0].appendChild(t):(T.options.twoFactorAuthentication||T.options.optionalTwoFactorAuthentication)&&L.addHTMLContent(h,t);try{var i=L.getQueryParameterByName("duo_code"),n=L.getQueryParameterByName("duo_state")||L.getQueryParameterByName("state");i&&n&&!T.duoLoginFlag&&(T.duoLoginFlag=!0,k.duoVerifyByAccessTokenController({Code:i,State:encodeURIComponent(n)},y,C,h,v))}catch(e){}L.addEvent("click",t,function(e){(function f(){var e;T.options.optionalTwoFactorAuthentication||T.options.twoFactorAuthentication?(e=LoginRadiusDefaults.apiDomain+"/auth/account/2FA?apikey="+T.options.apiKey,T.options.duoAuthentication&&(e=e+"&duoredirecturi="+encodeURIComponent(T.options.callbackUrl)),L.ajaxCall("get",e+"&access_token="+w,"",function(r){T.$hooks.register("afterFormRender",function(e,t,o,i){var n=i?T.util.findInSchema(i,"id","loginradius-button-backupcodebackbutton"):T.util.elementById("loginradius-button-backupcodebackbutton");(i=i||T.util.elementById(t))&&T.LRCheck2FA&&(n||(t=T.util.getButtonAttribute("backupcodebackbutton",o,function(){LoginRadiusDefaults.pingCount=0,f()}),i.appendChild(t)))}),T.LRCheck2FA=!0;var e,t,o=T.LRCheckLogin=!1;if(r.ErrorCode)C(S.loginRadiusErrorTojsError(r));else{T.storage.setBrowserStorage(LoginRadiusDefaults.storedOTPAuth,r.IsOTPAuthenticatorVerified),T.storage.setBrowserStorage(LoginRadiusDefaults.storedGAAuth,r.IsAuthenticatorVerified),T.storage.setBrowserStorage(LoginRadiusDefaults.storedEmailOTPAuth,r.IsEmailOtpAuthenticatorVerified),T.storage.setBrowserStorage(LoginRadiusDefaults.storedSQAuth,r.IsSecurityQuestionAuthenticatorVerified),T.storage.setBrowserStorage(LoginRadiusDefaults.storedPushNotificationAuth,r.IsPushDeviceRegistered),T.storage.setBrowserStorage(LoginRadiusDefaults.storedDuoAuth,r.IsDuoAuthenticatorVerified),T.storage.setBrowserStorage(LoginRadiusDefaults.storedPasskeyAuth,r.IsPasskeyAuthenticatorVerified);var i,n=T.storage.getBrowserStorage(LoginRadiusDefaults.storedOTPAuth),l=T.storage.getBrowserStorage(LoginRadiusDefaults.storedGAAuth),u=T.storage.getBrowserStorage(LoginRadiusDefaults.storedSQAuth),a=T.storage.getBrowserStorage(LoginRadiusDefaults.storedEmailOTPAuth),c=T.storage.getBrowserStorage(LoginRadiusDefaults.storedPushNotificationAuth),p=T.storage.getBrowserStorage(LoginRadiusDefaults.storedDuoAuth),d=T.storage.getBrowserStorage(LoginRadiusDefaults.storedPasskeyAuth),s=r.IsOTPAuthenticatorVerified,m=function(e){r=e||r,T.options.pushNotificationAuthentication&&(r.IsPushDeviceRegistered?(("false"!==n||"false"!==a||"false"!==u||"false"!==p||"false"!==l||"false"!==d)&&T.options.twoFactorAuthentication||T.options.optionalTwoFactorAuthentication)&&(e=T.util.getButtonAttribute("disablepushnotification",v),T.util.elementById("loginradius-button-backupcodebackbutton")&&(o=!1),T.util.addHTMLContent(h,e,o),o=!0,T.util.addEvent("click",e,function(e){S.disableMFAOptions("pushnotificationauthenticator",y,C)})):(e=T.util.getButtonAttribute("pushnotification",v,function(){var e;LoginRadiusDefaults.pingCount<=1&&w&&S.pingForPushNotification(w,function(e){y(e),e.IsRegistered&&m(e)},C),(e=document.createElement("img")).type="image",e.src=r.PushQRCode,T.util.addHTMLContent(h,e,!1),T.$hooks.call("afterFormRender","createTwoFactorAuthentication",h,v)}),T.util.addHTMLContent(h,e,o),o=!0))},g=T.options.authenticatorOptionsOrder;for(i in g)g[i]&&("emailotp"===g[i]?function(){var a,s,e;T.options.emailOTPAuthentication&&r.Email&&r.Email.length&&(r.IsEmailOtpAuthenticatorVerified?(("false"!==n||"false"!==l||"false"!==u||"false"!==p||"false"!==c||"false"!==d)&&T.options.twoFactorAuthentication||T.options.optionalTwoFactorAuthentication)&&(e=T.util.getButtonAttribute("disableemailotpauthenticator",v),T.util.addHTMLContent(h,e,o),o=!0,T.util.addEvent("click",e,function(e){S.disableMFAOptions("emailotpauthenticator",y,C)})):(a=r.Email)&&(s=function(e){S.addResendOTPBtn(!T.LRCheckLogin,y,C),k.sendMFAEmailOTPController({EmailId:e},y,C,h,v)},LoginRadiusDefaults.innerHTML=!0,e=T.util.getButtonAttribute("emailotp",v,function(e){if(1<a.length){LoginRadiusDefaults.innerHTML=!1;for(var t,o=[],i=0;i<a.length;i++)a[i]&&((t={}).text=a[i],t.value=a[i],o.push(t));var n={type:"option"};n.options=o,n.name="sendemailotp",n.rules="required",n.display="Select email to send verification code",S.createForm([n],"mfaselectemails",h,function(e){e=T.util.parseQueryString(e),s(e.sendemailotp)})}else r.Email&&r.Email[0]&&s(r.Email[0])}),T.util.addHTMLContent(h,e,o),o=!0))}():"sms"===g[i]?(t=void 0,T.options.smsOTPAuthentication&&(s?(LoginRadiusDefaults.innerHTML=!0,S.changeNumberForm(h,"",y,C,v,LoginRadiusDefaults.innerHTML)):(t=T.util.getButtonAttribute("otpauthenticator",v,function(){LoginRadiusDefaults.innerHTML=!1,S.updatePhoneNumber(h,y,C,v,"updatePhone2FA")}),T.util.addHTMLContent(h,t,o)),o=!0)):"securityquestion"===g[i]?(t=void 0,T.options.securityQuestionAuthentication&&(r.IsSecurityQuestionAuthenticatorVerified?(("false"!==n||"false"!==a||"false"!==l||"false"!==p||"false"!==c||"false"!==d)&&T.options.twoFactorAuthentication||T.options.optionalTwoFactorAuthentication)&&(t=T.util.getButtonAttribute("disablesqauthenticator",v),T.util.addHTMLContent(h,t,o),o=!0,T.util.addEvent("click",t,function(){S.disableMFAOptions("sqauthenticator",y,C)})):(t=T.util.getButtonAttribute("securityquestionsauthenticator",v,function(){LoginRadiusDefaults.innerHTML=!1,S.showMFASecurityQuestions(r,h,y,C,v)}),T.util.addHTMLContent(h,t,o),o=!0))):"pushnotification"===g[i]?m():"auth"===g[i]||"googleauth"===g[i]?(e=void 0,T.options.qrCodeAuthentication&&(r.IsAuthenticatorVerified?(("false"!==n||"false"!==a||"false"!==p||"false"!==u||"false"!==c||"false"!==d)&&T.options.twoFactorAuthentication||T.options.optionalTwoFactorAuthentication)&&(e=T.util.getButtonAttribute("disablegoogleauthenticator",v),T.util.addHTMLContent(h,e,o),o=!0,T.util.addEvent("click",e,function(e){S.disableMFAOptions("authenticator",y,C)})):(e=T.util.getButtonAttribute("googleauthenticator",v,function(){LoginRadiusDefaults.innerHTML=!1,S.showQRCode(r,h,y,C,v)}),T.util.addHTMLContent(h,e,o),o=!0))):"duomfa"===g[i]?function(){var t,e;T.options.duoAuthentication&&(r.IsDuoAuthenticatorVerified?(("false"!==n||"false"!==a||"false"!==l||"false"!==u||"false"!==c||"false"!==d)&&T.options.twoFactorAuthentication||T.options.optionalTwoFactorAuthentication)&&(e=T.util.getButtonAttribute("disableduoauthenticator",v),T.util.addHTMLContent(h,e,o),o=!0,T.util.addEvent("click",e,function(){S.disableMFAOptions("duoauthenticator",y,C)})):(t=r.DuoAuthEndpoint,e=T.util.getButtonAttribute("duomfa",v,function(e){window.location.href=t}),T.util.addHTMLContent(h,e,o),o=!0))}():"passkey"===g[i]&&(e=void 0,T.options.passkeyAuthentication)&&(r.IsPasskeyAuthenticatorVerified?(("false"!==n||"false"!==l||"false"!==u||"false"!==p||"false"!==c||"false"!==a)&&T.options.twoFactorAuthentication||T.options.optionalTwoFactorAuthentication)&&(e=T.util.getButtonAttribute("disablepasskeyauthenticator",v),T.util.addHTMLContent(h,e,o),o=!0,T.util.addEvent("click",e,function(e){S.disableMFAOptions("passkeyauthenticator",y,C)})):(e=T.util.getButtonAttribute("passkeyauthenticator",v),T.util.addHTMLContent(h,e,o),o=!0,T.util.addEvent("click",e,function(e){S.createAccountMFAPasskey(y,C)}))))}},"createTwoFactorAuthentication")):T.log("Two Factor Authentication will not work, please set in commonOpitons either twoFactorAuthentication or optionalTwoFactorAuthentication")})(),e.target.parentNode&&e.target.parentNode.removeChild(e.target)})}function R(e){var t,o;T.options.duplicateEmailWithUniqueUsername?((t=L.findInSchema(e,"name","emailid")).display="Username",t.rules="required"):(T.options.usernameLogin&&-1===(o=L.findInSchema(e,"name","emailid")).display.indexOf("/Username")&&(o.display=o.display+"/Username",o.rules="required"),(T.options.phoneLogin||T.options.passwordlessLoginOTP)&&(o||((o=L.findInSchema(e,"name","emailid")).rules="required"),-1===o.display.indexOf("/Phone"))&&(o.display=o.display+"/Phone"))}function i(m,r){var g=(r=r||{}).onSuccess||function(){},f=r.onError||function(){},h=r.container||"",y=r.classPrefix||"",c=r.templateName||"";T.$hooks.register("getCurrentActionOptions",function(e){m==e&&(window.LRSafarionSuccess=g||function(){},window.LRSafarionError=f||function(){}),T.currentActionOptions||(T.currentActionOptions={}),T.currentActionOptions[m]={},T.currentActionOptions[m].onSuccess=g||function(){},T.currentActionOptions[m].onError=f||function(){},T.currentActionOptions[m].container=h,T.currentActionOptions[m].classPrefix=y||"",T.currentActionOptions[m].templateName=c||""}),T.getAppConfiguration(function(e){var t,o,i;e&&e.ErrorCode||("registration"!==m&&"updateSecurityQuestion"!==m&&T.$hooks.call("beforeInit",m),(e={}).privacyPolicyUpdate=function(){var t,e,o=h,i=g,n=f,a=y;T.options.privacyPolicyConfiguration.IsEnabled&&((t=T.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName))?((e=T.privacyPolicySchema.slice())[0].rules="Strict"===T.options.privacyPolicyConfiguration.Mode?"required":"",S.createForm(e,"privacyPolicyUpdate",o,function(e){k.updatePrivacyPolicy(t,"",i,n,!0,o,a)},function(e){n(S.setMappedMessage(e))})):n([S.setMappedMessage(d.tokenValid)]))},e.login=function(){var t,s=h,n=g,a=f,r=y,e=L.getHashParam("vtoken"),o=L.getHashParam("vtype"),l=T.getSessionToken();try{var i=L.getQueryParameterByName("duo_code"),u=L.getQueryParameterByName("duo_state")||L.getQueryParameterByName("state");i&&u&&!T.duoLoginFlag&&(T.duoLoginFlag=!0,k.duoVerifyController({Code:i,State:encodeURIComponent(u)},n,a,s,r))}catch(e){}function c(o,e,i,t,n,a){S.createForm(T.registrationFormSchema,"loginRequiredFieldsUpdate",s,function(e){var t={};t.Profile=o,t.access_token=i,k.updateData(t,s,e,n,a,r,T.registrationFormSchema,"login",!0)},function(e){a(S.setMappedMessage(e))})}function p(e,t){S.createForm(e,t,s,function(i){var e;T.LRCheckLogin=!0,window.lrpasswordlesslogin?S.sendInstantSignInLink(i,(e,t)=>{S.showOTPTemplateForm("OneClickSignin")&&S.otpEmailVerification(s,n,a,r,t),n(e)},a,s,r):window.lrpasswordlessloginotp?S.sendInstantSignInOtp(i,n,a,s,r):(e=function(t,o){S.createForm(T.changePasswordFormSchema,"changepassword",s,function(e){k.periodicalPasswordRestController(e,n,a,t,o,i)},function(e){a(e)})},window.lrpasskeylogin?k.passkeyLoginController(i,s,n,a,e,c,r):T.options.twoFactorAuthentication||T.options.optionalTwoFactorAuthentication?k.login2FAController(i,s,n,a,r,e,c):"pinLogin"===t?k.loginPINController(i,s,n,a,r,e,c,l):k.loginController(i,s,n,a,e,c,r))},function(e){a(S.setMappedMessage(e))},r)}T.currentLRContainer=s,"oneclicksignin"!==o&&"passwordlesslogin"!==o||T.passwordlessLoginFlag||(T.passwordlessLoginFlag=!0,S.passwordlessLoginVerification(e,n,a,r)),t=T.loginFormSchema,T.loginAction=!0,R(t),t=JSON.parse(JSON.stringify(function(e){if(T.options.stayLogin){for(var t=!0,o=0;o<e.length;o++)"stayLogin"===e[o].name&&(t=!1);t&&e.push({type:"multi",name:"stayLogin",display:"Remember me",rules:null,permission:"w"})}return e}(t))),S.setPasswordRule(t[1],T.loginAction),!T.passwordlessLoginFlag&&!T.options.twoFactorAuthentication&&!T.options.optionalTwoFactorAuthentication&&T.options.isPINAuthentication&&T.options.PINConfiguration&&T.options.PINConfiguration.PINLogin&&l?(i=T.pinLoginFormSchema.slice(),o=Object.assign({},T.defaultBtnSchema,{name:"backtologinform",display:LoginRadiusDefaults.buttonNames.pinloginbackbtn,eventCallback:function(e){p(t,"login")}}),i.push(o),T.loginAction=!0,t.rules="required",p(i,"pinLogin")):p(t,"login")},e.registration=function(){var d=setInterval(function(){try{if(!LoginRadiusDefaults.isRegFormSchemaLock){LoginRadiusDefaults.isRegFormSchemaLock=!0,T.$hooks.call("beforeInit",m);var e,t,o=h,i=g,n=f,a=y;if(L.addRecaptchaJS(),T.registrationFormSchema=T.registrationFormSchema&&0<T.registrationFormSchema.length?T.registrationFormSchema:T.options.RegistrationFormSchema,T.options.isPassKeysEnabled)e=T.registrationFormSchema,e=JSON.parse(JSON.stringify(e)),t=[],l=e.findIndex(e=>"emailid"===e.name),t.push(e[l]),T.options.privacyPolicyConfiguration.IsEnabled&&((e=T.privacyPolicySchema.slice())[0].rules="Strict"===T.options.privacyPolicyConfiguration.Mode?"required":"",t.push(e[0])),T.options.isConsentManagementEnabled?T.getConsentConfiguration(function(e){""!==(e=S.createConsentInterface(e.Register))&&t.push({html:e,name:"consent",type:"html"}),w(t,o,i,n,a,!0)}):w(t,o,i,n,a,!1);else{for(var s,r,l=T.registrationFormSchema,u=JSON.parse(JSON.stringify(l)),c=[],p=0;p<u.length;p++)u[p]&&T.options.showSplitForm&&u[p].DataSource&&null!==u[p].DataSource&&(s=JSON.parse(JSON.stringify(u[p])),r=JSON.parse(JSON.stringify(L.findInSchema(u,"name","cf_"+u[p].DataSource+"Code"))),s.name="recordid",r.name="code",c.push(s),c.push(r));0<c.length&&T.options.showSplitForm?S.createForm(c,"validatecode",o,function(e){L.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/registrationdata/validatecode?apiKey="+T.options.apiKey,e,function(e){1==e.IsValid?v(o,i,n,a,u):n(e)},"registration")}):(T.options.securityQuestionEnabled&&T.options.SecurityQuestions&&S.getSecurityQuestionSchema(u,!0),v(o,i,n,a,u))}clearInterval(d)}}catch(e){clearInterval(d),T.log(e)}},1e3)},e.resetPassword=function(){S.resetPassword(h,g,f,y)},e.resetPassKey=function(){S.resetPassKey(h,g,f,y)},e.resetPIN=function(){S.resetPIN(h,g,f,y)},e.forgotPassword=function(){var e,t=h,o=g,i=f,n=y;R(e=T.forgotPasswordFormSchema),S.createForm(e,"forgotpassword",t,function(e){-1!==(e=L.checkPhoneOrEmailLogin(e)).indexOf("phoneApi=1")?(LoginRadiusDefaults.LRPhoneNo=e,k.forgotPasswordbyPhoneController(e,t,o,i,n)):k.forgotPasswordController(e,t,o,i,n)},function(e){i(e)},n)},e.forgotPIN=function(){var e,t=h,o=g,i=f,n=y;R(e=T.forgotPINFormSchema),S.createForm(e,"forgotPIN",t,function(e){-1!==(e=L.checkPhoneOrEmailLogin(e)).indexOf("phoneApi=1")?(LoginRadiusDefaults.LRPhoneNo=e,k.forgotPINbyPhoneController(e,t,o,i,n)):k.forgotPINController(e,t,o,i,n)},function(e){i(e)},n)},e.verifyEmail=function(){function t(e){var t=L.getHashParam("vtoken");if(T.options.verifyEmailByOTP){var o={};(o=e?L.mergeOptions(o,L.parseQueryString(e)):o).otp=t;try{o.email=L.getQueryParameterByName("email").replace(/ /g,"+"),k.emailVerificationController(o,i,n,a,s,!0)}catch(e){T.log(e)}}else k.emailVerificationController(t,i,n,a,s)}var i,n,a,s;i=g,n=f,s=y,(a=h)&&"Captcha"===T.options.loginLockedType&&(T.$hooks.register("afterFormRender",function(e,t,o,i){i&&"loginradius-verifyemail"===i.name&&"loginradius-submit-verify"===i[0].id&&(i[0].style.display="none")}),S.createForm([],"verifyemail",a,function(e){t(e)},function(e){n(e)},s)),t()},e.changePassword=function(){var e=h,t=g,o=f,i=y,n=T.changePasswordFormSchema;S.setPasswordRule(L.findInSchema(n,"name","newpassword")),S.setPasswordRule(L.findInSchema(n,"name","confirmnewpassword")),S.createForm(n,"changepassword",e,function(e){k.changePasswordController(e,t,o)},function(e){o(e)},i)},e.changePIN=function(){var e=h,t=g,o=f,i=y,n=T.changePINFormSchema.slice();S.setPINRule(L.findInSchema(n,"name","newpin")),S.setPINRule(L.findInSchema(n,"name","confirmnewpin")),S.createForm(n,"changepin",e,function(e){k.changePINController(e,t,o)},function(e){o(e)},i)},e.crossDeviceSSO=function(){S.loadQRCodeScript(function(){var e,t=h,o=r.expirytime,i=g,n=f,a=y;T.options.isCrossDeviceSSOEnabled&&(e=setInterval(function(){T.CDSSOPingApiTimeout&&clearTimeout(T.CDSSOPingApiTimeout),S.generateCrossDeviceSSOCode(t,o,i,n,a,function(){clearInterval(e)})},1e3*o),S.generateCrossDeviceSSOCode(t,o,i,n,a,function(){clearInterval(e)}))})},e.socialLogin=function(){var e=L.elementById(h);e&&L.addEvent("click",e,function(){LoginRadiusDefaults.socialRegFormId=this.id}),LoginRadiusDefaults.socialRegFormId=h,S.socialLogin(h,g,f,y)},e.linkAccount=function(){var n,a,s=h,r=g,l=f,u=c;T.options.disableAccountLinking?T.log(d.disabledAccountLinking):(n=s.split(","),(a=T.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName))?L.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account?apiKey="+T.options.apiKey+"&access_token="+a,"",function(e){if(e.ErrorCode)l(S.loginRadiusErrorTojsError(e));else if(e.EmailVerified||e.PhoneIdVerified){var t={};if(e.Identities)for(var o=0,i=e.Identities.length;o<i;o++)t[e.Identities[o].Provider]=e.Identities[o].ID;1===n.length?S.renderCustomInterface(s,t,u,"",!0):S.renderCustomInterface(s,t,T.options.linkedAccountsTemplate+","+T.options.notLinkedAccountsTemplate,!0,!0),window.html5passToken=function(e){k.accountLinkingReceiveToken(e,r,l)},T.options.isMobile||T.options.noCallbackForSocialLogin?T.$hooks.register("socialCalls",function(e,t){T.options.noCallbackForSocialLogin&&S.pingForSocialIdentity(a,t,r,l)}):L.addEvent("message",window,function(e){-1===e.origin.indexOf(T.options.customDomain)&&-1===e.origin.indexOf(LoginRadiusDefaults.hubDomain)||"string"==typeof e.data&&(C.test(e.data)||L.isJWT(e.data))&&k.accountLinkingReceiveToken(e.data,r,l)})}else l([S.setMappedMessage(d.unverifiedUser)])},"linkAccount"):l([S.setMappedMessage(d.tokenValid)]))},e.unLinkAccount=function(){var o=L.unLinkAccount;L.unLinkAccount=function(e,t){o(e,t,g,f)}},e.profileEditor=function(){var a,r,l=h,u=g,c=f,p=y;(r=T.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName))?(a=function(s){L.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account?apiKey="+T.options.apiKey+"&access_token="+r,"",function(e){var t=JSON.parse(JSON.stringify(s)),t=S.mapSchema(t,e,"profileeditor"),o=[],i=[],n={};n.Profile=e,n.access_token=r;for(var a=0;a<t.length;a++)t[a].name&&-1===t[a].name.indexOf("emailid")&&-1===t[a].name.indexOf("phoneid")&&o.push(t[a]),t[a].permission&&"h"!==t[a].permission&&i.push(t[a]);S.createForm(o,"profileeditor",l,function(e){k.updateData(n,l,e,u,c,p,o,"profileEditor")},function(e){c(e)},p),(T.options.optionalTwoFactorAuthentication||T.options.twoFactorAuthentication)&&b(l,u,c,p),T.$hooks.call("renderProfileEditorHook",e,i)},"profileEditor")},T.registrationFormSchema=T.registrationFormSchema&&0<T.registrationFormSchema.length?T.registrationFormSchema:T.options.RegistrationFormSchema,T.progressiveProfiling.showInEditor?T.progressiveProfiling.fetchSchema(function(e){var t=T.registrationFormSchema.slice();if(e&&e.ProfilingSteps)for(var o=0;o<e.ProfilingSteps.length;o++)for(var i=e.ProfilingSteps[o].Schema,n=0;n<i.length;n++)T.util.containsObject(t,i[n],"name")||t.push(i[n]);a(t)}):a(T.registrationFormSchema)):c([S.setMappedMessage(d.tokenValid)])},e.deleteUser=function(){var e,t=g,o=f,i=h;(e=T.sessionData.getToken())?L.ajaxCall("delete",LoginRadiusDefaults.apiDomain+"/auth/account?apiKey="+T.options.apiKey+"&access_token="+e+"&deleteUrl="+T.options.deleteUrl+"&emailTemplate="+T.options.deleteUserEmailTemplate,{},function(e){e.ErrorCode?o(S.loginRadiusErrorTojsError(e)):(t(e),S.showOTPTemplateForm("DeleteAccount")&&i&&S.createForm(T.otpSchema,"otp",i,function(e){e=T.util.parseQueryString(e),n(t,o,e.otp)},function(e){o(e)}))},"deleteUser"):o([d.vTokenError])},e.deleteUserConfirm=function(){n(g,f)},e.updatePhone=function(){T.LRCheck2FA=!1,S.updatePhoneNumber(h,g,f,y)},e.changeUsername=function(){var t=g,o=f;S.createForm(T.changeUsernameFormSchema,"changeUsername",h,function(e){k.changeUsernameController(e,t,o)},function(e){o(e)},y)},e.resendVerificationEmail=function(){var t=g,o=f;S.createForm(T.emailSchema,"resendEmailVerification",h,function(e){k.resendEmailVerificationController(e,t,o)},function(e){o(e)},y)},e.addEmail=function(){var t=g,o=f;S.createForm(T.addEmailSchema,"addemail",h,function(e){k.addEmailController(e,t,o)},function(e){o(e)},y)},e.removeEmail=function(){var t=g,o=f;S.createForm(T.emailSchema,"removeemail",h,function(e){k.removeEmailController(e,t,o)},function(e){o(e)},y)},e.createTwoFactorAuthentication=function(){b(h,g,f,y)},e.passkeylogin=function(){var e,s=h,r=g,l=f,u=y;T.options.isPassKeysEnabled?(e=T.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),L.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account/passkey?apikey="+T.options.apiKey+"&access_token="+e,"",function(t){var o=u||LoginRadiusDefaults.classPrefix,e=document.createElement("input"),i=(e.setAttribute("type","button"),T.buttonsName["createPasskey".toLowerCase()]||p.createPasskey),n=(e.setAttribute("value",i),T.util.addEvent("click",e,function(e){S.createAccountPasskey(r,l)}),!1);if(t.ErrorCode)1323===t.ErrorCode?L.addHTMLContent(s,e,n):l(S.loginRadiusErrorTojsError(t));else{for(let e of t.Credentials){var a=T.util.getButtonAttribute("passkey_"+e.Id,o,function(){S.removePasskey(e.Id,r,l)},"Disable "+(e.Authenticator||e.Id));T.util.addHTMLContent(s,a,n),n=!0}L.addHTMLContent(s,e,n)}})):T.log("Passkey will not work, please enable pass key from admin console")},e.backupCodeButton=function(){{var o=h,i=g,n=f,a=y;let e=LoginRadiusDefaults.apiDomain+"/auth/account/2FA?apikey="+T.options.apiKey+"&access_token="+T.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),t;T.options.duoAuthentication&&(t=encodeURIComponent(T.options.callbackUrl),e=e+"&duoredirecturi="+t),L.ajaxCall("get",e,"",function(e){(e.IsSecurityQuestionAuthenticatorVerified||e.IsEmailOtpAuthenticatorVerified||e.IsOTPAuthenticatorVerified||e.IsAuthenticatorVerified)&&(e=T.util.getButtonAttribute("generatebackupcodebutton",a),L.addHTMLContent(o,e),L.addEvent("click",e,function(e){T.api.getBackupCode(T.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),i,n)}))})}},e.resetBackupCodeButton=function(){{var o=h,i=g,n=f;let e=LoginRadiusDefaults.apiDomain+"/auth/account/2FA?apikey="+T.options.apiKey+"&access_token="+T.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),t;T.options.duoAuthentication&&(t=encodeURIComponent(T.options.callbackUrl),e=e+"&duoredirecturi="+t),L.ajaxCall("get",e,"",function(e){var t;(e.IsSecurityQuestionAuthenticatorVerified||e.IsEmailOtpAuthenticatorVerified||e.IsOTPAuthenticatorVerified||e.IsAuthenticatorVerified)&&((e=document.createElement("input")).setAttribute("type","button"),t=T.buttonsName["resetBackupCode".toLowerCase()]||p.resetBackupCode,e.setAttribute("value",t),L.addHTMLContent(o,e),L.addEvent("click",e,function(e){T.api.resetBackupCode(T.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),i,n)}))})}},e.updateSecurityQuestion=function(){var a=setInterval(function(){try{LoginRadiusDefaults.isSecurityFormSchemaLock||(LoginRadiusDefaults.isSecurityFormSchemaLock=!0,e=h,t=g,o=f,i=y,T.options.securityQuestionEnabled&&(T.registrationFormSchema=T.registrationFormSchema&&0<T.registrationFormSchema.length?T.registrationFormSchema:T.options.RegistrationFormSchema,n=T.registrationFormSchema,!((n=S.getSecurityQuestionSchema(n))&&0<n.length)?o([S.setMappedMessage(d.noSecurityQuestions)]):S.createForm(n,"updatesecurityquestion",e,function(e){k.updateSecurityQuestionController(e,t,o)},function(e){o(e)},i)),clearInterval(a))}catch(e){clearInterval(a),T.log(e)}var e,t,o,i,n},1e3)},e.resetPasswordBySecurityQuestion=function(){var o,e,i=h,n=g,a=f,s=y;T.options.securityQuestionEnabled&&(o=!0,R(e=T.getSecQSchema),S.createForm(e,"securityquestions",i,function(e){e=L.checkPhoneOrEmailLogin(e),k.getSecurityQuestionsController(e,function(e){0<e.length&&(o=!1);var t=T.loginFormSchema.slice(),t=(S.setPasswordRule(T.util.findInSchema(t,"name","password")),S.setPasswordRule(T.util.findInSchema(t,"name","confirmpassword")),L.mergeObjects(t,e));T.loginAction||R(t),o?a([S.setMappedMessage(d.noSecurityQuestions)]):S.createForm(t,"resetpwdbysecq",i,function(e){e=L.checkPhoneOrEmailLogin(e),k.resetPasswordBySecurityQuestionController(e,n,a)},function(e){a(e)},s)},function(e){a(e)})},function(e){a(e)},s))},e.resetPINBySecurityQuestion=function(){var o,e,i=h,n=g,a=f,s=y;T.options.securityQuestionEnabled&&(o=!0,R(e=T.getSecQSchema),S.createForm(e,"securityquestions",i,function(e){e=L.checkPhoneOrEmailLogin(e),k.getSecurityQuestionsController(e,function(e){0<e.length&&(o=!1);(t=T.resetPINFormSchema.slice(0,1)).push(T.loginFormSchema[0]),S.setPINRule(T.util.findInSchema(t,"name","pin"));var t=L.mergeObjects(t,e);T.loginAction||R(t),o?a([S.setMappedMessage(d.noSecurityQuestions)]):S.createForm(t,"resetpinbysecq",i,function(e){e=L.checkPhoneOrEmailLogin(e),k.resetPINBySecurityQuestionController(e,n,a)},function(e){a(e)},s)},function(e){a(e)})},function(e){a(e)},s))},e.ssoLogin=function(){var o=g;S.validateAndCall(function(){var e=T.options.customDomain||T.options.appName+"."+LoginRadiusDefaults.hubDomain;L.ajaxCall("get","https://"+e+"/ssologin/login","",function(t){t.isauthenticated&&(T.loginRadiusHtml5PassToken?T.loginRadiusHtml5PassToken(t.token):(T.storage.setBrowserStorage(LoginRadiusDefaults.storedTokenName,t.token),T.options.tokenType&&"jwt"===T.options.tokenType.toLowerCase()?(LoginRadiusDefaults.lrResponseCounter++,LoginRadiusDefaults.lrCounterTokenResponse={},S.getJwtToken(t.token,function(e){o(t.token,e)})):o(t.token)))})})},e.logout=function(){S.logout(g)},e.ssoNotLoginThenLogout=function(){var o=f,i=g;S.validateAndCall(function(){var e=T.options.customDomain||T.options.appName+"."+LoginRadiusDefaults.hubDomain;L.ajaxCall("get","https://"+e+"/ssologin/login","",function(t){var e;t.isauthenticated?(void 0!==(e=LRNameSpace.cookies.getItem(LoginRadiusDefaults.tokenCookie))&&null!=e||(S.setToken(t.token),e=LRNameSpace.cookies.getItem(LoginRadiusDefaults.tokenCookie)),e&&e!==t.token?(S.setToken(t.token),i(t.token)):(T.storage.setBrowserStorage(LoginRadiusDefaults.storedTokenName,t.token),T.options.tokenType&&"jwt"===T.options.tokenType.toLowerCase()?(LoginRadiusDefaults.lrResponseCounter++,LoginRadiusDefaults.lrCounterTokenResponse={},S.getJwtToken(t.token,function(e){i(t.token,e)})):i(t.token))):(LRNameSpace.cookies.removeItem(LoginRadiusDefaults.tokenCookie,T.options.appPath),o())})})},e.pinreauthentication=function(){var e=h,t=g,o=f,i=y,n=[];T.pinLoginFormSchema&&((n=T.pinLoginFormSchema.slice()).rules="required"),n.length?S.createForm(n,"pinreauthentication",e,function(e){k.pinReauthController(e,t,o)},function(e){o(e)},i):T.log("Pin schema is not defined")},e.customeventconsent=function(){var o=h,i=r.event,n=g,a=f,s=y;T.getConsentConfiguration(function(e){var t=[];""!==(e=S.createConsentInterface(e["custom_"+i]))&&(t.push({html:e,name:"consent",type:"html"}),S.createForm(t,"customeventconsent",o,function(e){var t=S.consentValidation(e,"custom_"+i);0<t.length?a(t):(t=[],e=S.mapRegistrationSchema(null,e).Consents,t.push({Event:i,IsCustom:!0}),e.Events=t,k.customEventConsentController(e,n,a))},function(e){a(e)},s))})},e.consenteditor=function(){var a,s,r,l,e;a=h,s=g,r=f,l=y,(e=T.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName))?L.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account?apiKey="+T.options.apiKey+"&access_token="+e,"",function(n){T.getConsentConfiguration(function(e){var t,o=[],i="";n&&n.ConsentProfile&&n.ConsentProfile.Consents&&(t=n.ConsentProfile.Consents,i=S.createConsentOptionInterface(T.consentsList,t)),o.push({html:i,name:"consent",type:"html"}),S.createForm(o,"consenteditor",a,function(e){var t=S.consentValidation(e);if(0<t.length)r(t);else{var o,i=T.util.parseQueryString(e),n=[];for(o in i){var a=o.replace("consent_","");n.push({ConsentOptionId:a,IsAccepted:i[o]})}(i={}).Consents=n,k.updateConsentController(i,s,r)}},function(e){r(e)},l)})}):r([S.setMappedMessage(d.tokenValid)])},o=function(){var e,t,o=h,i=g,n=f,a=y,s=L.getHashParam("vtoken"),r=L.getHashParam("vtype");!(t=T.options.isCaptchaEnabled||T.options.v2Recaptcha||T.options.invisibleRecaptcha||T.options.tencentCaptcha||T.options.tencentCaptchaAsFallback)&&T.options.privacyPolicyConfiguration.IsEnabled&&T.log("Captcha should be enabled for passwordless login if using with privacy policy"),"noregistration"!==r&&"onetouchlogin"!==r||k.oneTouchLoginEmailVerification(s,i,n),r=T.passwordLessLoginSchema,T.options.phoneLogin&&((s=L.findInSchema(r,"name","emailid")).display=s.display+"/Phone"),t&&(L.addRecaptchaJS(),e=a+LoginRadiusDefaults.idPrefix+"recaptcha_widget_onetouchlogin",L.captchaSchema(e,r)),S.createForm(r,"oneTouchLogin",o,function(e){k.oneTouchLoginController(e,o,i,n,a,t)},function(e){n(e)},a),t&&L.renderV2Recaptcha(e,!0)},i=function(){var e,t=h,o=g,i=f,n=y;R(e=T.smartLoginSchema),S.createForm(e,"smartlogin",t,function(e){-1!==(e=L.checkPhoneOrEmailLogin(e)).indexOf("phone")?k.loginOTPController(e,t,o,i,n):k.smartLoginController(e,o,i)},function(e){i(e)},n)},e.instantLinkLogin=t=function(){var e,t=g,o=f,i=y,n=L.getHashParam("vtoken");"oneclicksignin"!==(e=L.getHashParam("vtype"))&&"passwordlesslogin"!==e||T.passwordlessLoginFlag||(T.passwordlessLoginFlag=!0,S.passwordlessLoginVerification(n,t,o,i))},e.passwordlessLoginValidate=t,e.autoLogin=i,e.smartLogin=i,e.noRegistrationPasswordLessLogin=o,e.onetouchLogin=o,e.default=function(){T.log("This action is not valid.")},(e[m]||e.default)())})}return this.trackEvent=function(){T.options.debugMode&&console.warn("Anonymous login feature has been deprecated")},L.unLinkAccount=function(e,t,o,i){var n;o=o||function(){},i=i||function(){},e&&t&&(n={provider:e,providerid:t},(e=T.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName))?L.ajaxCall("delete",LoginRadiusDefaults.apiDomain+"/auth/socialIdentity?apiKey="+T.options.apiKey+"&access_token="+e,n,function(e){e.ErrorCode?i(S.loginRadiusErrorTojsError(e)):o(e,n)},"unLinkAccount"):i([S.setMappedMessage(d.tokenValid)]))},LoginRadiusHooksModel(T),setLoginRadiusModuleFunctions(T,o),T.init=function(e,t){T.useraction=e,o.maskSensitiveInput?T.otpSchema=[{type:"password",name:"otp",display:"Verification Code",rules:"required",permission:"r"}]:T.otpSchema=[{type:"string",name:"otp",display:"Verification Code",rules:"required",permission:"r"}],"required"===o.twoFactorAuthentication?(o.twoFactorAuthentication=!0,o.optionalTwoFactorAuthentication=!1):"optional"===o.twoFactorAuthentication&&(o.twoFactorAuthentication=!1,o.optionalTwoFactorAuthentication=!0),"ssoLogin"!==e&&"logout"!==e&&"ssoNotLoginThenLogout"!==e||LoginRadiusDefaults.isSSOInitFired||(LoginRadiusDefaults.isSSOInitFired=!0,T.SSOinitFired=!0),"organization"!==e&&"login"!==e||(T.currentActionOptions||(T.currentActionOptions={}),T.currentActionOptions[e]={},T.currentActionOptions[e].onSuccess=t.onSuccess||function(){},T.currentActionOptions[e].container=t.container||"",T.currentActionOptions[e].onError=t.onError||function(){},T.currentActionOptions[e].classPrefix=t._classPrefix||""),o.appName||T.log("SSO will not work, please set option.appName for SSO"),o.formRenderDelay=o.formRenderDelay||0,o.apiKey?0<o.formRenderDelay?setTimeout(function(){i(e,t)},o.formRenderDelay):i(e,t):T.log("API key must be set.")},setLoginRadiusDefaultSchema(T),T.api=new LoginRadiusApiFramework(T,k),T};